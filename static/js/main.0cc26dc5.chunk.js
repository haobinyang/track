(this["webpackJsonpgo-think"]=this["webpackJsonpgo-think"]||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r,i=n(0),a=n.n(i),c=n(22),o=n.n(c),s=n(10),u=n(6);!function(e){e[e.VIDEO=0]="VIDEO",e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO"}(r||(r={}));var l,d,f={videos:[{name:"leaf",url:"https://adsmind.gdtimg.com/ads_svp_video__0b533eaaaaaa7iaef32e55qrvwieadmqaaca.f0.mp4?dis_k=db0de64d4f56c2015472040b1d4dbe05&dis_t=1631864114&m=0a60e4eff013efd2db2228ee7b92ac66"},{name:"sunflower",url:"https://vod-progressive.akamaized.net/exp=1634469726~acl=%2Fvimeo-prod-skyfire-std-us%2F01%2F2551%2F19%2F487756327%2F2186841038.mp4~hmac=a4e03a6ba76ec92b7ab82c096c2baac10cb00792c645cfaa09de32fc418fa366/vimeo-prod-skyfire-std-us/01/2551/19/487756327/2186841038.mp4?filename=pexels-leonardo-6101754.mp4"}].map((function(e){return Object(u.a)({type:r.VIDEO},e)})),images:[{name:"dawn",url:"https://images.unsplash.com/photo-1634322474954-d69e93a8480b?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=2370&q=80"}].map((function(e){return Object(u.a)({type:r.IMAGE},e)})),audios:[]},h=n(15),p=n(38);function v(e){var t=new Date(0);return t.setSeconds(e),t.toISOString().substr(14,5)}function b(e,t,n){return new Promise((function(r){var i=t.width,a=t.height,c=new Image;c.width=i,c.height=a,c.onload=function(){n&&(n.clearRect(0,0,i,a),n.drawImage(c,0,0)),r(!0)},c.src="data:image/svg+xml,".concat(e.trim())}))}function m(e,t,n){var r=e[t];Object.defineProperty(e,t,{get:function(){return r},set:function(e){var t=r;r=e,e!==t&&n(e,t)}})}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VIDEO=1]="VIDEO",e[e.IMAGE=2]="IMAGE",e[e.AUDIO=3]="AUDIO",e[e.TRANSITION=4]="TRANSITION",e[e.SVG=5]="SVG",e[e.LOTTIE=6]="LOTTIE",e[e.TEXT=7]="TEXT"}(l||(l={})),function(e){e[e.ALL=0]="ALL",e[e.EW=1]="EW",e[e.NS=2]="NS"}(d||(d={}));var g=n(1),x=function(e){var t=e.children,n=e.direction,r=void 0===n?d.ALL:n,c=e.scrollContainerSelector,o=e.autoGrow,u=e.enable,l=void 0===u||u,f=e.attachData,h=e.slow,p=void 0===h?1:h,v=e.onMove,b=e.onEnd,m=Object(i.useRef)(null),x=Object(i.useRef)(0),j=Object(i.useRef)(0),O=Object(i.useRef)(0),y=Object(i.useRef)(""),w=Object(i.useRef)(0),k=Object(i.useRef)(0),T=Object(i.useRef)(0),E=Object(i.useRef)(0),C=Object(i.useRef)(!1),I=Object(i.useRef)(0),R=Object(i.useRef)(!1),L=Object(i.useState)(),F=Object(s.a)(L,2),M=F[0],A=F[1];Object(i.useEffect)((function(){M&&(C.current?(I.current=0,null===b||void 0===b||b(M)):(I.current=I.current+1,I.current%p===0&&(null===v||void 0===v||v(M))),A(void 0))}),[M,b,v,p]);var S=Object(i.useCallback)((function(e,t,n){var i="";d.ALL===r&&(i="translate(".concat(t-x.current,"px, ").concat(n-j.current,"px)")),d.EW===r&&(i="translate(".concat(t-x.current,"px, ").concat(k.current,"px)")),d.NS===r&&(i="translate(".concat(w.current,"px, ").concat(n-j.current,"px)")),e.style.transform=i}),[r]),N=Object(i.useCallback)((function(e,t,n){O.current=window.setInterval((function(){var r=t.getBoundingClientRect();e>0&&o&&t.scrollLeft+r.width>n.clientWidth-100&&(n.style.width="".concat(n.clientWidth+100,"px")),t.scrollLeft+=2*e}),1e3/60)}),[o]),P=Object(i.useCallback)((function(e,t,n){if(O&&(window.clearInterval(O.current),O.current=0),c){var r=100,i=document.querySelector(c);if(!R.current){if(!(null===e||void 0===e?void 0:e.closest(c)))return;R.current=!0}if(null===i||void 0===i?void 0:i.parentElement){var a=i.parentElement,s=a.getBoundingClientRect(),u=0;t>s.right-r?(o&&a.scrollLeft+s.width>i.clientWidth-100&&(i.style.width="".concat(i.clientWidth+100,"px")),u=5*(1+Math.min((t-s.right+r)/r,1))):t<s.left+r&&(u=-5*(1+Math.min((s.left+r-t)/r,1))),0!==u&&(a.scrollLeft+=u,N(u,a,i))}}}),[o,N,c]),U=Object(i.useCallback)((function(e){var t=m.current;if(t){t.hidden=!0;var n=document.elementFromPoint(e.clientX,e.clientY);S(t,e.pageX,e.pageY),P(n,e.pageX,e.pageY);var r=e.pageX-x.current,i=e.pageY-j.current;A({element:t,belowElement:n,left:r,top:i,originalLeft:w.current,originalTop:k.current,stepLeft:r-T.current,stepTop:i-E.current,cursorLeft:e.pageX,cursorTop:e.pageY,attachData:f}),T.current=r,E.current=i,t.hidden=!1}}),[S,P,f]),D=Object(i.useCallback)((function(e){var t=e.pageX,n=e.pageY,r=m.current;if(r){r.hidden=!0;var i=document.elementFromPoint(e.clientX,e.clientY);r.hidden=!1,r.classList.remove("dragged"),r.setAttribute("style",y.current),C.current=!0,A({element:r,belowElement:i,left:t-x.current,top:n-j.current,originalLeft:w.current,originalTop:k.current,stepLeft:0,stepTop:0,cursorLeft:t,cursorTop:n,attachData:f})}window.clearInterval(O.current),window.removeEventListener("mousemove",U,!1),window.removeEventListener("mouseup",D,!1)}),[f,U]),V=Object(i.useCallback)((function(e){if(e.stopPropagation(),m.current){C.current=!1;var t=m.current,n=t.getBoundingClientRect(),r=n.left,i=n.top,a=n.width,c=n.height;x.current=e.clientX-r,j.current=e.clientY-i,y.current=t.getAttribute("style")||"",w.current=r,k.current=i,T.current=r,E.current=i,R.current=!1,function(e,t){Object.keys(t).forEach((function(n){e.style.setProperty(n.replace(/([A-Z])/g,"-$1").toLowerCase(),t[n])}))}(t,{transform:"translate(".concat(r,"px, ").concat(i,"px)"),width:"".concat(a,"px"),height:"".concat(c,"px")}),t.classList.add("dragged"),S(t,e.pageX,e.pageY),window.addEventListener("mousemove",U,!1),window.addEventListener("mouseup",D,!1)}}),[U,D,S]);return Object(i.useEffect)((function(){var e=m.current;if(e&&l)return e.addEventListener("mousedown",V,!1),function(){e.removeEventListener("mousedown",V,!1)}}),[m,l,V]),Object(g.jsx)(g.Fragment,{children:a.a.cloneElement(t,{ref:function(e){return m.current=e}})})},j="track-wrapper",O=100,y={hoverTrack:null,setHoverTrack:function(){},tracks:[],setTracks:function(){},newTrackIndex:-1,setNewTrackIndex:function(){},activeClipId:"",setActiveClipId:function(){},currentTime:0,setCurrentTime:function(){},totalDuration:0,setTotalDuration:function(){}},w=".".concat(j);function k(e,t){if(e&&t){var n=t.getBoundingClientRect();return{x:Math.max(0,e.x-n.x),y:Math.max(0,e.y-n.y)}}return{x:0,y:0}}function T(e){var t=document.querySelector(".tracks-wrapper");if(e&&t){var n=t.getBoundingClientRect(),r=parseInt(getComputedStyle(t).paddingLeft,10);return{x:Math.max(0,e.x-n.x-r),y:Math.max(0,e.y-n.y)}}return{x:0,y:0}}function E(e){var t;return e?Array.prototype.slice.call(null===(t=e.parentElement)||void 0===t?void 0:t.querySelectorAll(w)).indexOf(e):-1}function C(e){for(var t=null===e||void 0===e?void 0:e.parentElement;t;){if(t.classList.contains(j))return t;t=t.parentElement}return null}function I(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r].id===t)return{trackIndex:n,clipIndex:r};return{trackIndex:-1,clipIndex:-1}}function R(e){return!(0===e.length||1===e.length&&0===e[0].length)}function L(e){return(e||0)/1e3*O}function F(e){return e/O*1e3}function M(e,t){if(t.length){for(var n=0;n<t.length;n++){var r=t[n],i=r.start,a=r.end;if(e>=i&&e<=a)return-1;if(e<i)return n}if(e>t[t.length-1].end)return t.length}return 0}function A(e,t){var n=t[e-1],r=t[e];return n||r?!n&&r?{start:0,end:r.start}:n&&r?{start:n.end,end:r.start}:n&&!r?{start:n.end,end:1e10}:{start:0,end:0}:{start:0,end:1e10}}function S(e,t){if(t[0]>=e[0]&&t[1]<=e[1])return t;if(t[0]>=e[0]&&t[1]>e[1]){var n=t[1]-e[1];return[Math.max(t[0]-n,e[0]),Math.min(t[1]-n,e[1])]}if(t[0]<e[0]&&t[1]<=e[1]){var r=e[0]-t[0];return[Math.max(t[0]+r,e[0]),Math.min(t[1]+r,e[1])]}return t[0]<=e[0]&&t[1]>=e[1]?e:t}function N(e){var t=0;return e.forEach((function(e){if(null===e||void 0===e?void 0:e.length){var n=e[e.length-1];t=Math.max(t,n.end)}})),t}var P,U,D,V=n(3),G=n(4),B=G.a.div(P||(P=Object(V.a)(["\n  width: 100%;\n  height: 100%;\n  border-radius: 6px;\n  cursor: move;\n  overflow: hidden;\n  position: relative;\n\n  img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    vertical-align: unset;\n  }\n\n  .title {\n    position: absolute;\n    bottom: 10px;\n    left: 10px;\n    color: #fff;\n    text-shadow: #000 15px 5px 5px;\n    font-size: 14px;\n    height: 14px;\n    line-height: 14px;\n  }\n"]))),z=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){t.blobUrl||fetch(t.url).then((function(e){return e.blob()})).then((function(e){var r=URL.createObjectURL(e),i=document.createElement("img");i.addEventListener("load",(function(){n(Object(u.a)(Object(u.a)({},t),{},{durationInMs:2e3,width:i.naturalWidth,height:i.naturalHeight,blobUrl:r}))})),i.src=r})).catch((function(e){alert(e.message)}))}),[t,n]),Object(g.jsxs)(B,{children:[Object(g.jsx)("img",{src:t.url,alt:"",draggable:"false"}),Object(g.jsx)("div",{className:"title",children:t.name})]})},W=G.a.div(U||(U=Object(V.a)(["\n  width: 100%;\n  height: 100%;\n  border-radius: 6px;\n  cursor: move;\n  overflow: hidden;\n  position: relative;\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .title {\n    position: absolute;\n    bottom: 10px;\n    left: 10px;\n    color: #fff;\n    text-shadow: #000 15px 5px 5px;\n    font-size: 14px;\n    height: 14px;\n    line-height: 14px;\n  }\n"]))),Y=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){t.blobUrl||fetch(t.url).then((function(e){return e.blob()})).then((function(e){var r=URL.createObjectURL(e),i=document.createElement("video");i.loop=!1,i.addEventListener("loadeddata",(function(){n(Object(u.a)(Object(u.a)({},t),{},{durationInMs:1e3*i.duration,width:i.videoWidth,height:i.videoHeight,blobUrl:r}))})),i.src=r})).catch((function(e){alert(e.message)}))}),[t,n]),Object(g.jsxs)(W,{children:[Object(g.jsx)("video",{src:t.url}),Object(g.jsx)("div",{className:"title",children:t.name})]})},_=G.a.div(D||(D=Object(V.a)(["\n  width: 125px;\n  height: 70px;\n  line-height: 70px;\n  text-align: center;\n  border-radius: 6px;\n  background-color: #949494;\n  cursor: pointer;\n"])));function H(e,t){switch(null===e||void 0===e?void 0:e.type){case l.VIDEO:return Object(g.jsx)(Y,{data:e,onLoaded:t});case l.IMAGE:return Object(g.jsx)(z,{data:e,onLoaded:t});default:return null}}var q,X,J,K,Z,$,Q,ee,te,ne,re,ie,ae,ce,oe,se,ue,le,de,fe,he,pe,ve=function(e){var t=e.data,n=Object(i.useContext)(gt),a=n.setHoverTrack,c=n.tracks,o=n.setTracks,f=n.setNewTrackIndex,v=n.newTrackIndex,b=Object(i.useState)(!1),m=Object(s.a)(b,2),j=m[0],O=m[1],y=Object(i.useState)(),w=Object(s.a)(y,2),I=w[0],N=w[1];Object(i.useEffect)((function(){N(function(e,t,n){switch(e.type){case r.VIDEO:return{type:l.VIDEO,name:e.name,url:e.url,start:t,end:n,durationInMs:0};case r.IMAGE:return{type:l.IMAGE,name:e.name,url:e.url,start:t,end:n,durationInMs:0};default:return}}(t))}),[t]);var P=Object(i.useCallback)((function(e){var t=C(e.belowElement);if(t){var n=k({x:e.cursorLeft,y:e.cursorTop},t),r=R(c),i=E(t);n.y<=12&&r?f(i):n.y>=t.clientHeight-12&&r?f(i+1):f(-1)}a(t)}),[a,f,c]),U=Object(i.useCallback)((function(e){var t=C(e.belowElement),n=T({x:e.cursorLeft,y:e.cursorTop}),r=-1;v>-1?(r=v,c.splice(r,0,[])):t&&(r=E(t));var i=c[r];if(r>-1&&i){var l=M(F(n.x),i);if(l>-1){var d=A(l,i);if(d.start||d.end){var b=(null===I||void 0===I?void 0:I.durationInMs)||0,m=L(b),g=e.element.clientWidth,x=e.cursorLeft-e.left,j=F(Math.max(0,n.x-x/g*m)),O=S([d.start,d.end],[j,j+b]),y=Object(s.a)(O,2),w=y[0],k=y[1],R=Object(u.a)(Object(u.a)({},I),{},{id:Object(p.a)(),start:w,end:k,durationInMs:k-w});i.splice(l,0,R),o(Object(h.a)(c))}}}f(-1),a(null)}),[I,v,a,f,o,c]),D=Object(i.useCallback)((function(e){N(Object(u.a)(Object(u.a)({},I),e)),O(!0)}),[I]);return Object(g.jsx)(x,{direction:d.ALL,scrollContainerSelector:".tracks-wrapper",autoGrow:!0,enable:j,slow:2,onMove:P,onEnd:U,children:Object(g.jsx)(_,{children:H(I,D)})})},be=f.videos,me=f.images,ge=function(){return Object(g.jsxs)("div",{children:[be.map((function(e,t){return Object(g.jsx)("div",{style:{width:125,height:75},children:Object(g.jsx)(ve,{data:e})},t)})),me.map((function(e,t){return Object(g.jsx)("div",{style:{width:125,height:75},children:Object(g.jsx)(ve,{data:e})},t)}))]})},xe=function(){return Object(g.jsx)(g.Fragment,{children:"Side Bar"})},je=G.a.div(q||(q=Object(V.a)(["\n  background-color: rgb(69 211 174);\n  border-radius: 5px;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  overflow: hidden;\n  display: flex;\n  &.active {\n    box-shadow: 0px 0px 10px 0px rgb(69 211 174);\n  }\n"]))),Oe=(G.a.div(X||(X=Object(V.a)(["\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n"]))),G.a.div(J||(J=Object(V.a)(["\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n"]))),G.a.div(K||(K=Object(V.a)(["\n  color: #fff;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n  flex-grow: 1;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"])))),ye=G.a.div(Z||(Z=Object(V.a)(["\n  background: #fff;\n  width: 20px;\n  cursor: ew-resize;\n  flex-shrink: 0;\n"]))),we=function(e){var t=e.start,n=e.end,r=e.onUpdate,a=e.durationInMs,c=(e.name,e.id),o=Object(i.useContext)(gt),u=o.setHoverTrack,l=o.tracks,f=o.setNewTrackIndex,h=o.newTrackIndex,p=o.activeClipId,v=o.setActiveClipId,b=Object(i.useCallback)((function(e){var t=C(e.belowElement);if(t){var n=k({x:e.cursorLeft,y:e.cursorTop},t),r=R(l),i=E(t);n.y<=12&&r?f(i):n.y>=t.clientHeight-12&&r?f(i+1):f(-1)}u(t)}),[u,f,l]),m=Object(i.useCallback)((function(e){var t=C(e.belowElement),n=T({x:e.cursorLeft,y:e.cursorTop}),i=F(Math.max(0,n.x-(e.cursorLeft-e.left)));if(h>-1)null===r||void 0===r||r({start:i,end:i+a},h,0,!0);else if(t){var o=E(t),d=I(l,c).trackIndex,p=l[o];if(o===d&&(p=p.filter((function(e){return e.id!==c}))),o>-1&&p){var v=M(F(n.x),p);if(v>-1){var b=A(v,p);if(b.start||b.end){var m=S([b.start,b.end],[i,i+a]),g=Object(s.a)(m,2),x=g[0],j=g[1];null===r||void 0===r||r({start:x,end:j,durationInMs:j-x},o,v,!1)}}}}f(-1),u(null)}),[a,c,h,r,u,f,l]),j=Object(i.useCallback)((function(e){var i=t+F(e.stepLeft);if(n-i>=500){var a,o=I(l,c),s=o.trackIndex,u=o.clipIndex,d=(null===(a=l[s][u-1])||void 0===a?void 0:a.end)||0;null===r||void 0===r||r({start:Math.max(i,d)},s,u,!1)}}),[n,c,r,t,l]),O=Object(i.useCallback)((function(e){var i=n+F(e.stepLeft);if(i-t>=500){var a,o=I(l,c),s=o.trackIndex,u=o.clipIndex,d=(null===(a=l[s][u+1])||void 0===a?void 0:a.start)||1e10;null===r||void 0===r||r({end:Math.min(i,d)},s,u,!1)}}),[n,t,l,c,r]),y=Object(i.useCallback)((function(){var e=I(l,c),i=e.trackIndex,a=e.clipIndex;null===r||void 0===r||r({durationInMs:n-t},i,a,!1)}),[n,c,r,t,l]),w=Object(i.useCallback)((function(){v(c||"")}),[c,v]);return Object(g.jsx)(x,{scrollContainerSelector:".tracks-wrapper",autoGrow:!0,slow:2,onMove:b,onEnd:m,children:Object(g.jsxs)(je,{className:p===c?"active":"",onClick:w,style:{width:L(n-t),left:L(t)},children:[Object(g.jsx)(ye,{children:Object(g.jsx)(x,{direction:d.EW,onMove:j,onEnd:y,children:Object(g.jsx)("div",{style:{width:"100%",height:"100%"}})})}),Object(g.jsx)(Oe,{children:c}),Object(g.jsx)(ye,{children:Object(g.jsx)(x,{direction:d.EW,onMove:O,onEnd:y,children:Object(g.jsx)("div",{style:{width:"100%",height:"100%"}})})})]})})},ke=Object(i.memo)(we),Te=G.a.div($||($=Object(V.a)(["\n  width: 100%;\n  height: 40px;\n  padding: 5px 0px;\n"]))),Ee=G.a.div(Q||(Q=Object(V.a)(["\n  width: 100%;\n  height: 100%;\n  border: 2px dashed rgb(60, 60, 72);\n  border-radius: 5px;\n  position: relative;\n  transition: background 0.5s linear;\n"]))),Ce=G.a.div(ee||(ee=Object(V.a)(["\n  height: 0;\n  position: relative;\n  pointer-events: none;\n  &::after {\n    content: '';\n    position: absolute;\n    background: rgb(69 211 174);\n    width: 100%;\n    height: 2px;\n    border-radius: 2px;\n    left: 0;\n    right: 0;\n    top: -1px;\n  }\n  &::before {\n    content: '+';\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    width: 20px;\n    height: 20px;\n    border-radius: 10px;\n    background: rgb(69 211 174);\n    transform: translate(-10px, -10px);\n    text-align: center;\n    line-height: 20px;\n    z-index: 1;\n  }\n"]))),Ie=function(e){var t=e.clips,n=e.style,r=e.index,a=Object(i.useContext)(gt),c=a.hoverTrack,o=a.tracks,s=a.setTracks,l=a.newTrackIndex,d=E(c);var f=R(o);return Object(g.jsxs)(g.Fragment,{children:[f&&l===r?Object(g.jsx)(Ce,{}):null,Object(g.jsx)(Te,{style:n,className:j,children:Object(g.jsx)(Ee,{style:Object(u.a)(Object(u.a)({},t.length?{border:0,background:"#1c1c28"}:null),d===r&&-1===l?{background:"#313146"}:null),children:t.map((function(e){return Object(g.jsx)(ke,Object(u.a)(Object(u.a)({},e),{},{onUpdate:function(t,n,r,i){!function(e,t,n,r,i){var a=I(o,e.id),c=a.trackIndex,u=a.clipIndex;if(c>-1&&u>-1){var l=o[c].splice(u,1)[0];Object.assign(l,t),i?o.splice(n,0,[l]):o[n].splice(r,0,l),s(Object(h.a)(o))}}(e,t,n,r,i)}}),e.id)}))})}),f&&l===r+1?Object(g.jsx)(Ce,{}):null]})},Re=G.a.div(te||(te=Object(V.a)(["\n  display: flex;\n  height: 100%;\n  /* width: 3000px; */\n  padding: 0 20px;\n  position: relative;\n"]))),Le=G.a.div(ne||(ne=Object(V.a)(["\n  flex: 1 1 0%;\n  display: flex;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  justify-content: center;\n"]))),Fe=G.a.div(re||(re=Object(V.a)(["\n  width: 0;\n  top: 0;\n  bottom: 4px;\n  position: absolute;\n  cursor: move;\n\n  &::before {\n    content: '';\n    width: 2px;\n    background-color: #fff;\n    left: -1px;\n    top: -10px;\n    bottom: 0;\n    border-radius: 2px;\n    position: absolute;\n  }\n\n  &::after {\n    content: '';\n    position: absolute;\n    top: -20px;\n    left: -10px;\n    border-radius: 4px;\n    width: 0;\n    height: 0;\n    border-left: 10px solid transparent;\n    border-right: 10px solid transparent;\n    border-top: 10px solid #fff;\n  }\n"]))),Me=function(){var e=Object(i.useContext)(gt),t=e.tracks,n=e.currentTime,r=e.setCurrentTime,a=1===t.length&&0===t[0].length?{height:60}:{},c=Object(i.useCallback)((function(e){var n=N(t),i=T({x:e.cursorLeft,y:e.cursorTop}),a=F(Math.max(0,i.x-(e.cursorLeft-e.left)));r(Math.min(a,n))}),[r,t]);return Object(g.jsxs)(Re,{className:"tracks-wrapper",children:[Object(g.jsx)(Le,{children:t.map((function(e,t){return Object(g.jsx)(Ie,{index:t,clips:e,style:a},t)}))}),Object(g.jsx)(x,{scrollContainerSelector:".tracks-wrapper",autoGrow:!1,direction:d.EW,onEnd:c,children:Object(g.jsx)(Fe,{style:{left:L(n)+20}})})]})},Ae=G.a.div(ie||(ie=Object(V.a)(["\n  display: flex;\n  width: 100%;\n  height: 100%;\n  user-select: none;\n  overflow: hidden;\n"]))),Se=G.a.div(ae||(ae=Object(V.a)(["\n  display: flex;\n  height: 100%;\n  position: relative;\n  z-index: 5;\n"]))),Ne=G.a.div(ce||(ce=Object(V.a)(["\n  display: flex;\n  flex: 1 1 0%;\n  flex-direction: column;\n  overflow: hidden;\n"]))),Pe=G.a.div(oe||(oe=Object(V.a)(["\n  flex: 1 1 0%;\n  padding-top: 24px;\n  display: grid;\n  grid-template-rows: minmax(200px, 1.2fr) minmax(200px, 0.8fr);\n  overflow: hidden;\n"]))),Ue=G.a.div(se||(se=Object(V.a)(["\n  background-color: #17171e;\n  overflow: auto;\n  display: flex;\n  flex-direction: column;\n"]))),De=G.a.div(ue||(ue=Object(V.a)(["\n  border-top: 1px solid rgb(60, 60, 72);\n  padding: 0 20px;\n  display: flex;\n  overflow: hidden;\n  flex-grow: 0;\n  flex-shrink: 0;\n"]))),Ve=G.a.div(le||(le=Object(V.a)(["\n  position: relative;\n  height: 20px;\n  padding: 8px 5px;\n  font-size: 12px;\n  line-height: 12px;\n  color: rgb(88, 88, 88);\n  flex-grow: 0;\n  flex-shrink: 0;\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    height: 20px;\n    background-color: rgb(60, 60, 72);\n  }\n  &::after {\n    content: '';\n    position: absolute;\n    left: 50%;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    height: 12px;\n    background-color: rgb(60, 60, 72);\n  }\n"]))),Ge=function(){var e=Object(i.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){var e=document.querySelector(".tracks-wrapper");if(e){r(e.clientWidth);var t=new ResizeObserver((function(){e.clientWidth!==n&&r(e.clientWidth)}));return t.observe(e),function(){t.disconnect()}}}),[n]),Object(g.jsx)(De,{style:{width:n},children:Array.from(Array(Math.ceil(n/O))).map((function(e,t){return Object(g.jsx)(Ve,{style:{width:O},children:v(t)},t)}))})},Be=function(e,t){var n=function(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],c=Object(i.useCallback)((function(t){t.key===e&&a(!0)}),[e]),o=Object(i.useCallback)((function(t){t.key===e&&a(!1)}),[e]);return Object(i.useEffect)((function(){return window.removeEventListener("keydown",c),window.removeEventListener("keyup",o),window.addEventListener("keydown",c),window.addEventListener("keyup",o),function(){window.removeEventListener("keydown",c),window.removeEventListener("keyup",o)}}),[c,o]),r}(e);Object(i.useEffect)((function(){n&&(null===t||void 0===t||t())}),[t,n])},ze=function(e){!function(e){var t=e.tracks,n=e.activeClipId,r=e.setTracks;Be("Backspace",(function(){var e=I(t,n),i=e.trackIndex,a=e.clipIndex;i>-1&&a>-1&&(t[i].splice(a,1),r(Object(h.a)(t)))}))}(e)},We=n(2),Ye=n.n(We),_e=n(7),He=n(8),qe=n(9),Xe=n(26),Je=n(14),Ke=n(12),Ze=n(11),$e=function(){function e(t,n){Object(He.a)(this,e),this.isAttachToPainter=!1,this.isStart=!1,this.player=void 0,this.sprite=void 0,this.config=void 0,this.config=t,this.player=n,this.isAttachToPainter=!1,this.isStart=!1}return Object(qe.a)(e,[{key:"init",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onCurrentTimeChange",value:function(e){}},{key:"pause",value:function(){}},{key:"addToPainter",value:function(){!this.isAttachToPainter&&this.sprite&&this.config.id&&(this.isAttachToPainter=!0,this.player.painter.add(this.sprite,this.config.id))}},{key:"removeFromPainter",value:function(){this.isAttachToPainter&&this.config.id&&(this.isAttachToPainter=!1,this.player.painter.remove(this.config.id))}}]),e}();function Qe(e,t){switch(e){case de.FILL:return"uv";case de.CONTAIN:return".5+(uv-.5)*vec2(max(ratio/".concat(t,",1.),max(").concat(t,"/ratio,1.))");case de.COVER:return".5+(uv-.5)*vec2(min(ratio/".concat(t,",1.),min(").concat(t,"/ratio,1.))")}}!function(e){e[e.FILL=0]="FILL",e[e.CONTAIN=1]="CONTAIN",e[e.COVER=2]="COVER"}(de||(de={})),function(e){e[e.NO_EFFECT=0]="NO_EFFECT",e[e.BLUR=1]="BLUR",e[e.GRAY=2]="GRAY"}(fe||(fe={})),function(e){e[e.MORPH=0]="MORPH",e[e.DREAMY=1]="DREAMY",e[e.FADE=2]="FADE"}(he||(he={})),function(e){e[e.PLUNGING=0]="PLUNGING"}(pe||(pe={}));var et,tt=function(){function e(){Object(He.a)(this,e)}return Object(qe.a)(e,null,[{key:"GetVertex",value:function(){return"\n      varying vec2 texCoords;\n      void main() {\n        texCoords = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    "}},{key:"GetFragment",value:function(){return"\n      varying vec2 texCoords;\n      uniform sampler2D tex;\n      void main() {\n        gl_FragColor = texture2D(tex, texCoords);\n      }\n    "}},{key:"GetEffectFragment",value:function(e){var t=e.fitType,n=void 0===t?de.CONTAIN:t,r=e.effect,i=Qe(n,e.clipRatio);return"\n      varying vec2 texCoords;\n      uniform float ratio;\n      uniform sampler2D tex;\n      ".concat(r,"\n      vec4 getColor(vec2 uv) {\n        vec2 newUV = ").concat(i,";\n        vec4 color = effect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      void main() {\n        gl_FragColor = getColor(texCoords);\n      }\n    ")}},{key:"GetTransitionFragment",value:function(e){var t=e.fromFitType,n=void 0===t?de.CONTAIN:t,r=e.fromEffect,i=e.fromRatio,a=e.toFitType,c=void 0===a?de.CONTAIN:a,o=e.toEffect,s=e.toRatio,u=e.transition,l=Qe(n,i),d=Qe(c,s);return"\n      varying vec2 texCoords;\n      uniform sampler2D from, to;\n      uniform float fromRatio, toRatio;\n      uniform float progress, ratio;\n      ".concat(r,"\n      ").concat(o,"\n      vec4 getFromColor(vec2 uv) {\n        vec2 newUV = ").concat(l,";\n        vec4 color = fromEffect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      vec4 getToColor(vec2 uv) {\n        vec2 newUV = ").concat(d,";\n        vec4 color = toEffect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      ").concat(u,"\n      void main() {\n        gl_FragColor = transition(texCoords);\n      }\n    ")}}]),e}(),nt=n(13);var rt=(et={},Object(nt.a)(et,fe.NO_EFFECT,(function(){return{uniforms:{},fragment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tex",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"effect";return"\n      vec4 ".concat(t,"(vec2 uv) {\n        return texture2D(").concat(e,", uv);\n      }\n    ")}}})),Object(nt.a)(et,fe.GRAY,(function(){return{uniforms:{},fragment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tex",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"effect";return"\n      vec4 ".concat(t,"(vec2 uv) {\n        vec4 color = texture2D(").concat(e,", uv);\n        float gray = (color.r+color.g+color.b)/3.;\n        return vec4(gray,gray,gray,color.a);\n      }\n    ")}}})),et);function it(e){return rt[e||fe.NO_EFFECT]()}var at,ct=n(5),ot=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(){var e;Object(He.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).originEffect=fe.NO_EFFECT,e.geometry=void 0,e.material=void 0,e.texture=void 0,e.video=void 0,e}return Object(qe.a)(n,[{key:"init",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initRender();case 2:this.setPlaybackRate(),this.watchChange();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;m(this.config,"start",(function(){e.player.renderFrame(!0)})),m(this.config,"end",(function(){e.player.renderFrame(!0)}))}},{key:"createTexture",value:function(){var e=this;return new Promise((function(t,n){e.video=document.createElement("video"),e.video.src=e.config.blobUrl,e.video.loop=!1,e.video.autoplay=!1,e.video.addEventListener("loadeddata",Object(_e.a)(Ye.a.mark((function n(){var r;return Ye.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.video&&(r=new ct.VideoTexture(e.video),t(r));case 1:case"end":return n.stop()}}),n)}))))}))}},{key:"initRender",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){var t,n,r,i,a,c,o,s,l;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config,n=t.effect,r=t.fitType,i=t.width,a=t.height,c=this.player,o=it(n),s=o.uniforms,l=o.fragment,this.originEffect=n,e.next=6,this.createTexture();case 6:this.texture=e.sent,this.geometry=new ct.PlaneGeometry(c.width,c.height),this.material=new ct.ShaderMaterial({uniforms:Object(u.a)({tex:{value:this.texture},ratio:{value:c.width/c.height}},s),vertexShader:tt.GetVertex(),fragmentShader:tt.GetEffectFragment({clipRatio:i/a,fitType:r,effect:l()}),uniformsNeedUpdate:!0}),this.material.transparent=!0,this.sprite=new ct.Mesh(this.geometry,this.material);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPlaybackRate",value:function(){var e=this.config,t=e.start,n=e.end;return e.durationInMs/(n-t)}},{key:"setPlaybackRate",value:function(){var e=this.video,t=this.getPlaybackRate();e&&Math.abs(e.playbackRate-t)>=1e-5&&(e.playbackRate=t)}},{key:"play",value:function(){var e=this.video;(null===e||void 0===e?void 0:e.paused)&&e.play()}},{key:"pause",value:function(){Object(Xe.a)(Object(Je.a)(n.prototype),"pause",this).call(this);var e=this.video;e&&!e.paused&&e.pause()}},{key:"show",value:function(){this.sprite&&(this.sprite.visible=!0)}},{key:"hide",value:function(){this.sprite&&(this.sprite.visible=!1)}},{key:"correctVideoCurrentTime",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){var t,n,r;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.player.currentTime,n=this.getPlaybackRate(),r=(t-this.config.start)*n/1e3,e.next=5,this.texture.setCurrentTime(r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onCurrentTimeChange",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(t){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.player.isInRange(this)){e.next=13;break}if(!t){e.next=7;break}return this.pause(),e.next=5,this.correctVideoCurrentTime();case 5:e.next=8;break;case 7:this.play();case 8:this.isStart=!0,this.addToPainter(),this.render(),e.next=15;break;case 13:this.isStart&&(this.isStart=!1,this.pause()),this.removeFromPainter();case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateShader",value:function(){this.originEffect,this.config.effect}},{key:"render",value:function(){this.updateShader(),this.sprite&&(this.sprite.position.z=this.config.zIndex)}},{key:"destroy",value:function(){this.video&&(this.video=void 0),this.texture&&this.texture.dispose(),this.geometry&&this.geometry.dispose(),this.material&&this.material.dispose()}}]),n}($e),st=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(){var e;Object(He.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).originEffect=fe.NO_EFFECT,e.geometry=void 0,e.material=void 0,e.texture=void 0,e}return Object(qe.a)(n,[{key:"init",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initRender();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createTexture",value:function(){var e=this;return new Promise((function(t){(new ct.TextureLoader).load(e.config.blobUrl,(function(e){t(e)}))}))}},{key:"initRender",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){var t,n,r,i,a,c,o,s,l,d,f;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config,n=t.width,r=t.height,i=t.effect,a=t.fitType,c=this.player,o=c.width,s=c.height,l=it(i),d=l.uniforms,f=l.fragment,this.originEffect=i,e.next=6,this.createTexture();case 6:this.texture=e.sent,this.geometry=new ct.PlaneGeometry(o,s),this.material=new ct.ShaderMaterial({uniforms:Object(u.a)({tex:{value:this.texture},ratio:{value:o/s}},d),vertexShader:tt.GetVertex(),fragmentShader:tt.GetEffectFragment({clipRatio:n/r,fitType:a,effect:f()}),uniformsNeedUpdate:!0}),this.material.transparent=!0,this.sprite=new ct.Mesh(this.geometry,this.material);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){this.sprite&&(this.sprite.visible=!0)}},{key:"hide",value:function(){this.sprite&&(this.sprite.visible=!1)}},{key:"onCurrentTimeChange",value:function(){this.player.isInRange(this)?(this.addToPainter(),this.render()):this.removeFromPainter()}},{key:"updateShader",value:function(){this.originEffect,this.config.effect}},{key:"render",value:function(){this.updateShader(),this.sprite&&(this.sprite.position.z=this.config.zIndex)}},{key:"destroy",value:function(){this.texture&&this.texture.dispose(),this.geometry&&this.geometry.dispose(),this.material&&this.material.dispose()}}]),n}($e),ut=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(){return Object(He.a)(this,n),t.apply(this,arguments)}return Object(qe.a)(n,[{key:"render",value:function(){}},{key:"destroy",value:function(){}}]),n}($e),lt=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(){return Object(He.a)(this,n),t.apply(this,arguments)}return Object(qe.a)(n,[{key:"render",value:function(){}},{key:"destroy",value:function(){}}]),n}($e);var dt=Object.freeze((at={},Object(nt.a)(at,he.MORPH,(function(){return{uniforms:{strength:{value:.1}},fragment:"\n      uniform float strength; // = 0.1\n      vec4 transition(vec2 p) {\n        vec4 ca = getFromColor(p);\n        vec4 cb = getToColor(p);\n        \n        vec2 oa = (((ca.rg+ca.b)*0.5)*2.0-1.0);\n        vec2 ob = (((cb.rg+cb.b)*0.5)*2.0-1.0);\n        vec2 oc = mix(oa,ob,0.5)*strength;\n        \n        float w0 = progress;\n        float w1 = 1.0-w0;\n        return mix(getFromColor(p+oc*w0), getToColor(p-oc*w1), progress);\n      }\n    "}})),Object(nt.a)(at,he.DREAMY,(function(){return{uniforms:{},fragment:"\n      vec2 offset(float progress, float x, float theta) {\n        float phase = progress*progress + progress + theta;\n        float shifty = 0.03*progress*cos(10.0*(progress+x));\n        return vec2(0, shifty);\n      }\n      vec4 transition(vec2 p) {\n        return mix(getFromColor(p + offset(progress, p.x, 0.0)), getToColor(p + offset(1.0-progress, p.x, 3.14)), progress);\n      }\n    "}})),Object(nt.a)(at,he.FADE,(function(){return{uniforms:{},fragment:"\n      vec4 transition(vec2 uv) {\n        return mix(\n          getFromColor(uv),\n          getToColor(uv),\n          progress\n        );\n      }\n    "}})),at));var ft=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(e,r){var i;return Object(He.a)(this,n),(i=t.call(this,e,r)).geometry=void 0,i.material=void 0,Promise.resolve().then((function(){i.config.from=i.player.getClipById(i.config.fromId),i.config.to=i.player.getClipById(i.config.toId),i.initRender()})),i}return Object(qe.a)(n,[{key:"initRender",value:function(){var e=this.player,t=this.config,n=t.fromId,r=t.toId,i=t.transition,a=e.width,c=e.height,o=e.getClipById(n),s=e.getClipById(r);if(o&&s){var l=o.config,d=l.width,f=l.height,h=l.effect,p=l.texture,v=l.fitType,b=s.config,m=b.width,g=b.height,x=b.effect,j=b.texture,O=b.fitType,y=it(h),w=y.uniforms,k=y.fragment,T=it(x),E=T.uniforms,C=T.fragment,I=dt[i](),R=I.uniforms,L=I.fragment;this.geometry=new ct.PlaneGeometry(a,c),this.material=new ct.ShaderMaterial({uniforms:Object(u.a)(Object(u.a)(Object(u.a)({from:{value:p},to:{value:j},progress:{value:0},ratio:{value:a/c}},w),E),R),vertexShader:tt.GetVertex(),fragmentShader:tt.GetTransitionFragment({fromFitType:v,fromEffect:k("from","fromEffect"),fromRatio:d/f,toFitType:O,toEffect:C("to","toEffect"),toRatio:m/g,transition:L}),uniformsNeedUpdate:!0}),this.material.transparent=!0,this.sprite=new ct.Mesh(this.geometry,this.material)}}},{key:"onCurrentTimeChange",value:function(){this.player.isInRange(this)?(this.addToPainter(),this.render()):this.removeFromPainter()}},{key:"render",value:function(){var e,t=this.config,n=t.start,r=t.end,i=t.from,a=(this.player.currentTime-n)/(r-n);this.sprite&&(null===(e=this.material)||void 0===e?void 0:e.uniforms)&&i&&(this.sprite.position.z=i.config.zIndex+1,this.material.uniforms.progress.value=a)}},{key:"destroy",value:function(){}}]),n}($e),ht=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(e,r){var i;return Object(He.a)(this,n),(i=t.call(this,e,r)).canvas=document.createElement("canvas"),i.context=void 0,i.geometry=void 0,i.material=void 0,i.initCanvas(),i.initRender(),i}return Object(qe.a)(n,[{key:"initCanvas",value:function(){var e=this.player,t=e.width,n=e.height;this.canvas.width=t,this.canvas.height=n,this.context=this.canvas.getContext("2d")}},{key:"initRender",value:function(){var e=this.player,t=e.width,n=e.height;this.geometry=new ct.PlaneGeometry(t,n),this.material=new ct.MeshBasicMaterial,this.material.map=new ct.CanvasTexture(this.canvas),this.material.transparent=!0,this.sprite=new ct.Mesh(this.geometry,this.material)}},{key:"onCurrentTimeChange",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.player.isInRange(this)){e.next=6;break}return this.addToPainter(),e.next=4,this.render();case 4:e.next=7;break;case 6:this.removeFromPainter();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){var t,n,r,i,a,c,o,s,u;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=this.material)||void 0===t?void 0:t.map)||!this.sprite){e.next=8;break}return n=this.config,r=n.start,i=n.end,a=this.player,c=a.width,o=a.height,s=a.currentTime,u=this.config.func({start:r,end:i,currentTime:s,width:c,height:o}),e.next=6,b(u,this.canvas,this.context);case 6:this.material.map.needsUpdate=!0,this.sprite.position.z=this.config.zIndex;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}}]),n}($e),pt=function(){function e(t,n){Object(He.a)(this,e),this.scene=void 0,this.camera=void 0,this.renderer=void 0,this.maxAnisotropy=void 0,this.scene=new ct.Scene,this.camera=new ct.OrthographicCamera(t/-2,t/2,n/2,n/-2,-1e3,1e3),this.renderer=new ct.WebGLRenderer({preserveDrawingBuffer:!0,antialias:!0}),this.renderer.setPixelRatio(2),this.renderer.setSize(t,n),this.maxAnisotropy=this.renderer.capabilities.getMaxAnisotropy()}return Object(qe.a)(e,[{key:"add",value:function(e,t){e.name=t,this.scene.add(e)}},{key:"remove",value:function(e){var t=this.scene.getObjectByName(e);t&&this.scene.remove(t)}},{key:"getDomElement",value:function(){return this.renderer.domElement}},{key:"render",value:function(){var e=this.renderer,t=this.scene,n=this.camera;e.render(t,n)}}]),e}(),vt=function(e){Object(Ke.a)(n,e);var t=Object(Ze.a)(n);function n(e,r){var i;return Object(He.a)(this,n),(i=t.call(this,e,r)).geometry=void 0,i.material=void 0,i.initRender(),i}return Object(qe.a)(n,[{key:"initRender",value:function(){var e=this.player,t=e.width,n=e.height;this.geometry=new ct.PlaneGeometry(t,n),this.material=new ct.MeshBasicMaterial;var r=new ct.CanvasTexture(document.createElement("canvas"));this.material.map=r,this.material.transparent=!0,this.sprite=new ct.Mesh(this.geometry,this.material)}},{key:"onCurrentTimeChange",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.player.isInRange(this)?(this.addToPainter(),this.render()):this.removeFromPainter();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){var t,n;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sprite&&(null===(t=this.material)||void 0===t?void 0:t.map)&&(n=this.player.currentTime,this.config.lottie.goToAndStop(n-this.config.start),this.material.map.needsUpdate=!0,this.sprite.position.z=this.config.zIndex);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}}]),n}($e);function bt(e,t){switch(e.type){case l.VIDEO:return new ot(e,t);case l.IMAGE:return new st(e,t);case l.TRANSITION:return new ft(e,t);case l.TEXT:return new ut(e,t);case l.AUDIO:return new lt(e,t);case l.SVG:return new ht(e,t);case l.LOTTIE:return new vt(e,t)}}var mt=function(){function e(t){var n=this,r=t.tracks,i=t.width,a=t.height,c=t.onCurrentTimeChange,o=t.onEnd;Object(He.a)(this,e),this.tickTime=-1,this.tickReq=0,this.painter=void 0,this.currentTime=0,this.duration=0,this.clips=[],this.playing=!1,this.width=0,this.height=0,this.tickFun=void 0,this.onCurrentTimeChange=void 0,this.onEnd=void 0,this.width=i,this.height=a,this.painter=new pt(i,a),this.tickFun=this.tick.bind(this),this.clips=(r||[]).flat(1).map((function(e){return bt(e,n)})),this.updateDuration(),this.onCurrentTimeChange=c,this.onEnd=o}return Object(qe.a)(e,[{key:"updateDuration",value:function(){var e=this;this.duration=0,this.clips.forEach((function(t){var n=t.config;n.end>e.duration&&(e.duration=n.end)}))}},{key:"isInRange",value:function(e){var t=e.config,n=t.start,r=t.end;return n<=this.currentTime&&r>=this.currentTime}},{key:"getClipById",value:function(e){return this.clips.find((function(t){return t.config.id===e}))}},{key:"addClip",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(t){var n;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=bt(t,this),e.next=3,n.init();case 3:this.clips.push(n),this.updateDuration(),this.pause();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeClip",value:function(e){var t=this.getClipById(e);t&&(t.destroy(),t.removeFromPainter(),this.clips.splice(this.clips.indexOf(t),1),this.updateDuration(),this.pause())}},{key:"play",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playing||(this.playing=!0,this.tickReq=requestAnimationFrame(this.tickFun)),e.next=3,this.renderFrame(!1);case 3:this.tickTime=performance.now();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"tick",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(t){var n,r;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Math.ceil(t-this.tickTime),!(this.currentTime+n>=this.duration)){e.next=9;break}return this.currentTime=this.duration,e.next=5,this.renderFrame(!1);case 5:this.pause(),null===(r=this.onEnd)||void 0===r||r.call(this),e.next=14;break;case 9:return this.currentTime+=n,e.next=12,this.renderFrame(!1);case 12:this.tickTime=t,this.tickReq=requestAnimationFrame(this.tickFun);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pause",value:function(){this.tickTime=-1,this.playing=!1,cancelAnimationFrame(this.tickReq),this.clips.forEach((function(e){e.pause()}))}},{key:"setCurrentTime",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(t){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pause(),this.currentTime=t,e.next=4,this.renderFrame(!0);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderFrame",value:function(){var e=Object(_e.a)(Ye.a.mark((function e(t){var n,r,i,a;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.clips,i=this.clips.length,a=0;case 3:if(!(a<i)){e.next=9;break}return e.next=6,r[a].onCurrentTimeChange(t);case 6:a++,e.next=3;break;case 9:this.painter.render(),null===(n=this.onCurrentTimeChange)||void 0===n||n.call(this,this.currentTime);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.clips.forEach((function(e){e.destroy()})),this.clips.length=0,this.clips=[]}},{key:"attachTo",value:function(e){e.appendChild(this.painter.getDomElement())}}]),e}(),gt=a.a.createContext(y),xt=function(){var e=Object(i.useState)(null),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)([[]]),c=Object(s.a)(a,2),o=c[0],u=c[1],l=Object(i.useState)(-1),d=Object(s.a)(l,2),f=d[0],h=d[1],p=Object(i.useState)(0),v=Object(s.a)(p,2),b=v[0],m=v[1],x=Object(i.useState)(""),j=Object(s.a)(x,2),O=j[0],y=j[1],w=Object(i.useState)(0),k=Object(s.a)(w,2),T=k[0],E=k[1],C=Object(i.useRef)(null),I=Object(i.useCallback)((function(e){var t=e.filter((function(e){return e.length})),n=N(t);n!==b&&(m(n),T>n&&E(n)),t.flat(1).forEach((function(e,t){e.zIndex=t})),u(t.length?t:[[]])}),[T,b]);Object(i.useEffect)((function(){if(b){var e=document.querySelector(".tracks-wrapper");if(e){var t=e.clientWidth,n=L(b);t<n&&(e.style.width="".concat(n+100,"px"))}}}),[b]);var R={hoverTrack:n,setHoverTrack:r,tracks:o,setTracks:I,newTrackIndex:f,setNewTrackIndex:h,activeClipId:O,setActiveClipId:y,currentTime:T,setCurrentTime:E,totalDuration:b,setTotalDuration:m};ze(R);var F=function(e,t){var n=Object(i.useRef)(),r=e.tracks,a=e.setCurrentTime,c=e.currentTime,o=e.totalDuration,u=Object(i.useState)(!1),l=Object(s.a)(u,2),d=l[0],f=l[1];return Object(i.useEffect)((function(){!n.current&&t.current&&(n.current=new mt({tracks:r,width:720,height:480,onCurrentTimeChange:function(e){a(e)},onEnd:function(){f(!1)}}),n.current.attachTo(t.current))}),[t,a,r]),Object(i.useEffect)((function(){if(n.current&&r.length){var e,t=function(e,t){var n=[],r=[],i=t.flat(1);return e.forEach((function(e){!i.find((function(t){return t.id===e.config.id}))&&e.config.id&&r.push(e.config.id)})),i.forEach((function(t,r){e.find((function(e){return e.config.id===t.id}))||n.push(t)})),{newClips:n,deleteClips:r}}(n.current.clips,r),i=t.newClips,a=t.deleteClips;i.forEach(function(){var e=Object(_e.a)(Ye.a.mark((function e(t){var r,i;return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=n.current)||void 0===r?void 0:r.addClip(t);case 2:null===(i=n.current)||void 0===i||i.renderFrame(!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.length&&(a.forEach((function(e){var t;null===(t=n.current)||void 0===t||t.removeClip(e)})),null===(e=n.current)||void 0===e||e.renderFrame(!0))}}),[r]),Object(i.useEffect)((function(){n.current&&(d?n.current.play():n.current.pause())}),[d]),Object(i.useEffect)((function(){n.current&&c>=0&&!d&&n.current.setCurrentTime(c)}),[c,d]),Object(i.useEffect)((function(){n.current&&o>=0&&n.current.updateDuration()}),[o]),{player:n.current,playing:d,setPlaying:f}}(R,C),M=F.playing,A=F.setPlaying,S=Object(i.useCallback)((function(){A(!M)}),[M,A]);return Object(g.jsx)(gt.Provider,{value:R,children:Object(g.jsxs)(Ae,{children:[Object(g.jsx)(Se,{children:Object(g.jsx)(xe,{})}),Object(g.jsx)(Ne,{children:Object(g.jsxs)(Pe,{children:[Object(g.jsxs)("div",{style:{display:"flex",justifyContent:"space-evenly"},children:[Object(g.jsx)(ge,{}),Object(g.jsx)("div",{ref:C,style:{width:720,height:480}}),Object(g.jsx)("div",{onClick:S,children:M?"\u6682\u505c":"\u64ad\u653e"})]}),Object(g.jsxs)(Ue,{children:[Object(g.jsx)("div",{children:"Toolbar"}),Object(g.jsx)(Ge,{}),Object(g.jsx)(Me,{})]})]})})]})})};n(35);o.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(xt,{})}),document.getElementById("root"))},5:function(e,t){e.exports=THREE}},[[36,1,2]]]);
//# sourceMappingURL=main.0cc26dc5.chunk.js.map