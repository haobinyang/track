(this["webpackJsonpgo-think"]=this["webpackJsonpgo-think"]||[]).push([[0],{196:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(35),c=n.n(a),o=n(12),s=n(2),u=n(1);var l=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#C9AE4D",strokeWidth:2})}))};var f=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#38AA26",strokeWidth:2})}))};var h=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#C9AE4D",strokeWidth:2})}))};var d=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#C9AE4D",strokeWidth:2})}))};var p=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#AA269D",strokeWidth:2})}))};var v=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#864CFF",strokeWidth:2})}))};var b,g=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none"},e),{},{children:Object(u.jsx)("rect",{x:1,y:1,width:28,height:28,rx:9,stroke:"#367CE4",strokeWidth:2})}))};!function(e){e[e.VIDEO=0]="VIDEO",e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.TRANSITION=3]="TRANSITION",e[e.GIF=4]="GIF",e[e.TEXT=5]="TEXT"}(b||(b={}));var j,m,x,O;!function(e){e[e.CUSTOM=0]="CUSTOM",e[e.FILL=1]="FILL",e[e.CONTAIN=2]="CONTAIN",e[e.COVER=3]="COVER"}(j||(j={})),function(e){e[e.NO_EFFECT=0]="NO_EFFECT",e[e.BLUR=1]="BLUR",e[e.GRAY=2]="GRAY"}(m||(m={})),function(e){e[e.MORPH=0]="MORPH",e[e.DREAMY=1]="DREAMY",e[e.FADE=2]="FADE"}(x||(x={})),function(e){e[e.PLUNGING=0]="PLUNGING"}(O||(O={}));var w,y,k,I,T,C,R=[{name:"dreamy",transition:x.DREAMY},{name:"fade",transition:x.FADE}],E={videos:[{name:"leaf",url:"1.mp4"},{name:"sunflower",url:"https://adsmind.gdtimg.com/ads_svp_video__0b5356bikoyameao6cufayabuqaee7xqhbibaaaab3yk..mp4?dis_k=00336127182714ebee73d007e9ebd394&dis_t=1631259090&m=78f766034a7339a822b3a1881bf122b6"},{name:"cartoon",url:"3.webm"}].map((function(e){return Object(s.a)({type:b.VIDEO},e)})),images:[{name:"dawn",url:"https://images.unsplash.com/photo-1634322474954-d69e93a8480b?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=2370&q=80"}].map((function(e){return Object(s.a)({type:b.IMAGE},e)})),audios:[{name:"sky",url:"1.mp3"},{name:"jay",url:"2.mp3"}].map((function(e){return Object(s.a)({type:b.AUDIO},e)})),transitions:R.map((function(e){return Object(s.a)({type:b.TRANSITION},e)})),gifs:[{name:"horses",url:"horses.gif"}].map((function(e){return Object(s.a)({type:b.GIF},e)})),texts:[{name:"\u6587\u672c",value:"\u6dfb\u52a0\u6587\u672c"}].map((function(e){return Object(s.a)({type:b.TEXT},e)}))},A=n(7),S=n(11),F=S.a.div(w||(w=Object(A.a)(["\n  width: 30px;\n  height: 30px;\n  background: #1F2836;\n  border: 1px solid #222B3A;\n  box-sizing: border-box;\n  border-radius: 10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n\n  &:hover {\n    background: #232d3d;\n  }\n"]))),M=S.a.div(y||(y=Object(A.a)(["\n  height: 24px;\n  padding: 0 14px;\n  background: #1F2836;\n  box-sizing: border-box;\n  border-radius: 99px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  color: #92AEDA;\n\n  &:hover {\n    background: #263142;\n  }\n"]))),U=S.a.div(k||(k=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-top: 20px;\n  padding: 8px 0;\n  cursor: pointer;\n  background-color: #1A2028;\n\n  &.active {\n    background-color: #384454;\n  }\n\n  &:hover {\n    background-color: #384454;\n  }\n\n  .icon {\n    width: 30px;\n    height: 30px;\n  }\n\n  .title {\n    margin-top: 10px;\n    font-size: 14px;\n    line-height: 16px;\n    color: #7185A6;\n  }\n"]))),L=S.a.div(I||(I=Object(A.a)(["\n  width: 160px;\n  height: 90px;\n  margin: 20px 0 0 20px;\n"]))),D=S.a.div(T||(T=Object(A.a)(["\n  width: 100%;\n  height: 100%;\n  border-radius: 6px;\n  cursor: move;\n  overflow: hidden;\n  position: relative;\n\n  img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    vertical-align: unset;\n  }\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .title {\n    position: absolute;\n    bottom: 10px;\n    left: 10px;\n    color: #fff;\n    text-shadow: #000 2px 0px 5px;\n    font-size: 14px;\n    height: 14px;\n    line-height: 14px;\n  }\n"]))),P=n(26),N=n(201);function V(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i="",r=e%1e3;(r||t)&&(i=".".concat(String(r).padStart(3,"0")));var a=(e-r)/1e3,c=a%60;i="".concat(String(c).padStart(2,"0")).concat(i);var o=(a-c)/60,s=o%60;i="".concat(String(s).padStart(2,"0"),":").concat(i);var u=(o-s)/60;return(n||u)&&(i="".concat(String(u).padStart(2,"0"),":").concat(i)),i}function G(e,t,n){return new Promise((function(i,r){var a=t.width,c=t.height,o=new Image;o.width=a,o.height=c,o.onload=function(){n&&(n.clearRect(0,0,a,c),n.drawImage(o,0,0)),i(!0)},o.onerror=function(e){r(e)},o.src="data:image/svg+xml;base64,".concat(btoa(unescape(encodeURIComponent(e.trim()))))}))}function z(e,t){var n=document.createElement("a");if(n.href=e,n.target="_blank",n.download=t,navigator.userAgent.toLowerCase().match(/(ipad|iphone|safari)/)&&navigator.userAgent.search("Chrome")<0)document.location=n.href;else{var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(i),(window.URL||window.webkitURL).revokeObjectURL(n.href)}}function H(e){var t=e.props,n=t.fontColor,i=t.fontSize,r=t.fontFamily;return["color:".concat(n),"font-size:".concat(i,"px"),"font-family:".concat(r),"font-weight:200","display:inline-block","transform-origin:left top","transform:scale(".concat(2,")")].join(";")}function B(e){var t=document.querySelector(".div-for-text-size-calc");t||((t=document.createElement("div")).setAttribute("class","div-for-text-size-calc"),document.body.appendChild(t)),t.innerText=e.value,t.style.cssText=H(e);var n=t.getBoundingClientRect();return{width:Math.ceil(n.width),height:Math.ceil(n.height)}}!function(e){e[e.ALL=0]="ALL",e[e.EW=1]="EW",e[e.NS=2]="NS"}(C||(C={}));var W,Y=function(e){var t=e.children,n=e.direction,a=void 0===n?C.ALL:n,c=e.scrollContainerSelector,s=e.autoGrow,l=e.enable,f=void 0===l||l,h=e.attachData,d=e.slow,p=void 0===d?1:d,v=e.onStart,b=e.onMove,g=e.onEnd,j=Object(i.useRef)(null),m=Object(i.useRef)(0),x=Object(i.useRef)(0),O=Object(i.useRef)(0),w=Object(i.useRef)(""),y=Object(i.useRef)(0),k=Object(i.useRef)(0),I=Object(i.useRef)(0),T=Object(i.useRef)(0),R=Object(i.useRef)(!1),E=Object(i.useRef)(0),A=Object(i.useRef)(!1),S=Object(i.useRef)(!1),F=Object(i.useState)(),M=Object(o.a)(F,2),U=M[0],L=M[1];Object(i.useEffect)((function(){U&&(R.current?(E.current=0,null===g||void 0===g||g(U)):(E.current=E.current+1,E.current%p===0&&(null===b||void 0===b||b(U))),L(void 0))}),[U,g,b,p]);var D=Object(i.useCallback)((function(e,t,n){var i="";C.ALL===a&&(i="translate(".concat(t-m.current,"px, ").concat(n-x.current,"px)")),C.EW===a&&(i="translate(".concat(t-m.current,"px, ").concat(k.current,"px)")),C.NS===a&&(i="translate(".concat(y.current,"px, ").concat(n-x.current,"px)")),e.style.transform=i}),[a]),P=Object(i.useCallback)((function(e,t,n){O.current=window.setInterval((function(){var i=t.getBoundingClientRect();e>0&&s&&t.scrollLeft+i.width>n.clientWidth-100&&(n.style.width="".concat(n.clientWidth+100,"px")),t.scrollLeft+=2*e}),1e3/60)}),[s]),N=Object(i.useCallback)((function(e,t,n){if(O&&(window.clearInterval(O.current),O.current=0),c){var i=100,r=document.querySelector(c);if(!S.current){if(!(null===e||void 0===e?void 0:e.closest(c)))return;S.current=!0}if(null===r||void 0===r?void 0:r.parentElement){var a=r.parentElement,o=a.getBoundingClientRect(),u=0;t>o.right-i?(s&&a.scrollLeft+o.width>r.clientWidth-100&&(r.style.width="".concat(r.clientWidth+100,"px")),u=5*(1+Math.min((t-o.right+i)/i,1))):t<o.left+i&&(u=-5*(1+Math.min((o.left+i-t)/i,1))),0!==u&&(a.scrollLeft+=u,P(u,a,r))}}}),[s,P,c]),V=Object(i.useCallback)((function(e){var t=j.current;if(t){t.hidden=!0;var n=document.elementFromPoint(e.clientX,e.clientY);D(t,e.pageX,e.pageY),N(n,e.pageX,e.pageY);var i=e.pageX-m.current,r=e.pageY-x.current,a=i-I.current,c=r-T.current;0===a&&0===c||(A.current=!0,L({element:t,belowElement:n,left:i,top:r,originalLeft:y.current,originalTop:k.current,stepLeft:i-I.current,stepTop:r-T.current,cursorLeft:e.pageX,cursorTop:e.pageY,attachData:h,isMoved:A.current}),I.current=i,T.current=r),t.hidden=!1}}),[D,N,h]),G=Object(i.useCallback)((function(e){var t=e.pageX,n=e.pageY,i=j.current;if(i){i.hidden=!0;var r=document.elementFromPoint(e.clientX,e.clientY);i.hidden=!1,i.classList.remove("dragged"),i.setAttribute("style",w.current),R.current=!0,L({element:i,belowElement:r,left:t-m.current,top:n-x.current,originalLeft:y.current,originalTop:k.current,stepLeft:0,stepTop:0,cursorLeft:t,cursorTop:n,attachData:h,isMoved:A.current})}window.clearInterval(O.current),window.removeEventListener("mousemove",V,!1),window.removeEventListener("mouseup",G,!1)}),[h,V]),z=Object(i.useCallback)((function(e){if(e.stopPropagation(),j.current){R.current=!1;var t=j.current,n=t.getBoundingClientRect(),i=n.left,r=n.top,a=n.width,c=n.height;m.current=e.clientX-i,x.current=e.clientY-r,w.current=t.getAttribute("style")||"",y.current=i,k.current=r,I.current=i,T.current=r,S.current=!1,A.current=!1,function(e,t){Object.keys(t).forEach((function(n){e.style.setProperty(n.replace(/([A-Z])/g,"-$1").toLowerCase(),t[n])}))}(t,{transform:"translate(".concat(i,"px, ").concat(r,"px)"),width:"".concat(a,"px"),height:"".concat(c,"px")}),t.classList.add("dragged"),null===v||void 0===v||v(),D(t,e.pageX,e.pageY),window.addEventListener("mousemove",V,!1),window.addEventListener("mouseup",G,!1)}}),[V,G,D,v]);return Object(i.useEffect)((function(){var e=j.current;if(e&&f)return e.addEventListener("mousedown",z,!1),function(){e.removeEventListener("mousedown",z,!1)}}),[j,f,z]),Object(u.jsx)(u.Fragment,{children:r.a.cloneElement(t,{ref:function(e){return j.current=e}})})};!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VIDEO=1]="VIDEO",e[e.IMAGE=2]="IMAGE",e[e.AUDIO=3]="AUDIO",e[e.TRANSITION=4]="TRANSITION",e[e.SVG=5]="SVG",e[e.LOTTIE=6]="LOTTIE",e[e.TEXT=7]="TEXT",e[e.GIF=8]="GIF"}(W||(W={}));var X,J,q,Z,Q=n(3),K=n.n(Q),_=n(5),$=n(14),ee=n(15),te=n(24),ne=n(18),ie=n(25),re=n(23),ae=function(){function e(t,n){Object($.a)(this,e),this.isAttachToPainter=!1,this.isEntered=!1,this.player=void 0,this.painter=void 0,this.sprite=void 0,this.config=void 0,this.texture=void 0,this.config=t,this.player=n,this.painter=n.painter}return Object(ee.a)(e,[{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"show",value:function(){this.sprite&&(this.sprite.visible=!0)}},{key:"hide",value:function(){this.sprite&&(this.sprite.visible=!1)}},{key:"updatePlaybackRate",value:function(){}},{key:"getOriginalDuration",value:function(){return this.config.playRange.end-this.config.playRange.start}},{key:"addToPainter",value:function(){!this.isAttachToPainter&&this.sprite&&this.config.id&&(this.isAttachToPainter=!0,this.player.painter.add(this.sprite,this.config.id))}},{key:"removeFromPainter",value:function(){this.isAttachToPainter&&this.config.id&&(this.isAttachToPainter=!1,this.player.painter.remove(this.config.id))}},{key:"onEnter",value:function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onLeave",value:function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.removeFromPainter();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ce=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).context=new AudioContext,e.audioBuffer=void 0,e.source=void 0,e.playbackRate=1,e.isPlaying=!1,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAudioBuffer();case 3:this.audioBuffer=e.sent,this.updatePlaybackRate(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAudioBuffer",value:function(){var e=this;return new Promise((function(t,n){e.context.decodeAudioData(e.config.buffer.slice(0),(function(e){e?t(e):n(!1)}),(function(e){n(e)}))}))}},{key:"play",value:function(){if(this.audioBuffer){var e=this.context.createBufferSource();e.buffer=this.audioBuffer,e.loop=!1,e.start(0,(this.config.playRange.start+(this.player.currentTime-this.config.positionInTimeline.start)*this.playbackRate)/1e3),this.isPlaying=!0,this.source=e,this.source.connect(this.context.destination)}}},{key:"pause",value:function(){this.source&&(this.source.stop(),this.isPlaying=!1)}},{key:"updatePlaybackRate",value:function(){var e=this.config.playRange.end-this.config.playRange.start;this.playbackRate=e/this.config.positionInTimeline.duration}},{key:"onEnter",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.player.isPlaying&&this.play();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onLeave",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.player.isPlaying&&this.pause();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(this.pause(),this.player.isPlaying&&this.play());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.source)||void 0===t||t.stop();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae),oe=n(22),se=n(8);function ue(e,t,n,i,r,a,c){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:new se.Vector2(0,0),s=i,u=r,l=o.clone();if(e===j.CONTAIN){var f=t/n,h=a/c;f/h>1?(u=n,s=a*(n/c),l.set(.5*(t-s),0)):(s=t,u=c*(t/a),l.set(0,.5*(n-u)))}else if(e===j.COVER){var d=t/n,p=a/c;d/p>1?(s=t,u=c*(t/a),l.set(0,.5*(n-u))):(u=n,s=a*(n/c),l.set(.5*(t-s),0))}else e===j.FILL&&(s=t,u=n,l.set(0,0));var v=new se.Vector2(-l.x/s+0,(t-l.x)/s),b=new se.Vector2(-l.y/u+0,(n-l.y)/u);return[v,b]}var le,fe,he,de,pe=function(){function e(){Object($.a)(this,e)}return Object(ee.a)(e,null,[{key:"GetVertex",value:function(){return Object(oe.glsl)(X||(X=Object(A.a)(["\n      varying vec2 texCoords;\n      void main() {\n        texCoords = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    "])))}},{key:"GetFragment",value:function(){return Object(oe.glsl)(J||(J=Object(A.a)(["\n      varying vec2 texCoords;\n      uniform sampler2D tex;\n      void main() {\n        gl_FragColor = texture2D(tex, texCoords);\n      }\n    "])))}},{key:"GetEffectFragment",value:function(e){var t=e.effect;return Object(oe.glsl)(q||(q=Object(A.a)(["\n      varying vec2 texCoords;\n      uniform vec2 uRange;\n      uniform vec2 vRange;\n      uniform sampler2D tex;\n      ","\n      vec4 getColor(vec2 uv) {\n        vec2 newUV = vec2(uRange.x + uv.x * (uRange.y - uRange.x), vRange.x + uv.y * (vRange.y - vRange.x));\n        vec4 color = effect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      void main() {\n        gl_FragColor = getColor(texCoords);\n      }\n    "])),t)}},{key:"GetTransitionFragment",value:function(e){var t=e.fromEffect,n=e.toEffect,i=e.transition;return Object(oe.glsl)(Z||(Z=Object(A.a)(["\n      varying vec2 texCoords;\n      uniform sampler2D from, to;\n      uniform vec2 fromURange, fromVRange;\n      uniform vec2 toURange, toVRange;\n      uniform float fromRatio, toRatio;\n      uniform float progress;\n      ","\n      ","\n      vec4 getFromColor(vec2 uv) {\n        vec2 newUV = vec2(fromURange.x + uv.x * (fromURange.y - fromURange.x), fromVRange.x + uv.y * (fromVRange.y - fromVRange.x));\n        vec4 color = fromEffect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      vec4 getToColor(vec2 uv) {\n        vec2 newUV = vec2(toURange.x + uv.x * (toURange.y - toURange.x), toVRange.x + uv.y * (toVRange.y - toVRange.x));\n        vec4 color = toEffect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      ","\n      void main() {\n        gl_FragColor = transition(texCoords);\n      }\n    "])),t,n,i)}}]),e}(),ve=n(33);var be=(de={},Object(ve.a)(de,m.NO_EFFECT,(function(){return{uniforms:{},fragment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tex",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"effect";return Object(oe.glsl)(le||(le=Object(A.a)(["\n      vec4 ","(vec2 uv) {\n        return texture2D(",", uv);\n      }\n    "])),t,e)}}})),Object(ve.a)(de,m.GRAY,(function(){return{uniforms:{},fragment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tex",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"effect";return Object(oe.glsl)(fe||(fe=Object(A.a)(["\n      vec4 ","(vec2 uv) {\n        vec4 color = texture2D(",", uv);\n        float gray = (color.r+color.g+color.b)/3.;\n        return vec4(gray,gray,gray,color.a);\n      }\n    "])),t,e)}}})),Object(ve.a)(de,m.BLUR,(function(e){return{uniforms:{blurSize:{value:10},horizontalPass:{value:1},sigma:{value:3},texOffset:{value:new se.Vector2(1,1)}},fragment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tex",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"effect";return Object(oe.glsl)(he||(he=Object(A.a)(["\n      const float PI = 3.14159265;\n      vec4 ","(vec2 uv) {\n        float numBlurPixelsPerSide = float(blurSize / 2);\n\n        vec3 incrementalGaussian;\n        incrementalGaussian.x = 1.0 / (sqrt(2.0 * PI) * sigma);\n        incrementalGaussian.y = exp(-0.5 / (sigma * sigma));\n        incrementalGaussian.z = incrementalGaussian.y * incrementalGaussian.y;\n\n        vec4 avgValue = vec4(0.0, 0.0, 0.0, 0.0);\n        float coefficientSum = 0.0;\n        avgValue += texture2D(",", uv) * incrementalGaussian.x;\n        coefficientSum += incrementalGaussian.x;\n        incrementalGaussian.xy *= incrementalGaussian.yz;\n\n        for (float i = 1.0; i <= numBlurPixelsPerSide; i++) { \n          avgValue += texture2D(",", uv - i * texOffset) * incrementalGaussian.x;         \n          avgValue += texture2D(",", uv + i * texOffset) * incrementalGaussian.x;         \n          coefficientSum += 2.0 * incrementalGaussian.x;\n          incrementalGaussian.xy *= incrementalGaussian.yz;\n        }\n\n        return avgValue / coefficientSum;\n      }\n    "])),t,e,e,e)}}})),de);function ge(e){return be[e||m.NO_EFFECT]}var je=new Map;function me(e,t,n){var i;if(!je.has(e)){var r=new Set;je.set(e,Object(ve.a)({},t,r))}var a=je.get(e);a&&!a[t]&&(a[t]=new Set),null===(i=je.get(e))||void 0===i||i[t].add(n);var c=e[t];Object.defineProperty(e,t,{get:function(){return c},set:function(n){var i,r=c;(c=n,n!==r)&&(null===(i=je.get(e))||void 0===i||i[t].forEach((function(e){e(n,r)})))}})}var xe,Oe,we,ye,ke=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).geometry=void 0,e.material=void 0,e.texture=void 0,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initRender();case 2:this.watchChange();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;me(this.config,"zIndex",(function(t){e.sprite&&(e.sprite.position.z=t)})),me(this.config,"effect",(function(t){if(e.material){var n=ge(t)(e),i=n.uniforms,r=n.fragment;e.material.uniforms=Object(s.a)(Object(s.a)({},e.material.uniforms),i),e.material.fragmentShader=pe.GetEffectFragment({effect:r()}),e.material.uniformsNeedUpdate=!0,e.material.needsUpdate=!0}})),me(this.config,"positionInRender",(function(t){if(e.material){var n=e.config.positionInRender,i=n.width,r=n.height,a=n.left,c=n.bottom,s=e.player,u=e.config,l=ue(t.fitType,s.width,s.height,i,r,u.originalWidth,u.originalHeight,new se.Vector2(a,c)),f=Object(o.a)(l,2),h=f[0],d=f[1];e.material.uniforms.uRange.value=h,e.material.uniforms.vRange.value=d,e.material.uniformsNeedUpdate=!0}}))}},{key:"createTexture",value:function(){var e=this;return new Promise((function(t){(new se.TextureLoader).load(e.config.blobUrl,(function(e){t(e)}))}))}},{key:"initRender",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r,a,c,u,l,f,h,d,p,v,b,g,j,m,x;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config,n=t.positionInRender,i=n.width,r=n.height,a=n.fitType,c=n.left,u=n.bottom,l=t.effect,f=t.originalWidth,h=t.originalHeight,d=this.player,p=ge(l)(this),v=p.uniforms,b=p.fragment,g=ue(a,d.width,d.height,i,r,f,h,new se.Vector2(c,u)),j=Object(o.a)(g,2),m=j[0],x=j[1],e.next=6,this.createTexture();case 6:this.texture=e.sent,this.geometry=new se.PlaneGeometry(d.width,d.height),this.material=new se.ShaderMaterial({uniforms:Object(s.a)({tex:{value:this.texture},uRange:{value:m},vRange:{value:x}},v),vertexShader:pe.GetVertex(),fragmentShader:pe.GetEffectFragment({effect:b()})}),this.material.uniformsNeedUpdate=!0,this.material.transparent=!0,this.sprite=new se.Mesh(this.geometry,this.material),this.sprite.position.z=this.config.zIndex;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.texture)||void 0===t||t.dispose(),null===(i=this.geometry)||void 0===i||i.dispose(),null===(r=this.material)||void 0===r||r.dispose();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae),Ie=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).geometry=void 0,e.material=void 0,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initRender(),this.watchChange();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;me(this.config,"zIndex",(function(t){e.sprite&&(e.sprite.position.z=t)}))}},{key:"initRender",value:function(){var e=this.player,t=e.width,n=e.height;this.geometry=new se.PlaneGeometry(t,n),this.material=new se.MeshBasicMaterial;var i=new se.CanvasTexture(document.createElement("canvas"));this.material.map=i,this.material.transparent=!0,this.sprite=new se.Mesh(this.geometry,this.material)}},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(t=this.material)||void 0===t?void 0:t.map)&&(n=this.player.currentTime,this.config.lottie.goToAndStop(n-this.config.positionInTimeline.start),this.material.map.needsUpdate=!0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.geometry)||void 0===t||t.dispose(),null===(i=this.material)||void 0===i||i.dispose();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae),Te=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).canvas=document.createElement("canvas"),e.context=void 0,e.geometry=void 0,e.material=void 0,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initCanvas(),this.initRender(),this.watchChange();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;me(this.config,"zIndex",(function(t){e.sprite&&(e.sprite.position.z=t)}))}},{key:"initCanvas",value:function(){var e=this.painter.getRealSize(),t=e.width,n=e.height;this.canvas.width=t,this.canvas.height=n,this.context=this.canvas.getContext("2d")}},{key:"initRender",value:function(){var e=this.player,t=e.width,n=e.height;this.geometry=new se.PlaneGeometry(t,n),this.material=new se.MeshBasicMaterial,this.material.map=new se.CanvasTexture(this.canvas),this.material.transparent=!0,this.sprite=new se.Mesh(this.geometry,this.material),this.sprite.position.z=this.config.zIndex}},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r,a,c,o,s,u;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=this.material)||void 0===t?void 0:t.map)){e.next=8;break}return n=this.config.positionInTimeline,i=n.start,r=n.end,a=this.player.currentTime,c=this.painter.getRealSize(),o=c.width,s=c.height,u=this.config.func({start:i,end:r,currentTime:a,width:o,height:s}),e.next=7,G(u,this.canvas,this.context);case 7:this.material.map.needsUpdate=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.geometry)||void 0===t||t.dispose(),null===(i=this.material)||void 0===i||i.dispose();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae),Ce=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).canvas=document.createElement("canvas"),e.context=void 0,e.geometry=void 0,e.material=void 0,e.texture=void 0,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initTexture();case 2:this.initRender(),this.watchChange();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;me(this.config,"zIndex",(function(t){e.sprite&&(e.sprite.position.z=t)})),me(this.config,"positionInRender",(function(t){if(e.material){var n=e.config.positionInRender,i=n.width,r=n.height,a=n.left,c=n.bottom,s=e.player,u=e.config,l=ue(t.fitType,s.width,s.height,i,r,u.originalWidth,u.originalHeight,new se.Vector2(a,c)),f=Object(o.a)(l,2),h=f[0],d=f[1];e.material.uniforms.uRange.value=h,e.material.uniforms.vRange.value=d,e.material.uniformsNeedUpdate=!0}}))}},{key:"initTexture",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config,n=t.originalWidth,i=t.originalHeight,this.canvas.width=n,this.canvas.height=i,this.context=this.canvas.getContext("2d"),a=this.config,r='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <foreignObject width="100%" height="100%">\n      <div xmlns="http://www.w3.org/1999/xhtml">\n        <div style="'.concat(H(a),'">\n          ').concat(a.value,"\n        </div>\n      </div>\n    </foreignObject>\n  </svg>"),e.next=7,G(r,this.canvas,this.context);case 7:this.texture=new se.CanvasTexture(this.canvas);case 8:case"end":return e.stop()}var a}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initRender",value:function(){var e=this.config,t=e.positionInRender,n=t.width,i=t.height,r=t.fitType,a=t.left,c=t.bottom,u=e.effect,l=e.originalWidth,f=e.originalHeight,h=this.player,d=ge(u)(this),p=d.uniforms,v=d.fragment;this.geometry=new se.PlaneGeometry(h.width,h.height);var b=ue(r,h.width,h.height,n,i,l,f,new se.Vector2(a,c)),g=Object(o.a)(b,2),j=g[0],m=g[1];this.material=new se.ShaderMaterial({uniforms:Object(s.a)({tex:{value:this.texture},uRange:{value:j},vRange:{value:m}},p),vertexShader:pe.GetVertex(),fragmentShader:pe.GetEffectFragment({effect:v()})}),this.material.transparent=!0,this.sprite=new se.Mesh(this.geometry,this.material),this.sprite.position.z=this.config.zIndex}},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.texture)||void 0===t||t.dispose(),null===(i=this.geometry)||void 0===i||i.dispose(),null===(r=this.material)||void 0===r||r.dispose();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae);var Re=Object.freeze((ye={},Object(ve.a)(ye,x.MORPH,(function(){return{uniforms:{strength:{value:.1}},fragment:Object(oe.glsl)(xe||(xe=Object(A.a)(["\n      uniform float strength; // = 0.1\n      vec4 transition(vec2 p) {\n        vec4 ca = getFromColor(p);\n        vec4 cb = getToColor(p);\n        \n        vec2 oa = (((ca.rg+ca.b)*0.5)*2.0-1.0);\n        vec2 ob = (((cb.rg+cb.b)*0.5)*2.0-1.0);\n        vec2 oc = mix(oa,ob,0.5)*strength;\n        \n        float w0 = progress;\n        float w1 = 1.0-w0;\n        return mix(getFromColor(p+oc*w0), getToColor(p-oc*w1), progress);\n      }\n    "])))}})),Object(ve.a)(ye,x.DREAMY,(function(){return{uniforms:{},fragment:Object(oe.glsl)(Oe||(Oe=Object(A.a)(["\n      vec2 offset(float progress, float x, float theta) {\n        float phase = progress*progress + progress + theta;\n        float shifty = 0.03*progress*cos(10.0*(progress+x));\n        return vec2(0, shifty);\n      }\n      vec4 transition(vec2 p) {\n        return mix(getFromColor(p + offset(progress, p.x, 0.0)), getToColor(p + offset(1.0-progress, p.x, 3.14)), progress);\n      }\n    "])))}})),Object(ve.a)(ye,x.FADE,(function(){return{uniforms:{},fragment:Object(oe.glsl)(we||(we=Object(A.a)(["\n      vec4 transition(vec2 uv) {\n        return mix(\n          getFromColor(uv),\n          getToColor(uv),\n          progress\n        );\n      }\n    "])))}})),ye));function Ee(e){return Re[e]()}var Ae=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).geometry=void 0,e.material=void 0,e.fromClip=void 0,e.toClip=void 0,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initRender();case 2:this.watchChange();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;this.fromClip&&this.toClip&&(me(this.fromClip.config,"effect",(function(){e.updateShader()})),me(this.fromClip.config,"positionInRender",(function(){e.updateUniforms()})),me(this.toClip.config,"effect",(function(){e.updateShader()})),me(this.toClip.config,"positionInRender",(function(){e.updateUniforms()})))}},{key:"updateUniforms",value:function(){if(this.fromClip&&this.toClip&&this.material){var e=this.fromClip.config,t=e.originalWidth,n=e.originalHeight,i=e.positionInRender,r=i.width,a=i.height,c=i.fitType,s=this.toClip.config,u=s.originalWidth,l=s.originalHeight,f=s.positionInRender,h=f.width,d=f.height,p=f.fitType,v=this.player,b=ue(c,v.width,v.height,r,a,t,n),g=Object(o.a)(b,2),j=g[0],m=g[1],x=ue(p,v.width,v.height,h,d,u,l),O=Object(o.a)(x,2),w=O[0],y=O[1];this.material.uniforms.fromURange.value=j,this.material.uniforms.fromVRange.value=m,this.material.uniforms.toURange.value=w,this.material.uniforms.toVRange.value=y,this.material.uniformsNeedUpdate=!0}}},{key:"updateShader",value:function(){if(this.fromClip&&this.toClip&&this.material){var e=this.config.transition,t=this.fromClip.config.effect,n=this.toClip.config.effect,i=ge(t)(),r=i.uniforms,a=i.fragment,c=ge(n)(),o=c.uniforms,u=c.fragment,l=Ee(e),f=l.uniforms,h=l.fragment;this.material.uniforms=Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},this.material.uniforms),r),o),f),this.material.fragmentShader=pe.GetTransitionFragment({fromEffect:a("from","fromEffect"),toEffect:u("to","toEffect"),transition:h}),this.material.needsUpdate=!0}}},{key:"initRender",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r,a,c,u,l,f,h,d,p,v,b,g,j,m,x,O,w,y,k,I,T,C,R,E,A,S,F,M,U,L,D,P,N,V,G,z,H;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.player,n=this.config,i=n.fromId,r=n.toId,a=n.transition,c=this.fromClip=t.getClipById(i),u=this.toClip=t.getClipById(r),c&&u&&(l=c.config,f=l.originalWidth,h=l.originalHeight,d=l.positionInRender,p=d.width,v=d.height,b=d.fitType,g=l.effect,j=u.config,m=j.originalWidth,x=j.originalHeight,O=j.positionInRender,w=O.width,y=O.height,k=O.fitType,I=j.effect,T=ge(g)(),C=T.uniforms,R=T.fragment,E=ge(I)(),A=E.uniforms,S=E.fragment,F=Ee(a),M=F.uniforms,U=F.fragment,L=ue(b,t.width,t.height,p,v,f,h),D=Object(o.a)(L,2),P=D[0],N=D[1],V=ue(k,t.width,t.height,w,y,m,x),G=Object(o.a)(V,2),z=G[0],H=G[1],this.geometry=new se.PlaneGeometry(t.width,t.height),this.material=new se.ShaderMaterial({uniforms:Object(s.a)(Object(s.a)(Object(s.a)({from:{value:c.texture},to:{value:u.texture},progress:{value:0},fromURange:{value:P},fromVRange:{value:N},toURange:{value:z},toVRange:{value:H}},C),A),M),vertexShader:pe.GetVertex(),fragmentShader:pe.GetTransitionFragment({fromEffect:R("from","fromEffect"),toEffect:S("to","toEffect"),transition:U})}),this.material.uniformsNeedUpdate=!0,this.material.transparent=!0,this.sprite=new se.Mesh(this.geometry,this.material),this.sprite.position.z=u.config.zIndex);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fromClip&&this.toClip&&(this.fromClip.hide(),this.toClip.hide(),this.render());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onLeave",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fromClip&&this.toClip&&(this.fromClip.show(),this.toClip.show());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.render();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(t=this.material)||void 0===t?void 0:t.uniforms)&&(n=this.config.positionInTimeline,i=n.start,r=n.end,a=(this.player.currentTime-i)/(r-i),this.material.uniforms.progress.value=a);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.texture)||void 0===t||t.dispose(),null===(i=this.geometry)||void 0===i||i.dispose(),null===(r=this.material)||void 0===r||r.dispose();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae),Se=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).geometry=void 0,e.material=void 0,e.texture=void 0,e.video=void 0,e.playbackRate=1,e.isPlaying=!1,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initRender();case 2:this.updatePlaybackRate(),this.watchChange();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;me(this.config,"zIndex",(function(t){e.sprite&&(e.sprite.position.z=t)})),me(this.config,"effect",(function(t){if(e.material){var n=ge(t)(e),i=n.uniforms,r=n.fragment;e.material.uniforms=Object(s.a)(Object(s.a)({},e.material.uniforms),i),e.material.fragmentShader=pe.GetEffectFragment({effect:r()}),e.material.uniformsNeedUpdate=!0,e.material.needsUpdate=!0}})),me(this.config,"positionInRender",(function(t){if(e.material){var n=e.config.positionInRender,i=n.width,r=n.height,a=n.left,c=n.bottom,s=e.player,u=e.config,l=ue(t.fitType,s.width,s.height,i,r,u.originalWidth,u.originalHeight,new se.Vector2(a,c)),f=Object(o.a)(l,2),h=f[0],d=f[1];e.material.uniforms.uRange.value=h,e.material.uniforms.vRange.value=d,e.material.uniformsNeedUpdate=!0}}))}},{key:"createTexture",value:function(){var e=this;return new Promise(function(){var t=Object(_.a)(K.a.mark((function t(n,i){return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.video=document.createElement("video"),e.video.loop=!1,e.video.autoplay=!1,e.video.addEventListener("loadedmetadata",Object(_.a)(K.a.mark((function t(){var i;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.video){t.next=5;break}return i=new se.VideoTexture(e.video),t.next=4,i.setCurrentTime(e.config.playRange.start);case 4:n(i);case 5:case"end":return t.stop()}}),t)})))),e.video.src=e.config.blobUrl;case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"initRender",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r,a,c,u,l,f,h,d,p,v,b,g,j,m,x;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config,n=t.effect,i=t.positionInRender,r=i.width,a=i.height,c=i.fitType,u=i.left,l=i.bottom,f=t.originalWidth,h=t.originalHeight,d=this.player,p=ge(n)(this),v=p.uniforms,b=p.fragment,g=ue(c,d.width,d.height,r,a,f,h,new se.Vector2(u,l)),j=Object(o.a)(g,2),m=j[0],x=j[1],e.next=6,this.createTexture();case 6:this.texture=e.sent,this.geometry=new se.PlaneGeometry(d.width,d.height),this.material=new se.ShaderMaterial({uniforms:Object(s.a)({tex:{value:this.texture},uRange:{value:m},vRange:{value:x}},v),vertexShader:pe.GetVertex(),fragmentShader:pe.GetEffectFragment({effect:b()})}),this.material.uniformsNeedUpdate=!0,this.material.transparent=!0,this.sprite=new se.Mesh(this.geometry,this.material),this.sprite.position.z=this.config.zIndex;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e;null===(e=this.video)||void 0===e||e.play(),this.isPlaying=!0}},{key:"pause",value:function(){var e;null===(e=this.video)||void 0===e||e.pause(),this.isPlaying=!1}},{key:"updatePlaybackRate",value:function(){var e=this.config.playRange.end-this.config.playRange.start;this.playbackRate=e/this.config.positionInTimeline.duration}},{key:"correctVideoCurrentTime",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.player.currentTime,this.video&&Math.abs(this.video.playbackRate-this.playbackRate)>=1e-5&&(this.video.playbackRate=this.playbackRate),n=this.config.playRange.start+(t-this.config.positionInTimeline.start)*this.playbackRate,e.next=5,this.texture.setCurrentTime(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.player.isPlaying&&this.play();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onLeave",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pause(),!this.texture){e.next=4;break}return e.next=4,this.texture.setCurrentTime(this.config.playRange.start);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,this.correctVideoCurrentTime();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),this.video&&(this.video=void 0),null===(t=this.texture)||void 0===t||t.dispose(),null===(i=this.geometry)||void 0===i||i.dispose(),null===(r=this.material)||void 0===r||r.dispose();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae),Fe=n(95),Me=function(){function e(){Object($.a)(this,e),this.items=[],this.pendingPromise=!1}return Object(ee.a)(e,[{key:"enqueue",value:function(e){var t=this;return new Promise((function(n,i){t.items.push({action:e,resolve:n,reject:i}),t.pendingPromise||t.dequeue()})).then((function(e){return e})).catch((function(e){throw new Error(e)})).finally((function(){t.pendingPromise=!1,t.dequeue()}))}},{key:"dequeue",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.items.shift()){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,this.pendingPromise=!0,e.next=7,t.action();case 7:n=e.sent,t.resolve(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),t.reject(e.t0);case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function Ue(e){try{return e.split(",")[0].replace("Duration:","").trim()}catch(t){return""}}function Le(e){try{var t=e.split("Video:")[1].replace(/\(.*?\)/gi,"").split(","),n=t[2].split("x");return{codec:t[0].trim(),colorSpace:t[1].trim(),resolution:{width:parseInt(n[0].trim()),height:parseInt(n[1].trim())},fps:parseInt(t[4].replace("fps","").trim())}}catch(i){return{}}}function De(e){try{var t=e.split("Audio:")[1].replace(/\(.*?\)/gi,"").split(",");return{codec:t[0].trim(),Hz:parseInt(t[1].replace("Hz","").trim())}}catch(n){return{}}}function Pe(e){if(Math.abs(e-1)<=1e-5)return"";if(e>=.5&&e<=2)return",atempo=".concat(e);if(e>0&&e<.5){for(var t=.5,n=",atempo=0.5";t>e;)t*=.5,n+=",atempo=0.5";return Math.abs(t-e)>1e-5&&(n+=",atempo=".concat((e/t).toFixed(2))),n}if(e>2){for(var i=2,r=",atempo=2.0";i<e;)i*=2,r+=",atempo=2.0";return Math.abs(i-e)>1e-5&&(r+=",atempo=".concat((i/e).toFixed(2))),r}return""}var Ne=function(){function e(){Object($.a)(this,e)}return Object(ee.a)(e,null,[{key:"Load",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ge.ffmpeg.isLoaded()){e.next=3;break}return e.next=3,Ge.ffmpeg.load();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"GetVersion",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge.ffmpeg.run("-version");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"VideoTranscode",value:function(){var t=Object(_.a)(K.a.mark((function t(n){var i,r,a,c,o,s=arguments;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>1&&void 0!==s[1]?s[1]:"h264",r=e.ffmpeg,a="".concat(Object(N.a)()),c="".concat(Object(N.a)(),".mp4"),r.FS("writeFile",a,new Uint8Array(n)),t.next=7,r.run("-i",a,"-c:v",i,"-c:a","aac",c);case 7:return o=r.FS("readFile",c),r.FS("unlink",a),r.FS("unlink",c),t.abrupt("return",o.buffer);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"GetMediaInfo",value:function(){var t=Object(_.a)(K.a.mark((function t(n){var i,r,a;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.ffmpeg,r="".concat(Object(N.a)()),a={},i.setLogger((function(e){var t=e.type,n=e.message;"fferr"===t&&(n.includes("Duration")?a.duration=Ue(n):n.includes("Stream #0")&&(n.includes("Video:")?a.video=Le(n):n.includes("Audio:")&&(a.audio=De(n))))})),i.FS("writeFile",r,new Uint8Array(n)),t.next=7,i.run("-i",r);case 7:return i.FS("unlink",r),t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"MergeAudios",value:function(){var t=Object(_.a)(K.a.mark((function t(n){var i,r,a,c,o,s,u;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.ffmpeg,r="".concat(Object(N.a)(),".aac"),a=Object(N.a)(),c=n.map((function(e,t){return["-i","".concat(a,"_").concat(t),"-ss","".concat(e.from/1e3),"-to","".concat((e.to-e.from)/1e3)]})).flat(1),o=n.map((function(e,t){var n=e.delay/1e3;return"[".concat(t,":a]adelay=").concat(n,"|").concat(n,"|").concat(n,"|").concat(n).concat(Pe(e.tempo),"[a").concat(t,"];")})).join(""),s=n.map((function(e,t){return"[a".concat(t,"]")})).join(""),n.forEach((function(e,t){i.FS("writeFile","".concat(a,"_").concat(t),new Uint8Array(e.buffer))})),t.next=9,i.run.apply(i,Object(P.a)(c).concat(["-filter_complex","".concat(o).concat(s,"amix=inputs=").concat(n.length,"[aout]"),"-map","[aout]",r]));case 9:return u=i.FS("readFile",r),n.forEach((function(e,t){i.FS("unlink","".concat(a,"_").concat(t))})),i.FS("unlink",r),t.abrupt("return",u.buffer);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"ImagesToVideo",value:function(){var t=Object(_.a)(K.a.mark((function t(n){var i,r,a,c,o=arguments;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=o.length>1&&void 0!==o[1]?o[1]:30,r=e.ffmpeg,a="".concat(Object(N.a)(),".mp4"),n.forEach((function(e,t){r.FS("writeFile","export_".concat(t.toString().padStart(4,"0"),".jpg"),new Uint8Array(e))})),t.next=6,r.run("-framerate","".concat(i),"-i","export_%04d.jpg","-c:v","libx264","-pix_fmt","yuv420p","-preset","ultrafast","-crf","1",a);case 6:return c=r.FS("readFile",a),n.forEach((function(e,t){r.FS("unlink","export_".concat(t.toString().padStart(4,"0"),".jpg"))})),r.FS("unlink",a),t.abrupt("return",c.buffer);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"MergeVideoAudio",value:function(){var t=Object(_.a)(K.a.mark((function t(n,i){var r,a,c,o,s;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.ffmpeg,a="".concat(Object(N.a)(),".mp4"),c="".concat(Object(N.a)(),".aac"),o="".concat(Object(N.a)(),".mp4"),r.FS("writeFile",a,new Uint8Array(n)),r.FS("writeFile",c,new Uint8Array(i)),t.next=8,r.run("-i",a,"-i",c,"-c","copy",o);case 8:return s=r.FS("readFile",o),r.FS("unlink",a),r.FS("unlink",c),r.FS("unlink",o),t.abrupt("return",s.buffer);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();Ne.ffmpeg=void 0,Ne.ffmpeg=Object(Fe.createFFmpeg)({log:!1});var Ve=new Me,Ge=new Proxy(Ne,{get:function(e,t){var n=t in e?e[t]:void 0;return"function"===typeof n?Object(_.a)(K.a.mark((function t(){var i,r,a,c=arguments;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=c.length,r=new Array(i),a=0;a<i;a++)r[a]=c[a];return t.abrupt("return",Ve.enqueue(Object(_.a)(K.a.mark((function t(){return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ne.Load();case 2:return t.next=4,n.apply(e,r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))));case 2:case"end":return t.stop()}}),t)}))):n}}),ze=Ge,He=function(e){Object(ie.a)(n,e);var t=Object(re.a)(n);function n(){var e;Object($.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).geometry=void 0,e.material=void 0,e.playbackRate=1,e.textureData=void 0,e.currentFrame=0,e.texture=void 0,e}return Object(ee.a)(n,[{key:"init",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initRender(),this.watchChange();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchChange",value:function(){var e=this;me(this.config,"zIndex",(function(t){e.sprite&&(e.sprite.position.z=t)})),me(this.config,"effect",(function(t){if(e.material){var n=ge(t)(e),i=n.uniforms,r=n.fragment;e.material.uniforms=Object(s.a)(Object(s.a)({},e.material.uniforms),i),e.material.fragmentShader=pe.GetEffectFragment({effect:r()}),e.material.uniformsNeedUpdate=!0,e.material.needsUpdate=!0}})),me(this.config,"positionInRender",(function(t){if(e.material){var n=e.config.positionInRender,i=n.width,r=n.height,a=n.left,c=n.bottom,s=e.player,u=e.config,l=ue(t.fitType,s.width,s.height,i,r,u.originalWidth,u.originalHeight,new se.Vector2(a,c)),f=Object(o.a)(l,2),h=f[0],d=f[1];e.material.uniforms.uRange.value=h,e.material.uniforms.vRange.value=d,e.material.uniformsNeedUpdate=!0}}))}},{key:"createTexture",value:function(e,t,n){this.textureData=new Uint8ClampedArray(e);var i=new se.DataTexture(this.textureData,t,n,se.RGBAFormat);return i.flipY=!0,i}},{key:"initRender",value:function(){var e=this.config,t=e.positionInRender,n=t.fitType,i=t.width,r=t.height,a=t.left,c=t.bottom,u=e.originalWidth,l=e.originalHeight,f=e.effect,h=e.frames,d=this.player,p=ge(f)(this),v=p.uniforms,b=p.fragment,g=ue(n,d.width,d.height,i,r,u,l,new se.Vector2(a,c)),j=Object(o.a)(g,2),m=j[0],x=j[1];this.texture=this.createTexture(h[0].patch,u,l),this.geometry=new se.PlaneGeometry(d.width,d.height),this.material=new se.ShaderMaterial({uniforms:Object(s.a)(Object(s.a)({},v),{},{tex:{value:this.texture},uRange:{value:m},vRange:{value:x}}),vertexShader:pe.GetVertex(),fragmentShader:pe.GetEffectFragment({effect:b()})}),this.material.transparent=!0,this.material.uniformsNeedUpdate=!0,this.sprite=new se.Mesh(this.geometry,this.material),this.sprite.position.z=this.config.zIndex}},{key:"getFrame",value:function(){for(var e=this.config.playRange.start+(this.player.currentTime-this.config.positionInTimeline.start)*this.playbackRate,t=0,n=0;n<this.config.frames.length;n++){var i=this.config.frames[n];if(e<=(t+=i.delay)&&this.currentFrame!==n)return this.currentFrame=n,i}}},{key:"updatePlaybackRate",value:function(){var e=this.config.playRange.end-this.config.playRange.start;this.playbackRate=e/this.config.positionInTimeline.duration}},{key:"onUpdate",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.getFrame())&&this.texture&&this.textureData&&(this.textureData.set(t.patch),this.texture.needsUpdate=!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(te.a)(Object(ne.a)(n.prototype),"destroy",this).call(this),null===(t=this.texture)||void 0===t||t.dispose(),null===(i=this.geometry)||void 0===i||i.dispose(),null===(r=this.material)||void 0===r||r.dispose();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ae);function Be(e,t){switch(e.type){case W.VIDEO:return new Se(e,t);case W.IMAGE:return new ke(e,t);case W.TRANSITION:return new Ae(e,t);case W.TEXT:return new Ce(e,t);case W.AUDIO:return new ce(e,t);case W.SVG:return new Te(e,t);case W.LOTTIE:return new Ie(e,t);case W.GIF:return new He(e,t)}}function We(e){return new Promise((function(t){e.toBlob(function(){var e=Object(_.a)(K.a.mark((function e(n){var i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,n.arrayBuffer();case 3:i=e.sent,t(i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"image/jpeg",1)}))}function Ye(e,t){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(_.a)(K.a.mark((function e(t,n){var i,r,a,c,o,s;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=1e3/n,r=[],a=0;case 3:if(!(a<t.duration)){e.next=13;break}return e.next=6,t.setCurrentTime(a);case 6:return e.next=8,We(t.painter.getDomElement());case 8:c=e.sent,r.push(c),a+=i,e.next=3;break;case 13:if(!(a>t.duration)){e.next=19;break}return t.setCurrentTime(t.duration),e.next=17,We(t.painter.getDomElement());case 17:o=e.sent,r.push(o);case 19:return e.next=21,ze.ImagesToVideo(r,n);case 21:return s=e.sent,r.length=0,e.abrupt("return",s);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(e){var t=[];return e.clips.forEach((function(e){[W.AUDIO,W.VIDEO].includes(e.config.type)&&t.push({delay:e.config.positionInTimeline.start,from:0,to:e.getOriginalDuration(),tempo:e.playbackRate,type:e.config.type,buffer:e.config.buffer.slice(0)})})),t}function qe(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=Object(_.a)(K.a.mark((function e(t){var n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Je(t),e.next=3,ze.MergeAudios(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){return Qe=Object(_.a)(K.a.mark((function e(t){var n,i,r=arguments;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.length>1&&void 0!==r[1]?r[1]:"export.mp4",i=r.length>2&&void 0!==r[2]?r[2]:30,Promise.all([Ye(t,i),qe(t)]).then(function(){var e=Object(_.a)(K.a.mark((function e(t){var i,r,a,c;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(o.a)(t,2),r=i[0],a=i[1],e.next=3,ze.MergeVideoAudio(r,a);case 3:c=e.sent,z(URL.createObjectURL(new Blob([c],{type:"video/mp4"})),n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){alert(e)}));case 3:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}function Ke(e,t,n){var i=e.originalWidth,r=e.originalHeight,a=e.positionInRender,c=a.fitType,o=a.width,s=a.height,u=a.left,l=a.bottom;if(c===j.CONTAIN)t/n/(i/r)>1?(s=n,u=.5*(t-(o=i*(n/r))),l=0):(o=t,u=0,l=.5*(n-(s=r*(t/i))));else if(c===j.COVER){t/n/(i/r)>1?(o=t,u=0,l=.5*(n-(s=r*(t/i)))):(s=n,u=.5*(t-(o=i*(n/r))),l=0)}else c===j.FILL&&(o=t,s=n,u=0,l=0);return{width:o,height:s,left:u,bottom:l}}var _e="track-wrapper",$e=100,et={hoverTrack:null,setHoverTrack:function(){},tracks:[],setTracks:function(){},newTrackIndex:-1,setNewTrackIndex:function(){},activeClipId:"",setActiveClipId:function(){},currentTime:0,setCurrentTime:function(){},totalDuration:0,setTotalDuration:function(){},isPlaying:!1,setIsPlaying:function(){},setDraggingClip:function(){}},tt=".".concat(_e);function nt(e,t){if(e&&t){var n=t.getBoundingClientRect();return{x:Math.max(0,e.x-n.x),y:Math.max(0,e.y-n.y)}}return{x:0,y:0}}function it(e){var t=document.querySelector(".tracks-wrapper");if(e&&t){var n=t.getBoundingClientRect(),i=parseInt(getComputedStyle(t).paddingLeft,10);return{x:Math.max(0,e.x-n.x-i),y:Math.max(0,e.y-n.y)}}return{x:0,y:0}}function rt(e){var t;return e?Array.prototype.slice.call(null===(t=e.parentElement)||void 0===t?void 0:t.querySelectorAll(tt)).indexOf(e):-1}function at(e){for(var t=null===e||void 0===e?void 0:e.parentElement;t;){if(t.classList.contains(_e))return t;t=t.parentElement}return null}function ct(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)if(e[n][i].id===t)return{trackIndex:n,clipIndex:i};return{trackIndex:-1,clipIndex:-1}}function ot(e){return!(0===e.length||1===e.length&&0===e[0].length)}function st(e){return(e||0)/1e3*$e}function ut(e){return Math.round(e/$e*1e3)}function lt(e,t){if(t.length){for(var n=0;n<t.length;n++){var i=t[n].positionInTimeline,r=i.start,a=i.end;if(e>=r&&e<=a)return-1;if(e<r)return n}if(e>t[t.length-1].positionInTimeline.end)return t.length}return 0}function ft(e,t){var n=t[e-1],i=t[e];return n||i?!n&&i?{start:0,end:i.positionInTimeline.start}:n&&i?{start:n.positionInTimeline.end,end:i.positionInTimeline.start}:n&&!i?{start:n.positionInTimeline.end,end:1e10}:{start:0,end:0}:{start:0,end:1e10}}function ht(e,t){if(t[0]>=e[0]&&t[1]<=e[1])return t;if(t[0]>=e[0]&&t[1]>e[1]){var n=t[1]-e[1];return[Math.max(t[0]-n,e[0]),Math.min(t[1]-n,e[1])]}if(t[0]<e[0]&&t[1]<=e[1]){var i=e[0]-t[0];return[Math.max(t[0]+i,e[0]),Math.min(t[1]+i,e[1])]}return t[0]<=e[0]&&t[1]>=e[1]?e:t}function dt(e){var t=0;return e.forEach((function(e){if(null===e||void 0===e?void 0:e.length){var n=e[e.length-1];t=Math.max(t,n.positionInTimeline.end)}})),t}function pt(e){return[W.VIDEO,W.IMAGE,W.GIF].includes(e)}function vt(e,t){return e.flat(1).filter((function(e){return e.type===W.TRANSITION})).findIndex((function(e){return e.fromId===t}))>-1}function bt(e,t){return e.flat(1).filter((function(e){return e.type===W.TRANSITION})).findIndex((function(e){return e.toId===t}))>-1}function gt(e){var t=e.tracks,n=e.activeClipId,i=e.setTracks,r=e.setActiveClipId,a=ct(t,n),c=a.trackIndex,o=a.clipIndex;if(c>-1&&o>-1){var s=t[c][o];if(s.type===W.TRANSITION){var u,l,f=t[c][o-1],h=t[c][o+1],d=t[c][o+2],p=ht([(null===f||void 0===f||null===(u=f.positionInTimeline)||void 0===u?void 0:u.end)||0,(null===d||void 0===d||null===(l=d.positionInTimeline)||void 0===l?void 0:l.start)||1e10],[h.positionInTimeline.start+s.positionInTimeline.duration/2,h.positionInTimeline.end+s.positionInTimeline.duration/2]);Object.assign(h,{positionInTimeline:{start:p[0],end:p[1],duration:p[1]-p[0]}}),t[c].splice(o,1)}else vt(t,n)?(t[c].splice(o,1),t[c].splice(o,1)):bt(t,n)?(t[c].splice(o,1),t[c].splice(o-1,1)):t[c].splice(o,1);r(""),i(Object(P.a)(t))}}function jt(e){var t,n=e.tracks,i=e.activeClipId,r=e.setTracks,a=e.currentTime,c=ct(n,i),o=c.trackIndex,u=c.clipIndex;if(o>-1&&u>-1){var l=n[o][u],f=(t=l.type,[W.AUDIO,W.GIF,W.IMAGE,W.VIDEO].includes(t)),h=l.positionInTimeline,d=h.start,p=h.end;if(f&&d<a&&p>a){var v=(a-d)/(p-d),b=Math.round((l.playRange.end-l.playRange.start)*v);n[o].splice(u+1,0,Object(s.a)(Object(s.a)({},l),{},{id:Object(N.a)(),playRange:{start:b,end:l.playRange.end},positionInTimeline:{start:a,end:p,duration:p-a}})),Object.assign(l,{playRange:{start:l.playRange.start,end:b},positionInTimeline:{start:d,end:a,duration:a-d}}),r(Object(P.a)(n))}}}function mt(){var e=document.querySelector(".player-container");return e?e.getBoundingClientRect():{width:0,height:0,x:0,y:0,left:0,right:0,top:0,bottom:0,toJSON:function(){}}}var xt,Ot=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){t.buffer||fetch(t.url).then((function(e){return e.blob()})).then((function(e){var i=URL.createObjectURL(e),r=document.createElement("audio");r.loop=!1,r.addEventListener("loadedmetadata",(function(){e.arrayBuffer().then((function(e){var i=Math.round(1e3*r.duration);n(Object(s.a)(Object(s.a)({},t),{},{positionInTimeline:Object(s.a)(Object(s.a)({},t.positionInTimeline),{},{duration:i}),playRange:{start:0,end:i},buffer:e}))})).catch((function(e){alert(e.message)}))})),r.src=i})).catch((function(e){alert(e.message)}))}),[t,n]),Object(u.jsxs)(D,{children:[Object(u.jsx)("audio",{src:t.url}),Object(u.jsx)("div",{className:"title",children:t.name})]})},wt=n(71),yt=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){var e;(null===t||void 0===t||null===(e=t.frames)||void 0===e?void 0:e.length)||fetch(t.url).then((function(e){return e.arrayBuffer()})).then((function(e){var i=Object(wt.parseGIF)(e),r=Object(wt.decompressFrames)(i,!0),a=0;r.forEach((function(e){a+=e.delay})),n(Object(s.a)(Object(s.a)({},t),{},{positionInTimeline:Object(s.a)(Object(s.a)({},t.positionInTimeline),{},{duration:a}),positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{width:i.lsd.width,height:i.lsd.height}),playRange:{start:0,end:a},frames:r,originalWidth:i.lsd.width,originalHeight:i.lsd.height}))})).catch((function(e){alert(e.message)}))}),[t,n]),Object(u.jsxs)(D,{children:[Object(u.jsx)("img",{src:t.url,alt:"",draggable:"false"}),Object(u.jsx)("div",{className:"title",children:t.name})]})},kt=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){t.blobUrl||fetch(t.url).then((function(e){return e.blob()})).then((function(e){var i=URL.createObjectURL(e),r=document.createElement("img");r.addEventListener("load",(function(){n(Object(s.a)(Object(s.a)({},t),{},{positionInTimeline:Object(s.a)(Object(s.a)({},t.positionInTimeline),{},{duration:2e3}),positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{width:r.naturalWidth,height:r.naturalHeight}),originalWidth:r.naturalWidth,originalHeight:r.naturalHeight,blobUrl:i}))})),r.src=i})).catch((function(e){alert(e.message)}))}),[t,n]),Object(u.jsxs)(D,{children:[Object(u.jsx)("img",{src:t.url,alt:"",draggable:"false"}),Object(u.jsx)("div",{className:"title",children:t.name})]})},It=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){var e=B(t),i=e.width,r=e.height;n(Object(s.a)(Object(s.a)({},t),{},{positionInTimeline:Object(s.a)(Object(s.a)({},t.positionInTimeline),{},{duration:2e3}),positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{width:i/2,height:r/2}),originalWidth:i,originalHeight:r}))}),[]),Object(u.jsx)(D,{children:Object(u.jsx)("div",{className:"title",children:t.name})})},Tt=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){n(Object(s.a)(Object(s.a)({},t),{},{positionInTimeline:Object(s.a)(Object(s.a)({},t.positionInTimeline),{},{duration:1e3})}))}),[]),Object(u.jsx)(D,{children:Object(u.jsx)("div",{className:"title",children:t.name})})},Ct=function(e){var t=e.data,n=e.onLoaded;return Object(i.useEffect)((function(){t.blobUrl||fetch(t.url).then((function(e){return e.blob()})).then(function(){var e=Object(_.a)(K.a.mark((function e(i){var r,a,c;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.arrayBuffer();case 2:r=e.sent,a=URL.createObjectURL(i),(c=document.createElement("video")).loop=!1,c.addEventListener("loadedmetadata",(function(){var e=Math.round(1e3*c.duration);n(Object(s.a)(Object(s.a)({},t),{},{positionInTimeline:Object(s.a)(Object(s.a)({},t.positionInTimeline),{},{duration:e}),positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{width:c.videoWidth,height:c.videoHeight}),playRange:{start:0,end:e},originalWidth:c.videoWidth,originalHeight:c.videoHeight,blobUrl:a,buffer:r}))})),c.src=a;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){alert(e.message)}))}),[t,n]),Object(u.jsxs)(D,{children:[Object(u.jsx)("video",{src:t.blobUrl}),Object(u.jsx)("div",{className:"title",children:t.name})]})},Rt=S.a.div(xt||(xt=Object(A.a)(["\n  width: 160px;\n  height: 90px;\n  line-height: 90px;\n  text-align: center;\n  border-radius: 6px;\n  background-color: #949494;\n  cursor: pointer;\n"])));function Et(e,t){switch(null===e||void 0===e?void 0:e.type){case W.VIDEO:return Object(u.jsx)(Ct,{data:e,onLoaded:t});case W.IMAGE:return Object(u.jsx)(kt,{data:e,onLoaded:t});case W.AUDIO:return Object(u.jsx)(Ot,{data:e,onLoaded:t});case W.TRANSITION:return Object(u.jsx)(Tt,{data:e,onLoaded:t});case W.GIF:return Object(u.jsx)(yt,{data:e,onLoaded:t});case W.TEXT:return Object(u.jsx)(It,{data:e,onLoaded:t});default:return null}}var At,St,Ft=function(e){var t=e.data,n=Object(i.useContext)(Yi),r=n.setHoverTrack,a=n.tracks,c=n.setTracks,l=n.setNewTrackIndex,f=n.newTrackIndex,h=n.setDraggingClip,d=Object(i.useState)(!1),p=Object(o.a)(d,2),v=p[0],g=p[1],x=Object(i.useState)(function(e,t,n){var i={name:e.name,positionInTimeline:{start:t,end:n,duration:0},positionInRender:{fitType:j.CONTAIN,rotate:0,left:0,bottom:0,width:0,height:0},playRange:{start:0,end:0},effect:m.NO_EFFECT};switch(e.type){case b.VIDEO:return Object(s.a)(Object(s.a)({},i),{},{type:W.VIDEO,url:e.url});case b.IMAGE:return Object(s.a)(Object(s.a)({},i),{},{type:W.IMAGE,url:e.url});case b.AUDIO:return Object(s.a)(Object(s.a)({},i),{},{type:W.AUDIO,url:e.url});case b.TRANSITION:return Object(s.a)(Object(s.a)({},i),{},{type:W.TRANSITION,transition:e.transition});case b.GIF:return Object(s.a)(Object(s.a)({},i),{},{positionInRender:Object(s.a)(Object(s.a)({},i.positionInRender),{},{fitType:j.CUSTOM}),type:W.GIF,url:e.url,frames:[],originalWidth:0,originalHeight:0,zIndex:0});case b.TEXT:return Object(s.a)(Object(s.a)({},i),{},{positionInRender:Object(s.a)(Object(s.a)({},i.positionInRender),{},{fitType:j.CUSTOM,left:50,bottom:50}),props:{fontColor:"#fff",fontSize:16,fontFamily:"Helvetica"},value:e.value,type:W.TEXT,originalWidth:0,originalHeight:0,zIndex:0});default:return{}}}(t)),O=Object(o.a)(x,2),w=O[0],y=O[1],k=Object(i.useCallback)((function(){h(w)}),[w,h]),I=Object(i.useCallback)((function(e){if((null===w||void 0===w?void 0:w.type)!==W.TRANSITION){var t=at(e.belowElement);if(t){var n=nt({x:e.cursorLeft,y:e.cursorTop},t),i=ot(a),c=rt(t);n.y<=12&&i?l(c):n.y>=t.clientHeight-12&&i?l(c+1):l(-1)}r(t)}}),[null===w||void 0===w?void 0:w.type,r,l,a]),T=Object(i.useCallback)((function(e){var t=e.belowElement;if(t.classList.contains("transition-insert")&&w){var n=t.dataset.from,i=t.dataset.to,o=ct(a,n),u=o.trackIndex,f=o.clipIndex,d=a[u][f],p=a[u][f+1],v=w.positionInTimeline.duration/2,b=Object(s.a)(Object(s.a)({},w),{},{id:Object(N.a)(),positionInTimeline:Object(s.a)(Object(s.a)({},w.positionInTimeline),{},{start:d.positionInTimeline.end-v,end:d.positionInTimeline.end+v}),fromId:n,toId:i});Object.assign(p,{positionInTimeline:Object(s.a)(Object(s.a)({},p.positionInTimeline),{},{start:p.positionInTimeline.start-v,end:p.positionInTimeline.end-v})}),a[u].splice(f+1,0,b),c(Object(P.a)(a))}h(void 0),l(-1),r(null)}),[w,h,r,l,c,a]),R=Object(i.useCallback)((function(e){if((null===w||void 0===w?void 0:w.type)!==W.TRANSITION){var t=at(e.belowElement),n=it({x:e.cursorLeft,y:e.cursorTop}),i=-1;f>-1?(i=f,a.splice(i,0,[])):t&&(i=rt(t));var u=a[i];if(i>-1&&u){var d=lt(ut(n.x),u);if(d>-1){var p=ft(d,u);if(p.start||p.end){var v,b=(null===w||void 0===w||null===(v=w.positionInTimeline)||void 0===v?void 0:v.duration)||0,g=st(b),j=e.element.clientWidth,m=e.cursorLeft-e.left,x=ut(Math.max(0,n.x-m/j*g)),O=ht([p.start,p.end],[x,x+b]),y=Object(o.a)(O,2),k=y[0],I=y[1],C=mt(),R=C.height,E=C.width,A=Ke(w,E,R),S=A.width,F=A.height,M=A.left,U=A.bottom,L=Object(s.a)(Object(s.a)({},w),{},{id:Object(N.a)(),positionInTimeline:{start:k,end:I,duration:I-k},positionInRender:Object(s.a)(Object(s.a)({},w.positionInRender),{},{width:S,height:F,left:M,bottom:U})});u.splice(d,0,L),c(Object(P.a)(a))}}}h(void 0),l(-1),r(null)}else T(e)}),[w,T,f,h,r,l,c,a]),E=Object(i.useCallback)((function(e){y(Object(s.a)(Object(s.a)({},w),e)),g(!0)}),[w]);return Object(u.jsx)(Y,{direction:C.ALL,scrollContainerSelector:".tracks-wrapper",autoGrow:!0,enable:v,slow:2,onStart:k,onMove:I,onEnd:R,children:Object(u.jsx)(Rt,{children:Et(w,E)})})},Mt=function(){return Object(u.jsx)(u.Fragment,{children:E.audios.map((function(e){return Object(u.jsx)(L,{children:Object(u.jsx)(Ft,{data:e})},e.name)}))})},Ut=function(){return Object(u.jsxs)(u.Fragment,{children:[E.images.map((function(e){return Object(u.jsx)(L,{children:Object(u.jsx)(Ft,{data:e})},e.name)})),E.gifs.map((function(e){return Object(u.jsx)(L,{children:Object(u.jsx)(Ft,{data:e})},e.name)}))]})},Lt=S.a.div(At||(At=Object(A.a)(["\n  position: fixed;\n  left: 60px;\n  top: 50px;\n  bottom: 300px;\n  width: 380px;\n  background: #1A212B;\n  box-shadow: 5px 0px 9px rgb(0 0 0 / 5%);\n  transition: width 0.1s !important;\n  overflow: hidden;\n  \n  .inner-container {\n    display: flex;\n    flex-wrap: wrap;\n    align-content: flex-start;\n    width: 380px;\n  }\n"]))),Dt=function(e){var t=e.icon,n=e.title,r=e.resourcePanel,a=e.isActive,c=e.onClick,o=Object(i.useCallback)((function(){c(n)}),[c,n]);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)(U,{className:a?"active":"",onClick:o,children:[Object(u.jsx)("div",{className:"icon",children:t}),Object(u.jsx)("div",{className:"title",children:n})]}),Object(u.jsx)(Lt,{style:Object(s.a)({},a?null:{width:0}),children:Object(u.jsx)("div",{className:"inner-container",children:r})})]})},Pt=function(){return Object(u.jsx)(u.Fragment,{})},Nt=function(){return Object(u.jsx)(u.Fragment,{})},Vt=function(){return Object(u.jsx)(u.Fragment,{children:E.texts.map((function(e){return Object(u.jsx)(L,{children:Object(u.jsx)(Ft,{data:e})},e.name)}))})},Gt=function(){return Object(u.jsx)(u.Fragment,{children:E.transitions.map((function(e){return Object(u.jsx)(L,{children:Object(u.jsx)(Ft,{data:e})},e.name)}))})},zt=function(){return Object(u.jsx)(u.Fragment,{children:E.videos.map((function(e){return Object(u.jsx)(L,{children:Object(u.jsx)(Ft,{data:e})},e.name)}))})},Ht=S.a.div(St||(St=Object(A.a)(["\n  background: #1A2028;\n  border: 1px solid rgba(35, 42, 53, 0.8);\n  border-top: none;\n  box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.25);\n  width: 60px;\n"]))),Bt=[{title:"\u6211\u7684",icon:Object(u.jsx)(h,{}),resourcePanel:Object(u.jsx)(Pt,{})},{title:"\u89c6\u9891",icon:Object(u.jsx)(g,{}),resourcePanel:Object(u.jsx)(zt,{})},{title:"\u56fe\u7247",icon:Object(u.jsx)(f,{}),resourcePanel:Object(u.jsx)(Ut,{})},{title:"\u5f62\u72b6",icon:Object(u.jsx)(d,{}),resourcePanel:Object(u.jsx)(Nt,{})},{title:"\u6587\u5b57",icon:Object(u.jsx)(p,{}),resourcePanel:Object(u.jsx)(Vt,{})},{title:"\u97f3\u9891",icon:Object(u.jsx)(l,{}),resourcePanel:Object(u.jsx)(Mt,{})},{title:"\u8f6c\u573a",icon:Object(u.jsx)(v,{}),resourcePanel:Object(u.jsx)(Gt,{})}],Wt=function(){var e=Object(i.useState)(),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(i.useCallback)((function(e){r(n!==e?e:void 0)}),[n]);return Object(u.jsx)(Ht,{children:Bt.map((function(e){return Object(u.jsx)(Dt,{title:e.title,icon:e.icon,resourcePanel:e.resourcePanel,isActive:n===e.title,onClick:a},e.title)}))})};var Yt=function(e){return Object(u.jsxs)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:24,height:28,fill:"none"},e),{},{children:[Object(u.jsx)("g",{filter:"url(#prefix__filter0_d_342:63)",children:Object(u.jsx)("path",{d:"M6 3a1 1 0 011-1h10a1 1 0 011 1v9.586a1 1 0 01-.293.707l-4.414 4.414a1 1 0 01-.707.293h-1.172a1 1 0 01-.707-.293l-4.414-4.414A1 1 0 016 12.586V3z",fill:"#367CE4"})}),Object(u.jsx)("defs",{children:Object(u.jsxs)("filter",{id:"prefix__filter0_d_342:63",x:0,y:0,width:24,height:28,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[Object(u.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),Object(u.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),Object(u.jsx)("feOffset",{dy:4}),Object(u.jsx)("feGaussianBlur",{stdDeviation:3}),Object(u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),Object(u.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),Object(u.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_342:63"}),Object(u.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_342:63",result:"shape"})]})})]}))},Xt=n(96),Jt=n.n(Xt),qt=function(e){var t=e.clip,n=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=n.current;if(e){var i=Jt.a.create({container:e,waveColor:"#216fa3",progressColor:"purple",fillParent:!0,partialRender:!0,interact:!1,height:36});return i.load(t.url),function(){i.destroy()}}}),[t.url]),Object(u.jsx)("div",{style:{width:"100%"},children:Object(u.jsx)("div",{ref:n,style:{position:"absolute",left:0,right:0,top:0,bottom:0}})})};function Zt(){return new Worker(n.p+"static/js/gifToCanvas.worker.e6946d48.worker.js")}function Qt(){return(Qt=Object(_.a)(K.a.mark((function e(t,n,i,r,a){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.postMessage({snapCount:n,from:i,to:r,frames:a});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Kt=function(e){var t=e.clip,n=t.positionInTimeline,r=t.originalWidth,a=t.originalHeight,c=t.frames,o=Math.ceil(st(n.duration)/36),s=Object(i.useRef)(null),l=Object(i.useRef)(new Zt);return Object(i.useEffect)((function(){var e=s.current,t=l.current;if(e&&t){var n=e.transferControlToOffscreen();t.postMessage({canvas:n},[n])}}),[]),Object(i.useEffect)((function(){var e=s.current,n=l.current;e&&n&&function(e,t,n,i,r){Qt.apply(this,arguments)}(n,o,t.playRange.start,t.playRange.end,c)}),[c,t.playRange.end,t.playRange.start,o]),Object(u.jsx)("div",{style:{width:"100%"},children:Object(u.jsx)("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0},children:Object(u.jsx)("canvas",{ref:s,style:{transformOrigin:"left top",transform:"scale(".concat(36/a,")")},width:o*r,height:a})})})},_t=Object(i.memo)(Kt);function $t(){return($t=Object(_.a)(K.a.mark((function e(t,n,i,r,a){var c,o;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.getContext("2d"),(o=new Image).onload=function(){for(var e=0;e<a;)null===c||void 0===c||c.drawImage(o,i*e,0,i,r),e+=1},o.src=n;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var en=function(e){var t=e.clip,n=t.positionInTimeline,r=t.originalWidth,a=t.originalHeight,c=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=c.current;if(e){var n=e.getBoundingClientRect(),i=n.width,o=n.height,s=o*r/a,u=Math.ceil(i/s);!function(e,t,n,i,r){$t.apply(this,arguments)}(e,t.blobUrl,s,o,u)}}),[t.blobUrl,a,r,n.duration]),Object(u.jsx)("div",{style:{width:"100%"},children:Object(u.jsx)("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0},children:Object(u.jsx)("canvas",{ref:c,width:st(n.duration),height:36})})})};function tn(e,t){return new Promise((function(n){e.addEventListener("seeked",(function t(){e.removeEventListener("seeked",t),n(!0)})),e.currentTime=t/1e3}))}function nn(){return(nn=Object(_.a)(K.a.mark((function e(t,n,i,r,a,c,o){var s,u,l,f;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=(o-c)/a,u=t.getContext("2d"),(l=document.createElement("video")).src=n,f=0;case 5:if(!(f<a)){e.next=12;break}return e.next=8,tn(l,c+s*f+1);case 8:null===u||void 0===u||u.drawImage(l,i*f,0,i,r),f+=1,e.next=5;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var rn,an,cn,on,sn,un=function(e){var t=e.clip,n=t.positionInTimeline,r=t.originalWidth,a=t.originalHeight,c=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=c.current;if(e){var n=e.getBoundingClientRect(),i=n.width,o=n.height,s=o*r/a,u=Math.ceil(i/s);!function(e,t,n,i,r,a,c){nn.apply(this,arguments)}(e,t.blobUrl,s,o,u,t.playRange.start,t.playRange.end)}}),[t.blobUrl,t.playRange.end,t.playRange.start,a,r,n.duration]),Object(u.jsx)("div",{style:{width:"100%"},children:Object(u.jsx)("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0},children:Object(u.jsx)("canvas",{ref:c,width:st(n.duration),height:36})})})},ln=S.a.div(rn||(rn=Object(A.a)(["\n  /* background-color: #22a5df; */\n  border-radius: 5px;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  overflow: hidden;\n  display: flex;\n  &.active {\n    box-shadow: 0px 0px 5px 0px rgba(255, 255, 255, .5);\n  }\n"]))),fn=(S.a.div(an||(an=Object(A.a)(["\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  left: 0;\n  top: 0;\n  bottom: 0;\n"]))),S.a.div(cn||(cn=Object(A.a)(["\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n"]))),S.a.div(on||(on=Object(A.a)(["\n  color: #fff;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n  flex-grow: 1;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"])))),hn=S.a.div(sn||(sn=Object(A.a)(["\n  background: rgba(0, 0, 0, 0.5);\n  width: 10px;\n  cursor: ew-resize;\n  flex-shrink: 0;\n  position: relative;\n  z-index: 1;\n"]))),dn={zIndex:999,border:"2px solid #fff"};function pn(e){switch(e.type){case W.VIDEO:return Object(u.jsx)(un,{clip:e});case W.GIF:return Object(u.jsx)(_t,{clip:e});case W.AUDIO:return Object(u.jsx)(qt,{clip:e});case W.IMAGE:return Object(u.jsx)(en,{clip:e});default:return Object(u.jsx)(fn,{children:e.name})}}var vn,bn,gn,jn,mn,xn,On,wn,yn,kn,In,Tn,Cn,Rn,En,An=function(e){var t=e.clip,n=e.onUpdate,r=t.positionInTimeline,a=t.id,c=t.type,l=Object(i.useContext)(Yi),f=l.setHoverTrack,h=l.tracks,d=l.setTracks,p=l.setNewTrackIndex,v=l.newTrackIndex,b=l.activeClipId,g=l.setActiveClipId,j=Object(i.useCallback)((function(e){if(0!==e.stepLeft||0!==e.stepTop){var t=ct(h,a),n=t.trackIndex,i=t.clipIndex;vt(h,a)?(h[n].splice(i+1,1),d(Object(P.a)(h))):bt(h,a)&&(h[n].splice(i-1,1),d(Object(P.a)(h)))}}),[a,d,h]),m=Object(i.useCallback)((function(e){j(e);var t=at(e.belowElement);if(t){var n=nt({x:e.cursorLeft,y:e.cursorTop},t),i=ot(h),r=rt(t);n.y<=12&&i?p(r):n.y>=t.clientHeight-12&&i?p(r+1):p(-1)}f(t)}),[j,f,p,h]),x=Object(i.useCallback)((function(e){if(e.isMoved){var t=at(e.belowElement),i=it({x:e.cursorLeft,y:e.cursorTop}),c=ut(Math.max(0,i.x-(e.cursorLeft-e.left))),u=!1;if(v>-1)u=!0,null===n||void 0===n||n({positionInTimeline:Object(s.a)(Object(s.a)({},r),{},{start:c,end:c+r.duration})},v,0,!0);else if(t){var l=rt(t),d=ct(h,a).trackIndex,b=h[l];if(l===d&&(b=b.filter((function(e){return e.id!==a}))),l>-1&&b){var g=lt(ut(i.x),b);if(g>-1){var j=ft(g,b);if(j.start||j.end){var m=ht([j.start,j.end],[c,c+r.duration]),x=Object(o.a)(m,2),O=x[0],w=x[1];u=!0,null===n||void 0===n||n({positionInTimeline:{start:O,end:w,duration:w-O}},l,g,!1)}}}}if(!u){var y=ct(h,a),k=y.trackIndex,I=y.clipIndex,T=h[k][I-1],C=h[k][I+1];if(T&&T.positionInTimeline.end>r.start||C&&C.positionInTimeline.start<r.end){var R,E,A=ht([(null===T||void 0===T||null===(R=T.positionInTimeline)||void 0===R?void 0:R.end)||0,(null===C||void 0===C||null===(E=C.positionInTimeline)||void 0===E?void 0:E.start)||1e10],[r.start,r.end]);null===n||void 0===n||n({positionInTimeline:{start:A[0],end:A[1],duration:A[1]-A[0]}},k,I,!1)}}}p(-1),f(null)}),[a,v,n,r,f,p,h]),O=Object(i.useCallback)((function(e){var t=r.start+ut(e.stepLeft);if(r.end-t>=500){var i,c,o=ct(h,a),u=o.trackIndex,l=o.clipIndex,f=(null===(i=h[u][l-1])||void 0===i||null===(c=i.positionInTimeline)||void 0===c?void 0:c.end)||0;null===n||void 0===n||n({positionInTimeline:Object(s.a)(Object(s.a)({},r),{},{start:Math.max(t,f),duration:r.end-Math.max(t,f)})},u,l,!1)}}),[a,n,r,h]),w=Object(i.useCallback)((function(e){var t=r.end+ut(e.stepLeft);if(t-r.start>=500){var i,c,o=ct(h,a),u=o.trackIndex,l=o.clipIndex,f=(null===(i=h[u][l+1])||void 0===i||null===(c=i.positionInTimeline)||void 0===c?void 0:c.start)||1e10;null===n||void 0===n||n({positionInTimeline:Object(s.a)(Object(s.a)({},r),{},{end:Math.min(t,f),duration:Math.min(t,f)-r.start})},u,l,!1)}}),[r,h,a,n]),y=Object(i.useCallback)((function(){var e=ct(h,a),t=e.trackIndex,i=e.clipIndex;null===n||void 0===n||n({positionInTimeline:Object(s.a)(Object(s.a)({},r),{},{duration:r.end-r.start})},t,i,!1)}),[a,n,r,h]),k=Object(i.useCallback)((function(e){e.stopPropagation(),g(a||"")}),[a,g]),I=c===W.TRANSITION;return Object(u.jsx)(Y,{scrollContainerSelector:".tracks-wrapper",autoGrow:!0,slow:2,onMove:m,onEnd:x,enable:!I,children:Object(u.jsxs)(ln,{className:"track-element ".concat(b===a?"active":""),onClick:k,style:Object(s.a)({width:st(r.end-r.start),left:st(r.start)},c===W.TRANSITION?dn:null),children:[I||bt(h,a)?null:Object(u.jsx)(hn,{children:Object(u.jsx)(Y,{direction:C.EW,onMove:O,onEnd:y,children:Object(u.jsx)("div",{style:{width:"100%",height:"100%"}})})}),pn(t),I||vt(h,a)?null:Object(u.jsx)(hn,{children:Object(u.jsx)(Y,{direction:C.EW,onMove:w,onEnd:y,children:Object(u.jsx)("div",{style:{width:"100%",height:"100%"}})})})]})})},Sn=Object(i.memo)(An),Fn=S.a.div(vn||(vn=Object(A.a)(["\n  width: 100%;\n  height: 46px;\n  padding: 5px 0px;\n  flex-shrink: 0;\n"]))),Mn=S.a.div(bn||(bn=Object(A.a)(["\n  width: 100%;\n  height: 100%;\n  border: 2px dashed #203351;\n  border-radius: 8px;\n  position: relative;\n  background: #121314;\n"]))),Un=S.a.div(gn||(gn=Object(A.a)(["\n  height: 0;\n  position: relative;\n  pointer-events: none;\n  &::after {\n    content: '';\n    position: absolute;\n    background: rgb(69 211 174);\n    width: 100%;\n    height: 2px;\n    border-radius: 2px;\n    left: 0;\n    right: 0;\n    top: -1px;\n  }\n  &::before {\n    content: '+';\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    width: 20px;\n    height: 20px;\n    border-radius: 10px;\n    background: rgb(69 211 174);\n    transform: translate(-10px, -10px);\n    text-align: center;\n    line-height: 20px;\n    z-index: 1;\n  }\n"]))),Ln=function(e){var t=e.clips,n=e.style,a=e.index,c=Object(i.useContext)(Yi),o=c.hoverTrack,l=c.tracks,f=c.setTracks,h=c.newTrackIndex,d=c.draggingClip,p=rt(o),v=Object(i.useCallback)((function(e,t,n,i,r){var a=ct(l,e.id),c=a.trackIndex,o=a.clipIndex;if(c>-1&&o>-1){var s=l[c].splice(o,1)[0];Object.assign(s,t),r?l.splice(n,0,[s]):l[n].splice(i,0,s),f(Object(P.a)(l))}}),[f,l]),b=ot(l),g=(null===d||void 0===d?void 0:d.type)===W.TRANSITION;return Object(u.jsxs)(u.Fragment,{children:[b&&h===a?Object(u.jsx)(Un,{}):null,Object(u.jsx)(Fn,{style:n,className:_e,children:Object(u.jsx)(Mn,{style:Object(s.a)(Object(s.a)({},t.length?{border:0,background:"#121314"}:null),p===a&&-1===h?{background:"rgb(18 19 20 / 50%)"}:null),children:t.map((function(e,n){var i,a,c=t[n+1],o=!1;return g&&(a=c,(i=e)&&a&&Math.abs(i.positionInTimeline.end-a.positionInTimeline.start)<=1e-5)&&pt(null===e||void 0===e?void 0:e.type)&&pt(null===c||void 0===c?void 0:c.type)&&(o=!0),Object(u.jsxs)(r.a.Fragment,{children:[Object(u.jsx)(Sn,{clip:e,onUpdate:function(t,n,i,r){v(e,t,n,i,r)}}),o&&d?Object(u.jsx)(ln,{className:"transition-insert","data-from":e.id,"data-to":c.id,style:{width:st(d.positionInTimeline.duration),left:st(e.positionInTimeline.end-d.positionInTimeline.duration/2),zIndex:999,opacity:.5,border:"2px solid #fff"}}):null]},e.id)}))})}),b&&h===a+1?Object(u.jsx)(Un,{}):null]})},Dn=S.a.div(jn||(jn=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  padding: 10px 20px;\n  position: relative;\n  overflow-y: auto;\n  overscroll-behavior: unset;\n"]))),Pn=S.a.div(mn||(mn=Object(A.a)(["\n  flex: 1 1 0%;\n  display: flex;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  justify-content: center;\n"]))),Nn=S.a.div(xn||(xn=Object(A.a)(["\n  width: 0;\n  top: 40px;\n  bottom: 4px;\n  position: absolute;\n  /* cursor: move; */\n  z-index: 1000;\n\n  &::before {\n    content: '';\n    width: 2px;\n    background-color: #367CE4;\n    left: -1px;\n    top: -10px;\n    bottom: 0;\n    border-radius: 2px;\n    position: absolute;\n  }\n\n  .indicator-bar {\n    position: absolute;\n    top: -20px;\n    left: -12px;\n  }\n"]))),Vn=function(e){var t=e.onCurrentTimeChange,n=Object(i.useContext)(Yi),r=n.tracks,a=n.currentTime,c=1===r.length&&0===r[0].length?{height:90}:{},o=Object(i.useCallback)((function(e,n,i){var a=dt(r),c=it({x:e,y:n}),o=ut(Math.max(0,c.x-i));t(Math.min(o,a))}),[t,r]),s=Object(i.useCallback)((function(e){o(e.pageX,e.pageY,0)}),[o]);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(Dn,{className:"tracks-wrapper",onClick:s,children:Object(u.jsx)(Pn,{children:r.map((function(e,t){return Object(u.jsx)(Ln,{index:t,clips:e,style:c},t)}))})}),Object(u.jsx)(Nn,{style:{left:st(a)+20},children:Object(u.jsx)(Yt,{className:"indicator-bar"})})]})},Gn=S.a.div(On||(On=Object(A.a)(["\n  display: flex;\n  width: 100%;\n  height: calc(100% - 50px);\n  user-select: none;\n  overflow: hidden;\n"]))),zn=S.a.div(wn||(wn=Object(A.a)(["\n  display: flex;\n  height: 100%;\n  position: relative;\n  z-index: 2000;\n"]))),Hn=S.a.div(yn||(yn=Object(A.a)(["\n  display: flex;\n  flex: 1 1 0%;\n  flex-direction: column;\n  overflow: hidden;\n"]))),Bn=S.a.div(kn||(kn=Object(A.a)(["\n  flex: 1 1 0%;\n  display: grid;\n  grid-template-rows: minmax(200px, 1.1fr) minmax(200px, 0.9fr);\n  overflow: hidden;\n"]))),Wn=S.a.div(In||(In=Object(A.a)(["\n  background-color: #14181D;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n"]))),Yn=S.a.div(Tn||(Tn=Object(A.a)(["\n  overflow-x: auto;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  position: relative;\n"]))),Xn=S.a.div(Cn||(Cn=Object(A.a)(["\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n"]))),Jn=S.a.div(Rn||(Rn=Object(A.a)(["\n  padding: 0 20px;\n  height: 36px;\n  display: flex;\n  overflow: hidden;\n  flex-grow: 0;\n  flex-shrink: 0;\n  background: #1A2028;\n  border-top: 1px solid #14181D;\n  box-shadow: 0px 12px 16px rgba(0, 0, 0, 0.14);\n"]))),qn=S.a.div(En||(En=Object(A.a)(["\n  position: relative;\n  height: 20px;\n  padding: 8px 5px;\n  font-size: 12px;\n  line-height: 12px;\n  color: #7185A6;\n  flex-grow: 0;\n  flex-shrink: 0;\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    height: 20px;\n    background-color: #566C8D;;\n  }\n  &::after {\n    content: '';\n    position: absolute;\n    left: 50%;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    height: 12px;\n    background: #566C8D;\n    opacity: 0.5;\n  }\n"]))),Zn=function(){var e=Object(i.useState)(0),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){var e=document.querySelector(".tracks-wrapper");if(e){r(e.clientWidth);var t=new ResizeObserver((function(){e.clientWidth!==n&&r(e.clientWidth)}));return t.observe(e),function(){t.disconnect()}}}),[n]),Object(u.jsx)(Jn,{style:{width:n},children:Array.from(Array(Math.ceil(n/$e))).map((function(e,t){return Object(u.jsx)(qn,{style:{width:$e},children:V(1e3*t,!1,!1)},t)}))})},Qn=n(202),Kn=function(e,t){!function(e){Object(Qn.a)("Backspace",(function(){gt(e)}))}(e),function(e){Object(Qn.a)("ctrl.c",(function(){jt(e)}))}(e),function(e,t){Object(Qn.a)(" ",(function(){var n=e.isPlaying;t.handleIsPlayingChange(!n)}))}(e,t)},_n=function(){function e(t,n){Object($.a)(this,e),this.scene=void 0,this.camera=void 0,this.renderer=void 0,this.maxAnisotropy=void 0,this.scene=new se.Scene,this.camera=new se.OrthographicCamera(t/-2,t/2,n/2,n/-2,-1e3,1e3),this.renderer=new se.WebGLRenderer({preserveDrawingBuffer:!0,antialias:!0}),this.renderer.setPixelRatio(2),this.renderer.setSize(t,n),this.maxAnisotropy=this.renderer.capabilities.getMaxAnisotropy()}return Object(ee.a)(e,[{key:"add",value:function(e,t){e.name=t,this.scene.add(e)}},{key:"remove",value:function(e){var t=this.scene.getObjectByName(e);t&&this.scene.remove(t)}},{key:"getRealSize",value:function(){var e=new se.Vector2;return this.renderer.getDrawingBufferSize(e),e}},{key:"getDomElement",value:function(){return this.renderer.domElement}},{key:"render",value:function(){var e=this.renderer,t=this.scene,n=this.camera;e.render(t,n)}}]),e}(),$n=function(){function e(t){var n=t.width,i=t.height,r=t.onCurrentTimeChange,a=t.onEnd;Object($.a)(this,e),this.tickTime=0,this.rafId=0,this.tickFunc=void 0,this.onCurrentTimeChangeCallback=void 0,this.onEnd=void 0,this.painter=void 0,this.clips=[],this.currentTime=0,this.duration=0,this.isPlaying=!1,this.width=0,this.height=0,this.width=n,this.height=i,this.painter=new _n(n,i),this.onCurrentTimeChangeCallback=r,this.onEnd=a,this.tickFunc=this.tick.bind(this),this.rafId=requestAnimationFrame(this.tickFunc)}return Object(ee.a)(e,[{key:"tick",value:function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.render(t);case 2:this.rafId=requestAnimationFrame(this.tickFunc);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isInRange",value:function(e){var t=e.config.positionInTimeline,n=t.start,i=t.end;return n<=this.currentTime&&i>=this.currentTime}},{key:"updateDuration",value:function(){var e=this;this.duration=0,this.clips.forEach((function(t){var n=t.config;n.positionInTimeline.end>e.duration&&(e.duration=n.positionInTimeline.end)}))}},{key:"getClipById",value:function(e){return this.clips.find((function(t){return t.config.id===e}))}},{key:"addClip",value:function(){var e=Object(_.a)(K.a.mark((function e(t){var n,i=this;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Be(t,this),e.next=3,n.init();case 3:return this.clips.push(n),e.next=6,this.onCurrentTimeChange();case 6:this.updateDuration(),me(n.config,"positionInTimeline",function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.updatePlaybackRate(),!i.isInRange(n)){e.next=13;break}if(!n.isEntered){e.next=7;break}return e.next=5,n.onUpdate(!0);case 5:e.next=11;break;case 7:return n.isEntered=!0,n.addToPainter(),e.next=11,n.onEnter(!0);case 11:e.next=18;break;case 13:if(!n.isEntered){e.next=18;break}return n.isEntered=!1,n.removeFromPainter(),e.next=18,n.onLeave(!0);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeClip",value:function(){var e=Object(_.a)(K.a.mark((function e(t){var n,i,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getClipById(t))){e.next=7;break}return e.next=4,n.destroy();case 4:n.config.type===W.TRANSITION&&(i=this.getClipById(n.config.fromId),r=this.getClipById(n.config.toId),null===i||void 0===i||i.show(),null===r||void 0===r||r.show()),this.clips.splice(this.clips.indexOf(n),1),this.updateDuration();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(_.a)(K.a.mark((function e(t){var n,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Math.floor(t),!this.isPlaying){e.next=7;break}return this.currentTime+=n-this.tickTime,this.currentTime=Math.min(this.currentTime,this.duration),e.next=6,this.onCurrentTimeChange();case 6:this.currentTime>=this.duration&&(this.pause(),null===(i=this.onEnd)||void 0===i||i.call(this));case 7:this.painter.render(),this.tickTime=n;case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t=this;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isPlaying||(this.isPlaying=!0,this.clips.forEach((function(e){t.isInRange(e)&&e.play()})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=Object(_.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isPlaying&&(this.isPlaying=!1,this.clips.forEach((function(e){e.pause()})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCurrentTime",value:function(){var e=Object(_.a)(K.a.mark((function e(t){var n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentTime=Math.max(0,Math.min(t,this.duration)),e.next=3,this.onCurrentTimeChange(!0);case 3:this.currentTime>=this.duration&&(this.pause(),null===(n=this.onEnd)||void 0===n||n.call(this));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onCurrentTimeChange",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i,r=this,a=arguments;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>0&&void 0!==a[0]&&a[0],i=[],this.clips.forEach((function(e){r.isInRange(e)?e.isEntered?i.push(e.onUpdate(n)):(e.isEntered=!0,e.addToPainter(),i.push(e.onEnter(n))):e.isEntered&&(e.isEntered=!1,e.removeFromPainter(),i.push(e.onLeave(n)))})),e.next=5,Promise.all(i).catch((function(e){alert(e.message)}));case 5:i=[],null===(t=this.onCurrentTimeChangeCallback)||void 0===t||t.call(this,this.currentTime);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"attachTo",value:function(e){null===e||void 0===e||e.appendChild(this.painter.getDomElement())}},{key:"destroy",value:function(){var e=Object(_.a)(K.a.mark((function e(){var t,n,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return cancelAnimationFrame(this.rafId),t=[],this.clips.forEach((function(e){t.push(e.destroy())})),e.next=5,Promise.all(t).catch((function(e){alert(e.message)}));case 5:t=[],this.clips.length=0,this.clips=[],(n=this.painter.getDomElement())&&(null===(i=n.parentNode)||void 0===i||i.removeChild(n));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ei=function(){var e=Object(_.a)(K.a.mark((function e(t,n,i){var r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return r=[],n.forEach((function(e){r.push(null===t||void 0===t?void 0:t.addClip(e))})),i.forEach((function(e){r.push(t.removeClip(e))})),e.next=6,Promise.all(r).catch((function(e){alert(e.message)}));case 6:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),ti=n(200),ni=function(e){var t=e.value,n=e.onChange;return Object(u.jsx)("div",{children:Object(u.jsxs)(ti.a,{value:t,onSelect:n,children:[Object(u.jsx)(ti.a.Option,{value:m.NO_EFFECT,children:"\u65e0"}),Object(u.jsx)(ti.a.Option,{value:m.BLUR,children:"\u9ad8\u65af\u6a21\u7cca"}),Object(u.jsx)(ti.a.Option,{value:m.GRAY,children:"\u7070\u5ea6"})]})})},ii=function(e){var t=e.value,n=e.onChange;return Object(u.jsx)("div",{children:Object(u.jsxs)(ti.a,{value:t,onSelect:n,children:[Object(u.jsx)(ti.a.Option,{value:j.CUSTOM,children:"\u81ea\u5b9a\u4e49"}),Object(u.jsx)(ti.a.Option,{value:j.CONTAIN,children:"contain"}),Object(u.jsx)(ti.a.Option,{value:j.COVER,children:"cover"}),Object(u.jsx)(ti.a.Option,{value:j.FILL,children:"fill"})]})})},ri=function(e){var t=e.data,n=e.onChange,r=Object(i.useCallback)((function(e){n({effect:e})}),[n]),a=Object(i.useCallback)((function(e){n({positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{fitType:e,width:t.originalWidth,height:t.originalHeight})})}),[t.originalHeight,t.originalWidth,t.positionInRender,n]);return Object(u.jsxs)("div",{children:[Object(u.jsx)(ni,{value:t.effect,onChange:r}),Object(u.jsx)(ii,{value:t.positionInRender.fitType,onChange:a})]})},ai=function(e){var t=e.data,n=e.onChange,r=Object(i.useCallback)((function(e){n({effect:e})}),[n]),a=Object(i.useCallback)((function(e){n({positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{fitType:e,width:t.originalWidth,height:t.originalHeight})})}),[t.originalHeight,t.originalWidth,t.positionInRender,n]);return Object(u.jsxs)("div",{children:[Object(u.jsx)(ni,{value:t.effect,onChange:r}),Object(u.jsx)(ii,{value:t.positionInRender.fitType,onChange:a})]})};function ci(e,t){switch(null===e||void 0===e?void 0:e.type){case W.VIDEO:return Object(u.jsx)(ai,{data:e,onChange:t});case W.IMAGE:return Object(u.jsx)(ri,{data:e,onChange:t});default:return null}}var oi=function(){var e=Object(i.useContext)(Yi),t=e.activeClipId,n=e.tracks,r=e.setTracks,a=Object(i.useState)(),c=Object(o.a)(a,2),s=c[0],l=c[1];Object(i.useEffect)((function(){var e,i=ct(n,t),r=i.trackIndex,a=i.clipIndex;l(null===(e=n[r])||void 0===e?void 0:e[a])}),[t,n]);var f=Object(i.useCallback)((function(e){s&&(Object.assign(s,e),r(Object(P.a)(n)))}),[s,r,n]),h=Object(i.useCallback)((function(e){e.stopPropagation()}),[]);return Object(u.jsx)("div",{style:{width:200},onClick:h,children:ci(s,f)})};var si,ui,li=function(e){return Object(u.jsxs)("svg",Object(s.a)(Object(s.a)({width:19,height:27,fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e),{},{children:[Object(u.jsx)("path",{fill:"url(#prefix__pattern0)",d:"M0 0h19v27H0z"}),Object(u.jsxs)("defs",{children:[Object(u.jsx)("pattern",{id:"prefix__pattern0",patternContentUnits:"objectBoundingBox",width:1,height:1,children:Object(u.jsx)("use",{xlinkHref:"#prefix__image0_348:26",transform:"matrix(.01923 0 0 .01351 -.635 -.297)"})}),Object(u.jsx)("image",{id:"prefix__image0_348:26",width:120,height:120,xlinkHref:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAKy0lEQVR4Xu2de3BVxR3H95x78yAJuQEMj5AHDZYiICjtCIqWEcXKIHWww6sUxmY6oLU4yjgFYaBVOtZBnME+bMf6Rwn1gW2TquOMHaA4wnS0vIJIQgfEAHlCSEKAvO5j+/udnGuvQMi99+ye/G7ub2d2bh5nf2f38z2/3T27v3OuEJyYABNgAkyACTABJsAEmAATYAJMgAkwASbABJgAE2ACTIAJMAEmwASYABNgAkyACTABJsAEmAATYAJMgAkwASbABJjAgCdgJHoLpZRmL22Q+HfDMKzPyARlsN2Yw2XxGCtf7/hEZpRQArc9XPQzIeUiAF5o55jYZxbeKczUzJjKfO3gtHQhVv8i28gdcSl+I+6WTBiB275fWAZoiiBPjReRY4HDJzZNYWx5PSHY9da9xctQSzkQ90MwPM+JuEorFgoJubpEyg/+tk6pXQ3GyF+FIO5FaHe2irYr8+DIytx2xzvG8sdw2CCZyHowCLsYMk58lIirjX7FfxbKfbsf0mbfoWGvw/JaioOwW8HwMi3GdRgte+N9MEuyNyTnwSDuboA1A/JQHVrosilfXH9Bl20ndil6cA6ZyVQsZM/Vk7wgSXnwpZLpvwGmcLOZmEnu3fUAtZqTElg21U0EQBOoQYq6PuVv/jPqY106kJTA0OZUl9qdNKehJrAvaci71FBqAg9zqd1JcxpqAg9KGvIuNZSawO0utTtpTkNKYCM370hCk3948bep1Z+UwBkbtz1BDVAs9TFmPnAoluPdOJaUwJ6ib1VDo8+60XDl58gr2KbcpgKDpATG9mS+umemgna5baLGeOa5R90+aTTnIyewJ3/sl57Jd5VGU3kix5wWP/jRZCJ1uaYa5ATGGmZseutRIyvnBFVoEfU6KG67Y6UxY1YL1bqSFBgjG7PeODLezB97kCi4eqjXHnHvnOUQzUFu/TmSGclN6nAFMbw1cGDPwo5NP367J6rVUZIQstMEUZUhsBK+sPEzDXJWFJbxHv0Y5HZhmhKC7u6Noky/H0Ja4AihUwOV++d3rFvwFoTNxlvnGhD4LAiMVwra8NhC42c4ThpPiaLjkmlehDrn4edqkZbeJlZvXGbkjkQPTogULyxXG2cHt2cHu8WY8yfFomPvi7WNVULA77GkmnmbxbM5+QLHS4xr7oQcgDweMi6RnoF8sbFLpJY3yo076sTsE1eE8KUIMWuYqFo1xrj/5gzRahqiE4YQ7AUSIlGM6LgGXP1RMetfL4l3QwGR4YBqpS3sZyCQda8NFw5GYWD33Lj2uHxxe614EH5us4Vvhs+hrX7RWdYgUsoaJIYShfLTxV74fMxBPVwtSl7gt38iv9j1a1EAVMCXHCXsrZrQS21xMYje+LhZ5PzwsNwJ/TZ2u42Q8yFjtx1OGGFys/1LQ02n8OXtCr03cbBYt3Oa+bmjGrlQmOQsGtvdeUl6SpfItu4roliBuGgSn1nBiZIfPDcXPlufPS7XLzksfwfiNsDvoyGj6JHiXi3BSPjDYsg5xy6Jp0fvCj3vgkaOTkFW4HdWCOwiBztq3dcL4zhbgwJDblpdKTeX1orZ8DOOp/isUyy92T1w/Gy4MMaBN7+isI7KTZEUePtSid2o6uC79iEFxnkYfwP/bhHDd9QLDJDDbhu9Np6Ew8ZcyMVT94Y2xWPAjTLkBP74FblFhqxZrtMx92p+X+01Lzgk99sei57rJOEEbVxDl7jLiRGdZckJXP2JWAANxtmy6ls4a6XktdOh5TbQEYrAjsOLBcZjvFcml0gJfGC7nA+E0HuHKCYFd7Q9EZu/PCH+AB84kVLZQ0yxJ2qKq+3cHCmBT+wRaxSDDxPCiZSn5azE8RZ7B5xFq0xWNOjCQ6G/qDSqwlYsM0cV57uhDX+HNZvN0XAivEUKvtsgH7dtq/TecHV9+5rFdA11d2SSlAfbXafq2TMCwnZ6yhu1PrGIF2bQkRoaCpPyYGhfbKvLsQGZdKYDxnYdl09PPXRMDGNr4XWOpubBuAihK9XepPfBGNy8UD3zd8yCmsDYIMcbv71QGfJgrvjEMbHeDXSwwH3QNb3WWIkbAjpSXkmBgTtButLlgnRrs4JUIuXBoyYJfBWCtdujIWH3qauTxqHF8+ndJr6ZgFQiJfB9a4xVdheNG/E6Uubc4TrMWr2OHssOq0tKYGzLIJ/lZbreJOd9dZKx1CGzq4t3wR+CPy8WKxTbVWKOnMCP/Fbg2i7eT+oIiynyGqJ1zVjxVyX0eiaETemmaHuq2CQZy01OYE+K4Z/zvPgugNNRN9z96XxyjLFyVJq1+e/kvhsvwjrI7admmfjqCZJJB0THDc39plF19yqx0LGhaw3gRAvC9UT6wXvMzKEpVgAeihRr4DpeHJa4dfeb2OOQTSQFRlrfuFN8MH+r8rVdHN/xlcH1ELbj+3ymOXLRKFGOQkGutYW+0X043uuehlwD3XIXdXGRI7mVl0hXABGKYJSbtr9U7Diu4PkBCJs9DGGzc0Bg634V7ONSLfxq+It2h875pRVKi2M/ZoyNDi/lorA48cPZfdZrtxpTHxphJERsNGmBbRF+Cp/rIQ9tOS3S9/4e3A3eKRcAKWSMa14g8HsgcAkI2utb6V4+FVrxZq14vNkvvF0hkeoxhD/bK7rHZYrq8u+Yj5Dti3upWCIIjFBLLge7h62t2zl924UKcK8YlbUbf2D8ytJb0nOfAIEvJ5pQ8daX2m7SV+2wu09fUIYqio9tndsUUPL6jqNwAicz53g591s5kpMsEBdDajx/vnD4qewjL3yhSFyEjDPf+Ny/3yRydmJyHmx/YYZnWfXfPy1rrZrirHnXlMbHUpIqUfRgc3Pjvg0axEVhcSasY4WM7EVDSmDsmluDnb7n6j96RhMxfIKQBdYENxqzsvDoy3gLo0WECYOGfznQvhepL6hkxmD03m4ZTA0KidNlHVGPfbEYkP+n1EWb047/CcXF1SIdAifdBAuvWEoCh052WQtMN3p804mX6Qzoc1IvrWUpCQzPnFm3qE6e4r8RLBZY66XUt3HdCxBaJm59N6t/j6DkwbrXxWVlxzkH30zZv0LFe/akEniQmYLvxEqqRFFgHV0pzsyDN3kzkmYXKXwVUxLYk+u15ldKto2uclPcsPcO9qQl1U4Stdsk86XR38PQUx3f23BxdvbYfyRV32w3VvfEJmqm9v6vN7PiV+htuCih6ltH0dbF9ts3FOJOVbItVZLpovHtNyCE/GPhvKdtcVXcNqHN8xPSc61XEyebuFabo3YxFw60N/pTRh/d0gG7SjghwtsaJ3U8BeWzwHtVvXDFBQpqT+EEntqa2NZAZFyHlhDJ4YdwnXi7avT+altcks8MaYF3HaPkBMY62uOxzDnyQsAvQ/jsD946RTv5wjfqNEHDMq/cvkH1y1bc0kXZeciMwZEtssdjs3XKupQlQ2790BYXvRnjlntL+D/02itwuxVgcXswkfTgsILhwHT4PTDjv68HKzoawvXF8RmfDQpPxPBC9RSl+s5UTXwycb+eVpnf/t8QaYEjhA6/lT2IM+Gylsr7TnY13xKU0ixM9X22dNjkjzSwGRAmE0LgSNL229/RY9F7LQ9OpDewD4irhhvBBJgAE2ACTIAJMAEmwASYABNgAkyACTABJsAEmAATYAJMgAkwASbABJgAE2ACTIAJMAEmwASYABNgAkxgIBL4HwOVtfNqeFzIAAAAAElFTkSuQmCC"})]})]}))},fi=S.a.div(si||(si=Object(A.a)(["\n  width: 100%;\n  height: 50px;\n  user-select: none;\n  overflow: hidden;\n  background: #1A2028;\n  position: relative;\n  z-index: 10000;\n  display: flex;\n  align-items: center;\n  padding-left: 20px;\n"]))),hi=S.a.div(ui||(ui=Object(A.a)(["\n  position: absolute;\n  height: 28px;\n  right: 20px;\n  padding: 0 20px;\n  background: #38AA26;\n  border-radius: 99px;\n  text-align: center;\n  line-height: 28px;\n  cursor: pointer;\n  font-size: 12px;\n"]))),di=function(e){var t=e.player,n=Object(i.useCallback)((function(){t&&function(e){Qe.apply(this,arguments)}(t)}),[t]);return Object(u.jsxs)(fi,{children:[Object(u.jsx)(li,{}),Object(u.jsx)(hi,{onClick:n,children:"\u5bfc\u51fa\u89c6\u9891"})]})};var pi=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({width:12,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:Object(u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 0H0v12h3V0zm9 0L5 6l7 6V0z",fill:"#7B9FD6"})}))};var vi=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:14,height:12,fill:"none"},e),{},{children:Object(u.jsx)("path",{d:"M12.898.317a.667.667 0 01-.212.918l-4.42 2.762 2.677 1.672h.035a3.167 3.167 0 11-1.803.466L7.009 4.783 4.834 6.14a3.167 3.167 0 11-1.759-.474l2.676-1.67-4.419-2.762a.667.667 0 01-.25-.85L1.12.317a.667.667 0 01.919-.212l4.97 3.106 4.97-3.106a.667.667 0 01.919.212zM3.167 7a1.833 1.833 0 100 3.667 1.833 1.833 0 000-3.667zm7.666 0a1.833 1.833 0 100 3.667 1.833 1.833 0 000-3.667z",fill:"#7185A6"})}))};var bi=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),{},{children:Object(u.jsx)("path",{d:"M12.667 2.467a.667.667 0 010 1.333h-.69l-.281 8.509a1.407 1.407 0 01-1.304 1.354l-.102.004H3.704a1.407 1.407 0 01-1.407-1.36L2.021 3.8h-.688a.667.667 0 110-1.332h11.334zm-2.024 1.332H3.357l.273 8.463c.001.03.02.055.046.066l.028.005h6.586c.04 0 .072-.031.073-.071l.28-8.463zM7 5.333A.667.667 0 017.667 6v4a.667.667 0 01-1.334 0V6A.667.667 0 017 5.333zm2.667-5a.667.667 0 110 1.334H4.333a.667.667 0 110-1.334h5.334z",fill:"#7185A6"})}))};var gi=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({width:12,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:Object(u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 12l7-6-7-6v12zm9 0h3V0H9v12z",fill:"#7B9FD6"})}))};var ji=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:10,height:12,fill:"none"},e),{},{children:Object(u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 0H0v12h3V0zm7 0H7v12h3V0z",fill:"#7B9FD6"})}))};var mi=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({width:10,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:Object(u.jsx)("path",{d:"M10 6L0 12V0l10 6z",fill:"#7B9FD6"})}))};var xi=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:14,height:13,fill:"none"},e),{},{children:Object(u.jsx)("path",{d:"M9.18.877a.667.667 0 01.943-.03l3.333 3.13.056.06a.667.667 0 01-.055.912l-3.333 3.143-.065.053a.667.667 0 01-.878-.081l-.053-.065a.667.667 0 01.08-.878l2.255-2.124H4.827a3.163 3.163 0 00-3.16 3.166 3.164 3.164 0 003.015 3.164l.145.004h7.84a.667.667 0 01.078 1.328l-.079.005h-7.84a4.497 4.497 0 01-4.493-4.5A4.497 4.497 0 014.67 3.667l.158-.003h6.345L9.21 1.818l-.057-.061a.667.667 0 01.027-.88z",fill:"#7185A6"})}))};var Oi,wi,yi,ki,Ii,Ti,Ci,Ri,Ei=function(e){return Object(u.jsx)("svg",Object(s.a)(Object(s.a)({xmlns:"http://www.w3.org/2000/svg",width:14,height:13,fill:"none"},e),{},{children:Object(u.jsx)("path",{d:"M4.82.877a.667.667 0 00-.943-.03L.544 3.977l-.056.06a.667.667 0 00.055.912l3.333 3.143.065.053a.667.667 0 00.878-.081l.053-.065a.667.667 0 00-.08-.878L2.536 4.997h6.636a3.163 3.163 0 013.16 3.166 3.164 3.164 0 01-3.015 3.164l-.145.004h-7.84a.667.667 0 00-.078 1.328l.078.005h7.84a4.497 4.497 0 004.494-4.5A4.496 4.496 0 009.33 3.667l-.158-.003H2.827L4.79 1.818l.057-.061a.667.667 0 00-.027-.88z",fill:"#7185A6"})}))},Ai=S.a.div(Oi||(Oi=Object(A.a)(["\n  height: 50px;\n  background: #1A2028;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  flex-shrink: 0;\n  padding: 0 24px;\n"]))),Si=S.a.div(wi||(wi=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 40%;\n  min-width: 700px;\n"]))),Fi=S.a.div(yi||(yi=Object(A.a)(["\n  width: 150px;\n  display: flex;\n  justify-content: space-between;\n"]))),Mi=S.a.div(ki||(ki=Object(A.a)(["\n  font-family: monospace;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 18px;\n  line-height: 21px;\n  color: #7185A6;\n"]))),Ui=S.a.div(Ii||(Ii=Object(A.a)(["\n  display: flex;\n"]))),Li=S.a.div(Ti||(Ti=Object(A.a)(["\n  display: flex;\n  width: 170px;\n  justify-content: space-between;\n"]))),Di=S.a.div(Ci||(Ci=Object(A.a)(["\n  width: 200px;\n  flex-shrink: 0;\n"]))),Pi=function(e){var t=e.playerContext,n=Object(i.useContext)(Yi),r=n.isPlaying,a=n.totalDuration,c=n.currentTime,o=Object(i.useCallback)((function(){t.handleIsPlayingChange(!r)}),[t,r]),s=Object(i.useCallback)((function(){gt(n)}),[n]),l=Object(i.useCallback)((function(){jt(n)}),[n]),f=Object(i.useCallback)((function(){t.handleCurrentTimeChange(0)}),[t]),h=Object(i.useCallback)((function(){t.handleCurrentTimeChange(a)}),[t,a]);return Object(u.jsxs)(Ai,{children:[Object(u.jsxs)(Li,{children:[Object(u.jsx)(F,{children:Object(u.jsx)(Ei,{})}),Object(u.jsx)(F,{children:Object(u.jsx)(xi,{})}),Object(u.jsx)(F,{onClick:l,children:Object(u.jsx)(vi,{})}),Object(u.jsx)(F,{onClick:s,children:Object(u.jsx)(bi,{})})]}),Object(u.jsxs)(Si,{children:[Object(u.jsxs)(Fi,{children:[Object(u.jsx)(F,{onClick:f,children:Object(u.jsx)(pi,{})}),Object(u.jsx)(F,{style:{width:60},onClick:o,children:r?Object(u.jsx)(ji,{}):Object(u.jsx)(mi,{})}),Object(u.jsx)(F,{onClick:h,children:Object(u.jsx)(gi,{})})]}),Object(u.jsxs)(Mi,{children:[Object(u.jsx)("span",{style:{color:"#367CE4"},children:V(c,!0)})," / ",V(a,!0)]}),Object(u.jsxs)(Ui,{children:[Object(u.jsx)(M,{style:{marginRight:16},children:"16:9"}),Object(u.jsx)(M,{children:"9:16"})]})]}),Object(u.jsx)(Di,{})]})},Ni=n(109),Vi=n(106),Gi=n.n(Vi),zi=function(e){var t=e.clip,n=t.positionInRender,r=n.width,a=n.height,c=Object(i.useRef)(t.value),o=Object(i.useRef)(null),l=Object(i.useCallback)((function(e){c.current=e.target.value,Object.assign(t,{value:c.current});var n=B(t);Object.assign(t,{positionInRender:Object(s.a)(Object(s.a)({},t.positionInRender),{},{width:n.width,height:n.height})})}),[t]),f=Object(i.useCallback)((function(){console.log(c.current)}),[]);return Object(u.jsx)("div",{style:{width:r,height:a,overflow:"hidden"},children:Object(u.jsx)(Gi.a,{innerRef:o,html:c.current,disabled:!1,onChange:l,onBlur:f})})},Hi=S.a.div(Ri||(Ri=Object(A.a)(["\n  position: fixed;\n"]))),Bi=["nw","ne","sw","se"],Wi=function(){var e=Object(i.useContext)(Yi),t=e.activeClipId,n=e.tracks,a=Object(i.useState)(null),c=Object(o.a)(a,2),l=c[0],f=c[1],h=Object(i.useState)({}),d=Object(o.a)(h,2),p=d[0],v=d[1],b=r.a.useState({translate:[0,0]}),g=Object(o.a)(b,1)[0],m=Object(i.useMemo)((function(){var e=ct(n,t),i=e.trackIndex,r=e.clipIndex;if(i>-1&&r>-1)return n[i][r]}),[t,n]);Object(i.useEffect)((function(){if(m){var e=mt(),t=e.left,n=e.top,i=e.height,r=e.width,a=Ke(m,r,i),c=a.width,o=a.height,s=a.left,u=a.bottom;v({width:c,height:o,left:t+s,top:n+i-u-o,transform:"rotate(".concat(m.positionInRender.rotate,"deg)")}),f(document.querySelector(".resize-rotate"))}else f(null)}),[m]);var x=Object(i.useCallback)((function(e){(0,e.set)(g.translate)}),[g.translate]),O=Object(i.useCallback)((function(e){var t=e.target,n=e.delta,i=e.beforeTranslate;g.translate=i,t.style.transform="translate(".concat(i[0],"px, ").concat(i[1],"px)"),m&&Object.assign(m,{positionInRender:Object(s.a)(Object(s.a)({},m.positionInRender),{},{fitType:j.CUSTOM,left:m.positionInRender.left+n[0],bottom:m.positionInRender.bottom-n[1]})})}),[m,g]),w=Object(i.useCallback)((function(e){var t=e.setOrigin,n=e.dragStart;t(["%","%"]),n&&n.set(g.translate)}),[g.translate]),y=Object(i.useCallback)((function(e){var t=e.target,n=e.width,i=e.height,r=e.delta,a=e.drag,c=e.direction,o=1===c[1],u=-1===c[0],l=a.beforeTranslate;g.translate=l,m&&Object.assign(m,{positionInRender:Object(s.a)(Object(s.a)(Object(s.a)({},m.positionInRender),{},{fitType:j.CUSTOM,width:n,height:i},u?{left:m.positionInRender.left-r[0]}:null),o?{bottom:m.positionInRender.bottom-r[1]}:null)}),r[0]&&(t.style.width="".concat(n,"px")),r[1]&&(t.style.height="".concat(i,"px")),t.style.transform="translate(".concat(l[0],"px, ").concat(l[1],"px)")}),[m,g]);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(Hi,{className:"resize-rotate",style:p,children:m&&m.type===W.TEXT?Object(u.jsx)(zi,{clip:m}):null}),Object(u.jsx)(Ni.a,{target:l,container:null,origin:!1,renderDirections:Bi,edge:!1,draggable:!0,throttleDrag:0,onDragStart:x,onDrag:O,keepRatio:!0,resizable:!0,throttleResize:0,onResizeStart:w,onResize:y})]})},Yi=r.a.createContext(et),Xi=function(){var e=Object(i.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)([[]]),c=Object(o.a)(a,2),s=c[0],l=c[1],f=Object(i.useState)(-1),h=Object(o.a)(f,2),d=h[0],p=h[1],v=Object(i.useState)(0),b=Object(o.a)(v,2),g=b[0],j=b[1],m=Object(i.useState)(""),x=Object(o.a)(m,2),O=x[0],w=x[1],y=Object(i.useState)(0),k=Object(o.a)(y,2),I=k[0],T=k[1],C=Object(i.useState)(!1),R=Object(o.a)(C,2),E=R[0],A=R[1],S=Object(i.useState)(),F=Object(o.a)(S,2),M=F[0],U=F[1],L=Object(i.useRef)(null),D=Object(i.useCallback)((function(e){var t=e.filter((function(e){return e.length})),n=dt(t);n!==g&&(j(n),I>n&&T(n)),t.flat(1).forEach((function(e,t){e.zIndex=t})),l(t.length?t:[[]])}),[I,T,g]);Object(i.useEffect)((function(){if(g){var e=document.querySelector(".tracks-wrapper");if(e){var t=e.clientWidth,n=st(g);t<n&&(e.style.width="".concat(n+100,"px"))}}}),[g]);var P={hoverTrack:n,setHoverTrack:r,tracks:s,setTracks:D,newTrackIndex:d,setNewTrackIndex:p,activeClipId:O,setActiveClipId:w,currentTime:I,setCurrentTime:T,totalDuration:g,setTotalDuration:j,isPlaying:E,setIsPlaying:A,draggingClip:M,setDraggingClip:U},N=function(e,t){var n=Object(i.useRef)(),r=e.tracks,a=e.totalDuration,c=e.setCurrentTime,o=e.isPlaying,s=e.setIsPlaying;Object(i.useEffect)((function(){!n.current&&t.current&&(n.current=new $n({width:768,height:432,onCurrentTimeChange:function(e){c(e)},onEnd:function(){s(!1)}}),n.current.attachTo(t.current))}),[t,c,s,r]),Object(i.useEffect)((function(){if(n.current&&r.length){var e=function(e,t){var n=[],i=[],r=t.flat(1);return e.forEach((function(e){!r.find((function(t){return t.id===e.config.id}))&&e.config.id&&i.push(e.config.id)})),r.forEach((function(t){e.find((function(e){return e.config.id===t.id}))||n.push(t)})),{newClips:n,deleteClips:i}}(n.current.clips,r),t=e.newClips,i=e.deleteClips;ei(n.current,t,i)}}),[r]);var u=Object(i.useCallback)(function(){var e=Object(_.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.current){e.next=10;break}if(t){e.next=7;break}return e.next=4,n.current.pause();case 4:s(!1),e.next=10;break;case 7:return e.next=9,n.current.play();case 9:s(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[s]),l=Object(i.useCallback)(function(){var e=Object(_.a)(K.a.mark((function e(t){var i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=n.current)){e.next=7;break}return i.pause(),e.next=5,i.setCurrentTime(t);case 5:s(!1),c(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[c,s]);return Object(i.useEffect)((function(){n.current&&a>=0&&n.current.updateDuration()}),[a]),{player:n.current,isPlaying:o,setIsPlaying:s,handleIsPlayingChange:u,handleCurrentTimeChange:l}}(P,L);Kn(P,N);var V=Object(i.useCallback)((function(){O&&w("")}),[O]);return Object(i.useEffect)((function(){return document.removeEventListener("click",V,!1),document.addEventListener("click",V,!1),function(){document.removeEventListener("click",V,!1)}}),[V]),Object(u.jsxs)(Yi.Provider,{value:P,children:[Object(u.jsx)(di,{player:N.player}),Object(u.jsx)(Wi,{}),Object(u.jsxs)(Gn,{children:[Object(u.jsx)(zn,{children:Object(u.jsx)(Wt,{})}),Object(u.jsx)(Hn,{children:Object(u.jsxs)(Bn,{children:[Object(u.jsxs)(Xn,{children:[Object(u.jsx)("div",{className:"player-container",ref:L,style:{width:768,height:432}}),Object(u.jsx)(oi,{})]}),Object(u.jsxs)(Wn,{children:[Object(u.jsx)(Pi,{playerContext:N}),Object(u.jsxs)(Yn,{children:[Object(u.jsx)(Zn,{}),Object(u.jsx)(Vn,{onCurrentTimeChange:N.handleCurrentTimeChange})]})]})]})})]})]})};n(196);c.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(Xi,{})}),document.getElementById("root"))},8:function(e,t){e.exports=THREE},95:function(e,t){e.exports=FFmpeg}},[[197,1,2]]]);
//# sourceMappingURL=main.aa413bd1.chunk.js.map