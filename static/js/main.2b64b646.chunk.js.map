{"version":3,"sources":["../external \"FFmpeg\"","../external \"THREE\"","icons/MenuMedia.tsx","icons/MenuMine.tsx","icons/MenuText.tsx","icons/MenuTransition.tsx","common/types/asset.ts","asset/audios.ts","common/types/player.ts","asset/transitions.ts","common/configs/index.tsx","asset/index.ts","asset/videos.ts","asset/images.ts","asset/gifs.ts","asset/texts.ts","asset/lotties.ts","asset/pag.ts","asset/gltf.ts","common/styleds/index.tsx","common/utils/index.ts","common/components/Draggable/config.ts","common/components/Draggable/index.tsx","common/types/clip.ts","common/utils/watch.ts","player/painter/shader.ts","player/effects/index.ts","player/effects/noEffect.ts","player/effects/gray.ts","player/effects/gaussianBlur.ts","player/effects/triangleBlur.ts","player/clips/base.ts","player/clips/audio.ts","player/clips/image.ts","player/clips/lottie.ts","player/clips/svg.ts","player/clips/text.ts","player/transitions/index.ts","player/transitions/morph.ts","player/transitions/dreamy.ts","player/transitions/fade.ts","player/transitions/hexagonalize.ts","player/transitions/glitchMemories.ts","player/transitions/perlin.ts","player/transitions/crossZoom.ts","player/clips/transition.ts","player/clips/video.ts","common/libs/queue.ts","ffmpeg/util.ts","ffmpeg/index.ts","player/clips/gif.ts","player/clips/pag.ts","player/painter/modelHelper.ts","player/clips/gltf.ts","player/util.ts","editor/config.ts","editor/util.ts","editor/components/AssetCard/components/AudioCard/index.tsx","editor/components/AssetCard/components/GifCard/index.tsx","editor/components/AssetCard/components/GLTFCard/index.tsx","common/configs/clip.ts","editor/components/AssetCard/components/ImageCard/index.tsx","editor/components/AssetCard/components/LottieCard/index.tsx","editor/components/AssetCard/components/PagCard/index.tsx","editor/components/AssetCard/components/TextCard/index.tsx","editor/components/AssetCard/components/TransitionCard/index.tsx","editor/components/AssetCard/components/VideoCard/index.tsx","editor/components/AssetCard/styled.tsx","editor/components/AssetCard/index.tsx","editor/components/AssetMenu/components/MediaPanel/index.tsx","editor/components/AssetMenu/components/MenuItem/index.tsx","editor/components/AssetMenu/components/MenuItem/styled.tsx","editor/components/AssetMenu/components/MinePanel/index.tsx","editor/components/AssetMenu/components/TextPanel/index.tsx","editor/components/AssetMenu/components/TransitionPanel/index.tsx","editor/components/AssetMenu/styled.tsx","editor/components/AssetMenu/index.tsx","icons/IndicatorBar.tsx","editor/components/Tracks/components/Track/styled.tsx","editor/components/Tracks/components/Track/index.tsx","editor/components/Tracks/components/TrackElement/components/AudioTrack/styled.tsx","editor/components/Tracks/components/TrackElement/components/AudioTrack/index.tsx","workers/gifToCanvas.worker.ts","editor/components/Tracks/components/TrackElement/components/GifTrack/index.tsx","editor/components/Tracks/components/TrackElement/components/ImageTrack/index.tsx","editor/components/Tracks/components/TrackElement/components/VideoTrack/index.tsx","editor/components/Tracks/components/TrackElement/components/TextTrack/index.tsx","editor/components/Tracks/components/TrackElement/styled.tsx","editor/components/Tracks/components/TrackElement/index.tsx","editor/components/Tracks/styled.tsx","editor/components/Tracks/index.tsx","editor/styled.tsx","editor/components/Ruler/styled.tsx","editor/components/Ruler/index.tsx","editor/hooks/keyboard.ts","player/painter/index.ts","player/index.ts","editor/hooks/player.ts","icons/Logo.tsx","editor/components/Header/styled.tsx","editor/components/Header/index.tsx","icons/Cut.tsx","icons/Delete.tsx","icons/Redo.tsx","icons/Undo.tsx","editor/components/ToolBar/styled.tsx","editor/components/ToolBar/index.tsx","editor/components/ResizeRotate/styled.tsx","editor/components/ResizeRotate/index.tsx","common/components/FlatSelector/index.tsx","common/components/RatioSelector/index.tsx","icons/BackForward.tsx","icons/FastForward.tsx","icons/pauseButton.tsx","icons/PlayButton.tsx","editor/components/PlayerControls/styled.tsx","editor/components/PlayerControls/index.tsx","icons/ExportVideo.tsx","icons/IconEffect.tsx","common/components/EffectSelector/index.tsx","icons/IconFitType.tsx","common/components/FitSelector/index.tsx","editor/components/ConfigPanel/components/ImagePanel/index.tsx","editor/components/ConfigPanel/components/VideoPanel/index.tsx","common/components/TextEditor/index.tsx","editor/components/ConfigPanel/components/TextPanel/index.tsx","editor/components/ConfigPanel/index.tsx","editor/components/StageHeader/styled.tsx","editor/components/StageHeader/index.tsx","editor/index.tsx","index.tsx"],"names":["module","exports","FFmpeg","THREE","MenuMedia","props","xmlns","width","height","fill","rx","id","fillRule","clipRule","d","mask","x1","y1","x2","y2","gradientUnits","stopColor","offset","stopOpacity","MenuMine","cx","cy","ry","stroke","strokeWidth","MenuText","MenuTransition","AssetType","opacity","FitType","EffectType","TransitionType","OverlayType","Ratio","TRANSITIONS","name","transition","DREAMY","FADE","MORPH","HEXAGONALIZE","GLITCH_MEMORIES","PERLIN","CROSS_ZOOM","ASSET","videos","url","map","video","type","VIDEO","images","image","IMAGE","audios","audio","AUDIO","transitions","TRANSITION","gifs","gif","GIF","texts","value","text","TEXT","lotties","lottie","LOTTIE","pags","pag","PAG","gltfs","gltf","GLTF","Radius10Button","styled","div","Radius99Button","MenuItemContainer","SubMenuContainer","SubMenuButton","SelectorButton","AssetWhole","AssetCardContainer","StyledAssetCard","ConfigPanelIconContainer","promise","pagWasm","MoveDirection","setStyles","el","styles","Object","keys","forEach","key","style","setProperty","replace","toLowerCase","formatMillisecond","ms","showMS","showHour","result","msRemainder","String","padStart","seconds","secondRemainder","minutes","minuteRemainder","hours","svgToCanvas","svg","canvas","canvasContext","Promise","resolve","reject","Image","onload","clearRect","drawImage","onerror","error","src","btoa","unescape","encodeURIComponent","trim","sleep","window","setTimeout","downloadFile","fileURL","fileName","saveLink","document","createElement","href","target","download","navigator","userAgent","match","search","location","event","MouseEvent","view","bubbles","cancelable","dispatchEvent","URL","webkitURL","revokeObjectURL","getTextClipCssText","clip","fontColor","fontSize","fontFamily","join","getTextClipSize","container","querySelector","setAttribute","body","appendChild","innerText","cssText","bound","getBoundingClientRect","Math","ceil","loadLottie","animationData","lottieInstance","loadAnimation","loop","autoplay","renderer","isLoaded","addEventListener","getLottieInfo","a","w","h","duration","round","getDuration","destroy","removeChild","ClipType","Draggable","children","direction","ALL","scrollContainerSelector","autoGrow","enable","attachData","slow","onStart","onMove","onEnd","childRef","useRef","shiftX","shiftY","timer","originalStyle","originalLeft","originalTop","preLeft","preTop","isEnd","count","isMoved","isHoverScrollContainer","useState","dragInfo","setDragInfo","useEffect","current","undefined","move","useCallback","pageX","pageY","transformStyle","EW","NS","transform","handleHold","step","wrapper","scrollContainer","setInterval","wrapperRect","scrollLeft","clientWidth","handleScroll","below","clearInterval","scrollThreshold","closest","parentElement","right","min","left","handleMouseMove","e","hidden","elementFromPoint","clientX","clientY","currentLeft","currentTop","stepLeft","stepTop","element","belowElement","top","cursorLeft","cursorTop","handleMouseUp","classList","remove","removeEventListener","handleMouseDown","stopPropagation","metaKey","ctrlKey","altKey","shiftKey","buttons","which","button","isLeftButton","getAttribute","add","React","cloneElement","ref","watchList","Map","watch","watchObj","callback","has","set","Set","get","currentVal","defineProperty","newVal","oldVal","item","Shader","glsl","effect","effectMap","NO_EFFECT","texture","GRAY","config","originalWidth","originalHeight","tex","painter","buffer","depthBuffer","stencilBuffer","minFilter","magFilter","camera","plane","material","uniforms","vertexShader","GetVertex","fragmentShader","mesh","scene","render","GAUSSIAN_BLUR","writeBuffer","readBuffer","iResolution","iChannel0","i","radius","uniformsNeedUpdate","tempBuffer","TRIANGLE_BLUR","delta","ClipBase","player","isAttachToPainter","isEntered","geometry","sprite","renderTarget","renderTargetCamera","renderTargetScene","this","playerWidth","playerHeight","createCamera","geometryInfo","size","setSize","effectTex","vertices","Float32Array","center","rotation","z","rotate","PI","position","x","y","updateRotate","updatePosition","updateTexture","val","visible","playRange","end","start","clear","clone","isManual","dispose","delete","removeFromPainter","Audio","context","AudioContext","audioBuffer","source","playbackRate","isPlaying","getAudioBuffer","updatePlaybackRate","alert","decodeAudioData","slice","createBufferSource","currentTime","timelineInfo","connect","destination","stop","originalDuration","play","pause","initRender","load","blobUrl","createTexture","GetFragment","transparent","zIndex","Lottie","initLottie","goToAndStop","needsUpdate","Svg","initCanvas","getRealSize","getContext","func","Text","initTexture","watchChange","updateCanvas","transitionMap","freeze","strength","fragment","steps","horizontalHexagons","ratio","scale","smoothness","seed","Transition","fromClip","toClip","updateFromClipTexture","updateToClipTexture","renderToTexture","from","to","fromId","toId","getClipById","transitionUniforms","transitionFragment","progress","GetTransitionFragment","hide","onUpdate","show","Video","setCurrentTime","abs","newCurrentTime","correctVideoCurrentTime","AsyncAutoQueue","items","pendingPromise","action","push","dequeue","then","catch","Error","finally","shift","payload","extractDuration","field","split","extractVideoInfo","infoItems","resolution","codec","colorSpace","parseInt","fps","extractAudioInfo","Hz","getAudioTempoChain","tempo","toFixed","FFmpegHelperClass","FFmpegHelper","ffmpeg","run","inputFileName","v4","outputFileName","FS","Uint8Array","mediaInfo","setLogger","message","includes","inputs","index","flat","filters","delay","amixPrefix","length","frames","padNum","toString","videoBuffer","videoFileName","audioFileName","finalVideo","createFFmpeg","log","asyncQueue","Proxy","prop","args","enqueue","Load","apply","Gif","textureData","data","Uint8ClampedArray","flipY","sumFrameDelay","frame","getFrame","Pag","pagView","initPagView","PAGView","init","pagFile","setProgress","ModelHelper","modelData","actions","mixer","frameBuffer","playing","initScene","initAnimationMixer","update","hemisphereLight","dirLight","castShadow","shadow","bottom","near","far","model","traverse","object","isObject3D","receiveShadow","skeleton","animations","defaultAction","clipAction","setActions","activate","reduce","previousValue","currentValue","getClip","paused","setTime","modelMaterial","modelHelper","getTexture","createClip","SVG","canvasToArrayBuffer","toBlob","blob","arrayBuffer","snap","interval","getDomElement","imageData","generateVideo","ImagesToVideo","getAudioMergeItemFromPlayer","clips","getOriginalDuration","generateAudio","audioMergeItems","MergeAudios","ArrayBuffer","MergeVideoAudio","finalVideoBuffer","createObjectURL","Blob","getClipRenderInfo","fitType","currentWidth","currentHeight","texWidth","texHeight","CONTAIN","COVER","FILL","TRACK_WRAPPER_CLASS_NAME","SECOND_WIDTH","INIT_EDITOR_CONTEXT","hoverTrack","setHoverTrack","tracks","setTracks","newTrackIndex","setNewTrackIndex","activeClip","setActiveClip","totalDuration","setTotalDuration","setIsPlaying","RATIO_16_9","setRatio","setDraggingClip","INIT_PLAYER_CONTEXT","handleIsPlayingChange","handleCurrentTimeChange","trackWrapperSelector","cursorPositionToTracksWrapperPosition","cursorPosition","tracksWrapper","rect","paddingLeft","getComputedStyle","max","getTrackIndex","track","Array","prototype","call","querySelectorAll","indexOf","getTrackInfoForDrag","belowEl","trackList","isTop","trackElement","isBottom","isNew","getTrackAndClipIndex","j","trackIndex","clipIndex","needShowPrepareTrack","millisecondsToWidth","milliseconds","widthToMilliseconds","getClipInsertIndex","cursorX","getAvailableStartAndEnd","prepareInsertIndex","pre","next","adjustStartAndEnd","availableRange","insertRange","diff","getTotalDuration","lastClip","canWithTransition","clipType","isTransitionStart","clipId","filter","findIndex","isTransitionEnd","deleteSelectedClip","editorContextValue","afterToClip","newRange","assign","splice","isClipCanSplit","canSplit","isClipTypeCanSplit","splitSelectedClip","timelineSplitTime","splitPercent","playRangeSplitTime","getPlayerContainerBounding","playerContainer","toJSON","getPlayerResolution","containerWidth","containerHeight","ratioValue","RATIO_1_1","RATIO_21_9","RATIO_3_4","RATIO_4_3","RATIO_9_16","getRatioValue","newWidth","newHeight","AudioCard","onLoaded","fetch","response","file","className","parseGif","superGif","SuperGif","draw_while_loading","load_raw","get_canvas","parentNode","get_frames","GifCard","b","alt","draggable","GLTFCard","useContext","playerContext","GLTFLoader","loadAsync","ImageCard","img","naturalWidth","naturalHeight","LottieCard","json","PagCard","File","PAGInit","locateFile","PAGFile","TextCard","TransitionCard","VideoCard","videoWidth","videoHeight","StyledCard","getAssetCard","handleLoaded","AssetCard","editorContext","loaded","setLoaded","asset","common","CUSTOM","assetToClip","setClip","handleStart","handleMove","showPrepareTrack","handleTransitionEnd","contains","dataset","halfTransitionDuration","newClip","handleEnd","pos","availableDuration","dragElementWidth","finalStart","finalEnd","renderWidth","renderHeight","MediaPanel","MenuItem","icon","title","isActive","onClick","handleClick","ResourcePanel","MinePanel","videoList","setVideoList","imageList","setImageList","audioList","setAudioList","handleBeforeUpload","handleFileChange","info","fileType","beforeUpload","onChange","multiple","accept","showUploadList","color","TextPanel","TransitionPanel","StyledAssetMenu","menuList","resourcePanel","AssetMenu","activeTab","setActiveTab","handleMenuItemClick","display","IndicatorBar","r","filterUnits","colorInterpolationFilters","floodOpacity","in","values","dy","stdDeviation","in2","operator","StyledTrackWrapper","StyledTrack","StyledNewPrepareTrack","Track","hoverIndex","background","Container","AudioTrack","containerRef","waveSurfer","WaveSurfer","create","waveColor","progressColor","fillParent","partialRender","interact","barWidth","Worker_fn","Worker","worker","snapCount","postMessage","GifTrack","canvasRef","workerRef","WebWorker","offscreenCanvas","transferControlToOffscreen","drawToCanvas","transformOrigin","memo","ImageTrack","useMemo","backgroundRepeat","backgroundSize","seekVideo","requestVideoFrameCallback","videoUrl","snapWidth","snapHeight","timeStep","ctx","VideoTrack","drawVideoToCanvas","TextTrack","lineHeight","overflow","whiteSpace","textOverflow","StyledTrackElement","StyledName","StyledHandle","transitionStyle","border","getTrackComponent","TrackElement","handleTransition","newStart","updated","originalTrackIndex","before","after","handleLeftHandleMove","preClipEnd","handleRightHandleMove","newEnd","nextClipStart","handleHandleEnd","isTransition","StyledTracksWrapper","StyledTracks","StyledIndicator","Tracks","onCurrentTimeChange","draggingClip","trackStyle","handleTracksWrapperClick","handleUpdate","oldData","newData","newClipIndex","isNewTrack","isDraggingTransition","flatClips","clip1","clip2","nextClip","showTransitionPrepareInsert","Fragment","StyledEditor","AssetAndStage","AssetPanel","TimelineWrapper","TracksScrollContainer","Stage","PlayerContainer","StyledRuler","StyledRulerItem","Ruler","setWidth","observer","ResizeObserver","observe","disconnect","useKeyboard","useKeyPress","useDeleteClip","useSplitClip","usePlayControl","Painter","maxAnisotropy","preserveDrawingBuffer","antialias","alpha","setPixelRatio","outputEncoding","shadowMap","enabled","capabilities","getMaxAnisotropy","selectedObject","getObjectByName","getDrawingBufferSize","domElement","specificScene","specificCamera","setRenderTarget","Player","tickTime","rafId","tickFunc","onCurrentTimeChangeCallback","tick","bind","requestAnimationFrame","time","updateSize","find","updateDuration","isInRange","addToPainter","onEnter","onLeave","intTime","floor","task","all","cancelAnimationFrame","tracksChanged","newClips","deleteClips","addClip","removeClip","Logo","xmlnsXlink","patternContentUnits","xlinkHref","StyledHeader","Header","Cut","Delete","Redo","Undo","StyledToolBar","Time","ClipOperators","TimeLineZoom","ToolBar","handleDelete","handleSplitClip","StyledTarget","renderDirections","ResizeRotate","setTarget","targetStyle","setTargetStyle","moveableRef","targetRef","node","useSize","updateTarget","handleDrag","params","handleResize","beforeTranslate","drag","handleRotate","absoluteRotate","origin","keepRatio","edge","onDragStart","onDrag","resizable","onResizeStart","onResize","rotatable","onRotateStart","onRotate","SelectorItem","label","FlatSelector","handleChange","ratioData","RatioSelector","trigger","overlayStyle","content","BackForward","FastForward","PauseButton","PlayButton","StyledPlayerControls","PlayButtons","Ratios","playerControlButtonStyle","borderColor","PlayerControls","handlePlayingChange","handleSetToStart","handleSetToEnd","ExportVideo","IconEffect","effectData","EffectSelector","IconFitType","fitData","FitSelector","renderInfo","ImagePanel","handleEffectChange","handleFitChange","VideoPanel","TextArea","Input","TextEditor","isComposition","setValue","newValue","handleKeyUp","code","handleCompositionStart","handleCompositionEnd","rows","cols","onKeyDown","onCompositionStart","onCompositionEnd","FormOutlined","handleTextChange","getPanel","ConfigPanel","reactive","tempClip","StyledStageHeader","ExportButton","StageHeader","handleExportVideo","exportAsVideo","createContext","Editor","playerContainerRef","handleTracksChange","newTracks","newTotalDuration","playerContextValue","playerRef","useDebounceEffect","updateResolution","wait","attachTo","playerData","flatNewData","instance","findDiff","usePlayer","handleDocumentClick","Provider","ScrollbarStyle","createGlobalStyle","ReactDOM","StrictMode","isWindows","getElementById"],"mappings":"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","file":"static/js/main.2b64b646.chunk.js","sourcesContent":["module.exports = FFmpeg;","module.exports = THREE;","import * as React from 'react';\n\nfunction MenuMedia(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={30}\n      height={30}\n      fill=\"none\"\n      {...props}\n    >\n      <rect\n        width={30}\n        height={30}\n        rx={10}\n        fill=\"url(#prefix__paint0_linear_490_3)\"\n      />\n      <mask id=\"prefix__a\" fill=\"#fff\">\n        <path\n          fillRule=\"evenodd\"\n          clipRule=\"evenodd\"\n          d=\"M7 9a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H9a2 2 0 01-2-2V9zm1-.3c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2H8.2a.2.2 0 01-.2-.2V8.7zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2H8.2zM8 14.5c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2H8.2a.2.2 0 01-.2-.2v-1.1zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2H8.2zM8 20.3c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2H8.2a.2.2 0 01-.2-.2v-1.1zM20.2 8.5a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2V8.7a.2.2 0 00-.2-.2h-1.6zm-.2 3.1c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2h-1.6a.2.2 0 01-.2-.2v-1.1zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2h-1.6zm-.2 3.1c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2h-1.6a.2.2 0 01-.2-.2v-1.1zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .111.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2h-1.6z\"\n        />\n      </mask>\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M7 9a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H9a2 2 0 01-2-2V9zm1-.3c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2H8.2a.2.2 0 01-.2-.2V8.7zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2H8.2zM8 14.5c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2H8.2a.2.2 0 01-.2-.2v-1.1zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2H8.2zM8 20.3c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2H8.2a.2.2 0 01-.2-.2v-1.1zM20.2 8.5a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2V8.7a.2.2 0 00-.2-.2h-1.6zm-.2 3.1c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2h-1.6a.2.2 0 01-.2-.2v-1.1zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2h-1.6zm-.2 3.1c0-.11.09-.2.2-.2h1.6c.11 0 .2.09.2.2v1.1a.2.2 0 01-.2.2h-1.6a.2.2 0 01-.2-.2v-1.1zm.2 2.7a.2.2 0 00-.2.2v1.1c0 .111.09.2.2.2h1.6a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2h-1.6z\"\n        fill=\"url(#prefix__paint1_linear_490_3)\"\n      />\n      <path\n        d=\"M9 6.8A2.2 2.2 0 006.8 9h.4A1.8 1.8 0 019 7.2v-.4zm12 0H9v.4h12v-.4zM23.2 9A2.2 2.2 0 0021 6.8v.4A1.8 1.8 0 0122.8 9h.4zm0 12V9h-.4v12h.4zM21 23.2a2.2 2.2 0 002.2-2.2h-.4a1.8 1.8 0 01-1.8 1.8v.4zm-12 0h12v-.4H9v.4zM6.8 21A2.2 2.2 0 009 23.2v-.4A1.8 1.8 0 017.2 21h-.4zm0-12v12h.4V9h-.4zm1.4-.7a.4.4 0 00-.4.4h.4v-.4zm1.6 0H8.2v.4h1.6v-.4zm.4.4a.4.4 0 00-.4-.4v.4h.4zm0 1.1V8.7h-.4v1.1h.4zm-.4.4a.4.4 0 00.4-.4h-.4v.4zm-1.6 0h1.6v-.4H8.2v.4zm-.4-.4c0 .22.18.4.4.4v-.4h-.4zm0-1.1v1.1h.4V8.7h-.4zm.4 2.9v-.4a.4.4 0 00-.4.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm0 0h-.4c0 .221.18.4.4.4v-.4zm1.6 0H8.2v.4h1.6v-.4zm0 0v.4a.4.4 0 00.4-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm0 0h.4a.4.4 0 00-.4-.4v.4zm-1.6 0h1.6v-.4H8.2v.4zm0 2.5a.4.4 0 00-.4.4h.4v-.4zm1.6 0H8.2v.4h1.6v-.4zm.4.4a.4.4 0 00-.4-.4v.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm-.4.4a.4.4 0 00.4-.4h-.4v.4zm-1.6 0h1.6v-.4H8.2v.4zm-.4-.4c0 .221.18.4.4.4v-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm.4 2.9V17a.4.4 0 00-.4.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm0 0h-.4c0 .221.18.4.4.4v-.4zm1.6 0H8.2v.4h1.6v-.4zm0 0v.4a.4.4 0 00.4-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm0 0h.4a.4.4 0 00-.4-.4v.4zm-1.6 0h1.6V17H8.2v.4zm0 2.5a.4.4 0 00-.4.4h.4v-.4zm1.6 0H8.2v.4h1.6v-.4zm.4.4a.4.4 0 00-.4-.4v.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm-.4.4a.4.4 0 00.4-.4h-.4v.4zm-1.6 0h1.6v-.4H8.2v.4zm-.4-.4c0 .222.18.4.4.4v-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zM20.2 8.7v-.4a.4.4 0 00-.4.4h.4zm0 1.1V8.7h-.4v1.1h.4zm0 0h-.4c0 .22.18.4.4.4v-.4zm1.6 0h-1.6v.4h1.6v-.4zm0 0v.4a.4.4 0 00.4-.4h-.4zm0-1.1v1.1h.4V8.7h-.4zm0 0h.4a.4.4 0 00-.4-.4v.4zm-1.6 0h1.6v-.4h-1.6v.4zm0 2.5a.4.4 0 00-.4.4h.4v-.4zm1.6 0h-1.6v.4h1.6v-.4zm.4.4a.4.4 0 00-.4-.4v.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm-.4.4a.4.4 0 00.4-.4h-.4v.4zm-1.6 0h1.6v-.4h-1.6v.4zm-.4-.4c0 .221.18.4.4.4v-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm.4 2.9v-.4a.4.4 0 00-.4.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm0 0h-.4c0 .221.18.4.4.4v-.4zm1.6 0h-1.6v.4h1.6v-.4zm0 0v.4a.4.4 0 00.4-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm0 0h.4a.4.4 0 00-.4-.4v.4zm-1.6 0h1.6v-.4h-1.6v.4zm0 2.5a.4.4 0 00-.4.4h.4V17zm1.6 0h-1.6v.4h1.6V17zm.4.4a.4.4 0 00-.4-.4v.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm-.4.4a.4.4 0 00.4-.4h-.4v.4zm-1.6 0h1.6v-.4h-1.6v.4zm-.4-.4c0 .221.18.4.4.4v-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm.4 2.9v-.4a.4.4 0 00-.4.4h.4zm0 1.1v-1.1h-.4v1.1h.4zm0 0h-.4c0 .222.18.4.4.4v-.4zm1.6 0h-1.6v.4h1.6v-.4zm0 0v.4a.4.4 0 00.4-.4h-.4zm0-1.1v1.1h.4v-1.1h-.4zm0 0h.4a.4.4 0 00-.4-.4v.4zm-1.6 0h1.6v-.4h-1.6v.4z\"\n        fill=\"url(#prefix__paint2_linear_490_3)\"\n        mask=\"url(#prefix__a)\"\n      />\n      <defs>\n        <linearGradient\n          id=\"prefix__paint0_linear_490_3\"\n          x1={2.5}\n          y1={3}\n          x2={27}\n          y2={27.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#05AB49\" />\n          <stop offset={1} stopColor=\"#097838\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint1_linear_490_3\"\n          x1={12.429}\n          y1={21.933}\n          x2={12.429}\n          y2={7}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.51} />\n          <stop offset={0.448} stopColor=\"#fff\" stopOpacity={0.96} />\n          <stop offset={1} stopColor=\"#fff\" stopOpacity={0.27} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint2_linear_490_3\"\n          x1={16.78}\n          y1={21.933}\n          x2={16.78}\n          y2={7}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.34} />\n          <stop offset={1} stopColor=\"#fff\" stopOpacity={0.06} />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n\nexport default MenuMedia;\n","import * as React from 'react';\n\nfunction MenuMine(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={30}\n      height={30}\n      fill=\"none\"\n      {...props}\n    >\n      <rect\n        width={30}\n        height={30}\n        rx={10}\n        fill=\"url(#prefix__paint0_linear_440_141)\"\n      />\n      <ellipse\n        cx={15}\n        cy={21.75}\n        rx={7}\n        ry={1.75}\n        fill=\"url(#prefix__paint1_linear_440_141)\"\n      />\n      <path\n        d=\"M13.25 10c0-.633.203-1.06.504-1.332.304-.276.738-.418 1.246-.418s.942.142 1.247.418c.3.271.503.699.503 1.332 0 .61-.338 1.307-.762 1.867-.209.276-.43.506-.623.665-.097.08-.183.138-.252.175a.524.524 0 01-.084.036c-.02.007-.03.007-.03.007H15s0 0 0 0-.009 0-.03-.007a.524.524 0 01-.083-.036 1.567 1.567 0 01-.252-.175 4.037 4.037 0 01-.623-.665c-.424-.56-.762-1.256-.762-1.867z\"\n        fill=\"url(#prefix__paint2_linear_440_141)\"\n        stroke=\"url(#prefix__paint3_linear_440_141)\"\n        strokeWidth={0.5}\n      />\n      <path\n        d=\"M13 20c0 1.38.896 2 2 2 1.105 0 2-.62 2-2s-1.5-3-2-3-2 1.62-2 3z\"\n        fill=\"url(#prefix__paint4_linear_440_141)\"\n      />\n      <path\n        d=\"M18.33 10.768c1.196-.69 2.18-.225 2.732.732s.464 2.042-.732 2.732c-1.196.69-3.348.2-3.598-.232-.25-.433.402-2.542 1.598-3.232z\"\n        fill=\"url(#prefix__paint5_linear_440_141)\"\n      />\n      <path\n        d=\"M9.795 15.984c-.549.317-.817.707-.902 1.103-.086.4.008.848.261 1.288.254.44.595.745.985.87.386.125.857.087 1.406-.23.529-.305.963-.946 1.236-1.593.134-.319.223-.625.264-.872a1.57 1.57 0 00.025-.306.51.51 0 00-.01-.09c-.004-.021-.008-.03-.008-.03s0 0 0 0v.001s-.005-.008-.02-.022a.53.53 0 00-.074-.054 1.566 1.566 0 00-.277-.131 4.035 4.035 0 00-.888-.207c-.697-.088-1.469-.032-1.998.273z\"\n        fill=\"url(#prefix__paint6_linear_440_141)\"\n        stroke=\"url(#prefix__paint7_linear_440_141)\"\n        strokeWidth={0.5}\n      />\n      <path\n        d=\"M20.205 15.984c.549.317.817.707.902 1.103.087.4-.008.848-.261 1.288-.254.44-.595.745-.985.87-.386.125-.857.087-1.406-.23-.529-.305-.963-.946-1.236-1.593a4.035 4.035 0 01-.264-.872 1.57 1.57 0 01-.025-.306.51.51 0 01.01-.09c.004-.021.009-.03.008-.03 0 0 0 0 0 0v.001s.005-.008.021-.022a.53.53 0 01.073-.054c.067-.042.16-.087.277-.131.235-.088.545-.164.889-.207.696-.088 1.468-.032 1.997.273z\"\n        fill=\"url(#prefix__paint8_linear_440_141)\"\n        stroke=\"url(#prefix__paint9_linear_440_141)\"\n        strokeWidth={0.5}\n      />\n      <path\n        d=\"M11.67 10.768c-1.196-.69-2.18-.225-2.732.732s-.464 2.042.732 2.732c1.196.69 3.348.2 3.598-.232.25-.433-.402-2.542-1.598-3.232z\"\n        fill=\"url(#prefix__paint10_linear_440_141)\"\n      />\n      <defs>\n        <linearGradient\n          id=\"prefix__paint0_linear_440_141\"\n          x1={0}\n          y1={0}\n          x2={27.5}\n          y2={27.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F3CE4C\" />\n          <stop offset={1} stopColor=\"#E8A912\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint1_linear_440_141\"\n          x1={17.5}\n          y1={22.625}\n          x2={17.5}\n          y2={20}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#E29800\" />\n          <stop offset={1} stopColor=\"#E29800\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint2_linear_440_141\"\n          x1={15}\n          y1={13}\n          x2={15}\n          y2={8}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint3_linear_440_141\"\n          x1={15}\n          y1={13}\n          x2={15}\n          y2={8}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.38} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint4_linear_440_141\"\n          x1={15}\n          y1={17}\n          x2={14.835}\n          y2={19.714}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.66} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint5_linear_440_141\"\n          x1={16.732}\n          y1={14}\n          x2={19}\n          y2={12.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.66} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint6_linear_440_141\"\n          x1={13.268}\n          y1={16}\n          x2={8.938}\n          y2={18.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint7_linear_440_141\"\n          x1={13.268}\n          y1={16}\n          x2={8.938}\n          y2={18.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.38} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint8_linear_440_141\"\n          x1={16.732}\n          y1={16}\n          x2={21.062}\n          y2={18.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint9_linear_440_141\"\n          x1={16.732}\n          y1={16}\n          x2={21.062}\n          y2={18.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.38} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint10_linear_440_141\"\n          x1={13.268}\n          y1={14}\n          x2={11}\n          y2={12.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.66} />\n          <stop offset={1} stopColor=\"#fff\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n\nexport default MenuMine;\n","import * as React from 'react';\n\nfunction MenuText(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={30}\n      height={30}\n      fill=\"none\"\n      {...props}\n    >\n      <rect\n        width={30}\n        height={30}\n        rx={8}\n        fill=\"url(#prefix__paint0_linear_440_718)\"\n      />\n      <path fill=\"url(#prefix__paint1_linear_440_718)\" d=\"M10 12h10v5H10z\" />\n      <path\n        d=\"M12 19.5h6V22h-6v-2.5z\"\n        fill=\"url(#prefix__paint2_linear_440_718)\"\n      />\n      <path d=\"M8 8h3v3H8V8z\" fill=\"url(#prefix__paint3_linear_440_718)\" />\n      <path d=\"M19 8h3v3h-3V8z\" fill=\"url(#prefix__paint4_linear_440_718)\" />\n      <path d=\"M8 19h3v4H8v-4z\" fill=\"url(#prefix__paint5_linear_440_718)\" />\n      <path d=\"M22 19h-3v4h3v-4z\" fill=\"url(#prefix__paint6_linear_440_718)\" />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M10.272 11.184a1 1 0 01.949-.684h7.559a1 1 0 01.948.684l.564 1.692a.474.474 0 11-.9.3l-.225-.676H16.5a.5.5 0 00-.5.5v5.5a.5.5 0 00.5.5h1.3c.11 0 .2.09.2.2v.6a.2.2 0 01-.2.2h-5.6a.2.2 0 01-.2-.2v-.6c0-.11.09-.2.2-.2h1.3a.5.5 0 00.5-.5V13a.5.5 0 00-.5-.5h-2.667l-.225.676a.474.474 0 01-.9-.3l.564-1.692zM11 7H7v4h1.5V8.5H11V7zM11 23H7v-4h1.5v2.5H11V23zM19 7h4v4h-1.5V8.5H19V7zM19 23h4v-4h-1.5v2.5H19V23z\"\n        fill=\"#fff\"\n      />\n      <defs>\n        <linearGradient\n          id=\"prefix__paint0_linear_440_718\"\n          x1={15}\n          y1={0}\n          x2={27}\n          y2={30}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#285DE7\" />\n          <stop offset={1} stopColor=\"#0F48D7\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint1_linear_440_718\"\n          x1={15}\n          y1={12.5}\n          x2={15}\n          y2={17}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.141} stopColor=\"#0239C6\" />\n          <stop offset={1} stopColor=\"#1F53DC\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint2_linear_440_718\"\n          x1={15}\n          y1={20.333}\n          x2={15}\n          y2={22}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.141} stopColor=\"#0239C6\" />\n          <stop offset={1} stopColor=\"#1F53DC\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint3_linear_440_718\"\n          x1={9.5}\n          y1={8.5}\n          x2={9.5}\n          y2={11}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.141} stopColor=\"#0239C6\" />\n          <stop offset={1} stopColor=\"#1F53DC\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint4_linear_440_718\"\n          x1={20.5}\n          y1={8.5}\n          x2={20.5}\n          y2={11}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.141} stopColor=\"#0239C6\" />\n          <stop offset={1} stopColor=\"#1F53DC\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint5_linear_440_718\"\n          x1={8}\n          y1={23}\n          x2={11}\n          y2={23}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.141} stopColor=\"#0239C6\" />\n          <stop offset={1} stopColor=\"#1F53DC\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint6_linear_440_718\"\n          x1={22}\n          y1={23}\n          x2={19}\n          y2={23}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.141} stopColor=\"#0239C6\" />\n          <stop offset={1} stopColor=\"#1F53DC\" stopOpacity={0} />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n\nexport default MenuText;\n","import * as React from 'react';\n\nfunction MenuTransition(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={30}\n      height={30}\n      fill=\"none\"\n      {...props}\n    >\n      <rect\n        width={30}\n        height={30}\n        rx={10}\n        fill=\"url(#prefix__paint0_linear_440_114)\"\n      />\n      <path\n        d=\"M15.5 24l-8-2 8-1.5 8 1.5-8 2z\"\n        fill=\"url(#prefix__paint1_linear_440_114)\"\n      />\n      <path\n        opacity={0.9}\n        d=\"M7.5 11.239a1 1 0 01.706-.956l4.5-1.385A1 1 0 0114 9.854v10.292a1 1 0 01-1.294.956l-4.5-1.385a1 1 0 01-.706-.956V11.24z\"\n        fill=\"#fff\"\n      />\n      <path\n        d=\"M23.4 11.239a.9.9 0 00-.635-.86l-4.5-1.385a.9.9 0 00-1.165.86v10.292a.9.9 0 001.165.86l4.5-1.384a.9.9 0 00.635-.86v-7.523z\"\n        fill=\"url(#prefix__paint2_linear_440_114)\"\n        stroke=\"url(#prefix__paint3_linear_440_114)\"\n        strokeWidth={0.2}\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M15.75 7h-.5v2h.5V7zm0 3h-.5v2h.5v-2zm-.5 3h.5v2h-.5v-2zm.5 3h-.5v2h.5v-2zm-.5 3h.5v2h-.5v-2zm.5 3h-.5v2h.5v-2z\"\n        fill=\"#fff\"\n      />\n      <defs>\n        <linearGradient\n          id=\"prefix__paint0_linear_440_114\"\n          x1={15}\n          y1={0}\n          x2={28}\n          y2={30}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#B04CFF\" />\n          <stop offset={1} stopColor=\"#864CFF\" />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint1_linear_440_114\"\n          x1={15.5}\n          y1={24.5}\n          x2={15.5}\n          y2={20.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop offset={0.258} stopColor=\"#632AD9\" />\n          <stop offset={1} stopColor=\"#632AD9\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint2_linear_440_114\"\n          x1={17}\n          y1={14.5}\n          x2={24}\n          y2={14.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.56} />\n          <stop offset={1} stopColor=\"#fff\" stopOpacity={0.03} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint3_linear_440_114\"\n          x1={17}\n          y1={16}\n          x2={19}\n          y2={16}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#fff\" stopOpacity={0.34} />\n          <stop offset={1} stopColor=\"#fff\" stopOpacity={0} />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n\nexport default MenuTransition;\n","import { TransitionType } from './player';\n\nexport enum AssetType {\n  VIDEO,\n  IMAGE,\n  AUDIO,\n  TRANSITION,\n  GIF,\n  TEXT,\n  LOTTIE,\n  PAG,\n  GLTF,\n}\n\nexport interface Asset {\n  name: string;\n  type: AssetType;\n}\n\nexport interface VideoAsset extends Asset {\n  url: string;\n}\n\nexport interface GLTFAsset extends Asset {\n  url: string;\n}\n\nexport interface ImageAsset extends Asset {\n  url: string;\n}\n\nexport interface AudioAsset extends Asset {\n  url: string;\n}\n\nexport interface GifAsset extends Asset {\n  url: string;\n}\n\nexport interface TextAsset extends Asset {\n  value: string;\n}\n\nexport interface TransitionAsset extends Asset {\n  transition: TransitionType;\n}\n\nexport interface LottieAsset extends Asset {\n  url: string;\n}\n\nexport interface PagAsset extends Asset {\n  url: string;\n}\n","export const AUDIOS = [\n  {\n    name: 'music-sky',\n    url: 'asset/1.mp3',\n  },\n  {\n    name: 'music-jay',\n    url: 'asset/2.mp3',\n  },\n];\n","import { ObjectType } from '.';\n\nexport enum FitType {\n  CUSTOM,\n  /** 铺满整个播放器，不考虑长宽比 */\n  FILL,\n  /** 保持长宽比，不会被裁剪，可能没法铺满整个播放器 */\n  CONTAIN,\n  /** 铺满整个播放器，同时保持长宽比，可能存在裁剪 */\n  COVER,\n}\n\nexport enum EffectType {\n  NO_EFFECT,\n  GRAY,\n  TRIANGLE_BLUR,\n  GAUSSIAN_BLUR,\n}\n\nexport interface Effect {\n  uniforms: ObjectType;\n  fragment: (texName?: string, funName?: string) => string;\n}\n\nexport enum TransitionType {\n  MORPH,\n  DREAMY,\n  FADE,\n  HEXAGONALIZE,\n  GLITCH_MEMORIES,\n  PERLIN,\n  CROSS_ZOOM,\n}\n\nexport enum OverlayType {\n  PLUNGING,\n}\n","import { TransitionType } from '../common/types/player';\n\nexport const TRANSITIONS = [\n  {\n    name: 'dreamy',\n    transition: TransitionType.DREAMY,\n  },\n  {\n    name: 'fade',\n    transition: TransitionType.FADE,\n  },\n  {\n    name: 'morph',\n    transition: TransitionType.MORPH,\n  },\n  {\n    name: 'hexagonalize',\n    transition: TransitionType.HEXAGONALIZE,\n  },\n  {\n    name: 'glitch memories',\n    transition: TransitionType.GLITCH_MEMORIES,\n  },\n  {\n    name: 'perlin',\n    transition: TransitionType.PERLIN,\n  },\n  {\n    name: 'cross zoom',\n    transition: TransitionType.CROSS_ZOOM,\n  },\n];\n","export enum Ratio {\n  RATIO_16_9,\n  RATIO_9_16,\n  RATIO_4_3,\n  RATIO_3_4,\n  RATIO_21_9,\n  RATIO_1_1,\n}\n","import {\n  AssetType,\n  AudioAsset,\n  GifAsset,\n  ImageAsset,\n  TextAsset,\n  TransitionAsset,\n  VideoAsset,\n  LottieAsset,\n  PagAsset,\n  GLTFAsset,\n} from '../common/types/asset';\nimport { AUDIOS } from './audios';\nimport { GIFS } from './gifs';\nimport { IMAGES } from './images';\nimport { TEXTS } from './texts';\nimport { TRANSITIONS } from './transitions';\nimport { VIDEOS } from './videos';\nimport { LOTTIES } from './lotties';\nimport { PAGS } from './pag';\nimport { GLTFS } from './gltf';\n\nexport const ASSET = {\n  videos: VIDEOS.map((video) => ({ type: AssetType.VIDEO, ...video })) as VideoAsset[],\n  images: IMAGES.map((image) => ({ type: AssetType.IMAGE, ...image })) as ImageAsset[],\n  audios: AUDIOS.map((audio) => ({ type: AssetType.AUDIO, ...audio })) as AudioAsset[],\n  transitions: TRANSITIONS.map((transition) => ({ type: AssetType.TRANSITION, ...transition })) as TransitionAsset[],\n  gifs: GIFS.map((gif) => ({ type: AssetType.GIF, ...gif })) as GifAsset[],\n  texts: TEXTS.map((text) => ({ type: AssetType.TEXT, ...text })) as TextAsset[],\n  lotties: LOTTIES.map((lottie) => ({ type: AssetType.LOTTIE, ...lottie })) as LottieAsset[],\n  pags: PAGS.map((pag) => ({ type: AssetType.PAG, ...pag })) as PagAsset[],\n  gltfs: GLTFS.map((gltf) => ({ type: AssetType.GLTF, ...gltf })) as GLTFAsset[],\n};\n","export const VIDEOS = [\n  {\n    name: 'video-leaf',\n    url: 'asset/1.mp4', //'https://adsmind.gdtimg.com/ads_svp_video__0b533eaaaaaa7iaef32e55qrvwieadmqaaca.f0.mp4?dis_k=db0de64d4f56c2015472040b1d4dbe05&dis_t=1631864114&m=0a60e4eff013efd2db2228ee7b92ac66',\n  },\n  // {\n  //   name: 'sunflower',\n  //   url: 'https://adsmind.gdtimg.com/ads_svp_video__0b5356bikoyameao6cufayabuqaee7xqhbibaaaab3yk..mp4?dis_k=00336127182714ebee73d007e9ebd394&dis_t=1631259090&m=78f766034a7339a822b3a1881bf122b6',\n  // },\n  {\n    name: 'video-cartoon',\n    url: 'asset/3.webm', //'https://adsmind.gdtimg.com/ads_svp_video__0b533eaaaaaa7iaef32e55qrvwieadmqaaca.f0.mp4?dis_k=db0de64d4f56c2015472040b1d4dbe05&dis_t=1631864114&m=0a60e4eff013efd2db2228ee7b92ac66',\n  },\n  // {\n  //   name: 'leaf-2',\n  //   url: 'asset/1.mp4', //'https://adsmind.gdtimg.com/ads_svp_video__0b533eaaaaaa7iaef32e55qrvwieadmqaaca.f0.mp4?dis_k=db0de64d4f56c2015472040b1d4dbe05&dis_t=1631864114&m=0a60e4eff013efd2db2228ee7b92ac66',\n  // },\n];\n","export const IMAGES = [\n  {\n    name: 'image-dawn',\n    url: 'https://images.unsplash.com/photo-1634322474954-d69e93a8480b?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=2370&q=80',\n  },\n  {\n    name: 'image-monkey',\n    url: 'asset/1.png',\n  },\n];\n","export const GIFS = [\n  {\n    name: 'gif-horses',\n    url: 'asset/horses.gif',\n  },\n  {\n    name: 'gif-love',\n    url: 'asset/1.gif',\n  },\n];\n","export const TEXTS = [\n  {\n    name: '文本',\n    value: '添加文本',\n  },\n];\n","export const LOTTIES = [\n  {\n    name: 'lottie-word',\n    url: 'asset/word.json',\n  },\n];\n","export const PAGS = [\n  {\n    name: 'pag-shine',\n    url: 'asset/shine.pag',\n  },\n];\n","export const GLTFS = [\n  {\n    name: 'gltf-solider',\n    url: 'models/solider.glb',\n  },\n  {\n    name: 'gltf-aini',\n    url: 'models/aini.gltf',\n  },\n  {\n    name: 'gltf-man',\n    url: 'models/man.gltf',\n  },\n];\n","import styled from 'styled-components';\n\nexport const Radius10Button = styled.div`\n  width: 30px;\n  height: 30px;\n  background: #26384E;\n  border: 1px solid #2A3F5F;\n  box-sizing: border-box;\n  border-radius: 10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n\n  svg path {\n    fill: #7B9FD6;\n    transition: fill 0.3s;\n  }\n\n  &:hover {\n    background: #3A36E4 !important;\n    color: #fff !important;\n    border-color: #3648E0 !important;\n\n    svg path {\n      fill: #fff;\n    }\n  }\n\n  &.disabled {\n    pointer-events: none;\n    background: #1F2836;\n    color: #475d80;\n    border-color: #222B3A !important;\n\n    svg path {\n      fill: #475d80;\n    }\n  }\n\n  &.warn:hover {\n    background: #E62519;\n    border-color: #EF3327;\n  }\n`;\n\nexport const Radius99Button = styled.div`\n  height: 24px;\n  padding: 0 14px;\n  background: #1F2836;\n  box-sizing: border-box;\n  border-radius: 99px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n\n  svg path {\n    fill: #7B9FD6;\n    transition: fill 0.3s;\n  }\n\n  &:hover {\n    background: #3A36E4;\n    color: #fff;\n    border-color: #3648E0;\n\n    svg path {\n      fill: #fff;\n    }\n  }\n\n  &.disabled {\n    pointer-events: none;\n    background: #1b1f25;\n    color: #475d80;\n    border-color: #101214;\n\n    svg path {\n      fill: #475d80;\n    }\n  }\n\n  &.warn:hover {\n    background: #E62519;\n  }\n`;\n\nexport const MenuItemContainer = styled.div`\n  width: 80px;\n  height: 76px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin: 4px 26px 0 0;\n  cursor: pointer;\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n  position: relative;\n  flex-shrink: 0;\n\n  &.active::before {\n    content: '';\n    position: absolute;\n    width: 20px;\n    height: 3px;\n    border-radius: 2px;\n    top: -3px;\n  }\n\n  &.active {\n    background-color: #1A212A;\n\n    &:nth-child(1)::before {\n      background: #EFCC4F;\n    }\n    &:nth-child(2)::before {\n      background: #B04CFF;\n    }\n    &:nth-child(3)::before {\n      background: #2057E2;\n    }\n    &:nth-child(4)::before {\n      background: #097E3B;\n    }\n    &:nth-child(5)::before {\n      background: #EF1DAE;\n    }\n    &:nth-child(6)::before {\n      background: #2057E2;\n    }\n    &:nth-child(7)::before {\n      background: #EFCC4F;\n    }\n  }\n\n  &:hover {\n    background-color: #1C2530;\n  }\n\n  .icon {\n    width: 30px;\n    height: 30px;\n  }\n\n  .title {\n    margin-top: 10px;\n    font-size: 14px;\n    line-height: 16px;\n    color: #516482;\n  }\n`;\n\nexport const SubMenuContainer = styled.div`\n  margin: -8px 0 24px 0;\n  display: flex;\n  flex-grow: 1;\n  width: 100%;\n  padding-right: 36px;\n  justify-content: space-between;\n`;\n\nexport const SubMenuButton = styled.div`\n  display: flex;\n  border-radius: 10px;\n  height: 30px;\n  color: #516482;\n  padding: 0 12px;\n  align-items: center;\n  &:hover {\n    color: #81ACF0;\n    background: #26384E;\n  }\n  &.active {\n    color: #81ACF0;\n    background: #26384E;\n  }\n`;\n\nexport const SelectorButton = styled.div`\n  border-radius: 4px;\n  color: #81ACF0;\n  height: 32px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  padding: 0 15px;\n  margin-bottom: 10px;\n  &:last-child {\n    margin-bottom: 0;\n  }\n  &:hover, &.active {\n    background: #26384E;\n  }\n`;\n\nexport const AssetWhole = styled.div`\n  margin-bottom: 40px;\n  .asset-title {\n    color: #7185A6;\n    font-size: 14px;\n    line-height: 14px;\n    max-width: 200px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  &:hover {\n    .asset-title {\n      color: #fff;\n    }\n  }\n`;\n\nexport const AssetCardContainer = styled.div`\n  width: 200px;\n  height: 112px;\n  margin: 0 36px 20px 0;\n`;\n\nexport const StyledAssetCard = styled.div`\n  width: 100%;\n  height: 100%;\n  border-radius: 4px;\n  cursor: move;\n  overflow: hidden;\n  position: relative;\n\n  img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    vertical-align: unset;\n  }\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .title {\n    position: absolute;\n    bottom: 8px;\n    left: 8px;\n    color: #D5D5D5;\n    font-size: 12px;\n    height: 12px;\n    line-height: 12px;\n  }\n`;\n\nexport const ConfigPanelIconContainer = styled.div`\n  display: flex;\n\n  >* {\n    margin-right: 10px;\n  }\n`;\n","import { TextClip } from '../types/clip';\nimport lottie, { AnimationItem }  from 'lottie-web';\nimport { LottieInfo, ObjectType } from '../types';\nimport { Ratio } from '../configs';\nimport { PAG } from 'libpag/types/types';\nimport { PAGInit } from 'libpag';\n\nexport function getPixelRatio() {\n  return 2;\n}\n\nexport function setStyles(el: HTMLElement, styles: Partial<CSSStyleDeclaration>) {\n  Object.keys(styles).forEach((key) => {\n    // @ts-ignore\n    el.style.setProperty(key.replace(/([A-Z])/g, '-$1').toLowerCase(), styles[key as keyof CSSStyleDeclaration]);\n  });\n}\n\nexport function formatMillisecond(ms: number, showMS: boolean = false, showHour: boolean = true) {\n  let result = '';\n  const msRemainder = ms % 1000;\n  if (msRemainder || showMS) {\n    result = `.${String(msRemainder).padStart(3, '0')}`\n  }\n\n  const seconds = (ms - msRemainder) / 1000;\n  const secondRemainder = seconds % 60;\n  result = `${String(secondRemainder).padStart(2, '0')}${result}`;\n\n  const minutes = (seconds - secondRemainder) / 60;\n  const minuteRemainder = minutes % 60;\n  result = `${String(minuteRemainder).padStart(2, '0')}:${result}`;\n\n  const hours = (minutes - minuteRemainder) / 60;\n  if (showHour || hours) {\n    result = `${String(hours).padStart(2, '0')}:${result}`;\n  }\n  return result;\n}\n\nexport function svgToCanvas(svg: string, canvas: HTMLCanvasElement, canvasContext: CanvasRenderingContext2D | null | undefined) {\n  return new Promise((resolve, reject) => {\n    const { width, height } = canvas;\n    const image = new Image();\n    image.width = width;\n    image.height = height;\n    image.onload = function() {\n      if (canvasContext) {\n        canvasContext.clearRect(0, 0, width, height);\n        canvasContext.drawImage(image, 0, 0);\n      }\n      resolve(true);\n    };\n    image.onerror = function(error) {\n      reject(error);\n    };\n    image.src = `data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(svg.trim())))}`;\n  });\n}\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => {\n    window.setTimeout(resolve, ms);\n  });\n}\n\nexport function downloadFile(fileURL: string, fileName: string) {\n  const saveLink = document.createElement('a');\n  saveLink.href = fileURL;\n  saveLink.target = '_blank';\n  saveLink.download = fileName;\n  if (navigator.userAgent.toLowerCase().match(/(ipad|iphone|safari)/) && navigator.userAgent.search('Chrome') < 0) {\n    document.location = saveLink.href;\n  } else { // window event not working here\n    const event = new MouseEvent('click', {\n      view: window,\n      bubbles: true,\n      cancelable: false,\n    });\n    saveLink.dispatchEvent(event);\n    (window.URL || window.webkitURL).revokeObjectURL(saveLink.href);\n  }\n}\n\nexport function getTextClipCssText(clip: TextClip) {\n  const { fontColor, fontSize, fontFamily } = clip.props;\n  return [\n    `color:${fontColor}`,\n    `font-size:${fontSize}px`,\n    `line-height:${fontSize + 6}px`,\n    `font-family:${fontFamily}`,\n    'font-weight:200',\n    'display:inline-block',\n    'transform-origin:left top',\n    `transform:scale(${getPixelRatio()})`,\n    `position:fixed`,\n  ].join(';');\n}\n\nexport function getTextClipSize(clip: TextClip) {\n  let container = document.querySelector('.div-for-text-size-calc') as HTMLDivElement;\n  if (!container) {\n    container = document.createElement('div');\n    container.setAttribute('class', 'div-for-text-size-calc');\n    document.body.appendChild(container);\n  }\n  container.innerText = clip.value;\n  container.style.cssText = getTextClipCssText(clip);\n  const bound = container.getBoundingClientRect();\n  return {\n    width: Math.ceil(bound.width),\n    height: Math.ceil(bound.height),\n  };\n}\n\nexport function textClipToSvg(clip: TextClip) {\n  return `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\">\n    <foreignObject width=\"100%\" height=\"100%\">\n      <div xmlns=\"http://www.w3.org/1999/xhtml\">\n        <div style=\"${getTextClipCssText(clip)}\">\n          ${clip.value.replace(/\\n/gi, '<br />')}\n        </div>\n      </div>\n    </foreignObject>\n  </svg>`;\n}\n\nexport function loadLottie(container: HTMLDivElement, animationData: ObjectType): Promise<AnimationItem> {\n  return new Promise((resolve) => {\n    const lottieInstance = lottie.loadAnimation({\n      container,\n      loop: false,\n      autoplay: false,\n      // @ts-ignore\n      renderer: 'canvas',\n      animationData,\n    });\n    if (lottieInstance.isLoaded) {\n      resolve(lottieInstance);\n    } else {\n      lottieInstance.addEventListener('DOMLoaded', () => {\n        resolve(lottieInstance);\n      });\n    }\n  });\n}\n\nexport async function getLottieInfo(animationData: ObjectType): Promise<LottieInfo> {\n  const container = document.createElement('div');\n  document.body.appendChild(container);\n  const lottieInstance = await loadLottie(container, animationData);\n  const result = {\n    width: animationData.w,\n    height: animationData.h,\n    duration: Math.round(lottieInstance.getDuration() * 1000),\n  };\n  lottieInstance.destroy();\n  document.body.removeChild(container);\n  return result;\n}\n\nexport function getRatioValue(ratio: Ratio) {\n  switch (ratio) {\n    case Ratio.RATIO_16_9:\n      return 16 / 9;\n    case Ratio.RATIO_1_1:\n      return 1;\n    case Ratio.RATIO_21_9:\n      return 21 / 9;\n    case Ratio.RATIO_3_4:\n      return 3 / 4;\n    case Ratio.RATIO_4_3:\n      return 4 / 3;\n    case Ratio.RATIO_9_16:\n      return 9 / 16;\n  }\n}\n\nlet promise: Promise<PAG> | null;\nlet pagWasm: PAG | null;\nexport function loadPagWasmModule(): Promise<PAG> {\n  if (pagWasm) {\n    return Promise.resolve(pagWasm);\n  }\n  if (promise) {\n    return promise;\n  }\n  promise = new Promise((resolve, reject) => {\n    PAGInit({\n      locateFile: () => 'https://staticfile.qq.com/creative-market/p15d0a5f5e0754a75bf77a52973f8c438/latest/libpag_0.1.4-beta.2.wasm',\n    }).then(pag => {\n      pagWasm = pag;\n      promise = null;\n      resolve(pag);\n    }).catch(e => {\n      promise = null;\n      reject(e);\n    });\n  });\n  return promise;\n}\n\nexport function rangeLimit(value: number, start: number, end: number  ) {\n  return Math.min(end, Math.max(start, value));\n}\n","export enum MoveDirection {\n  ALL,\n  EW, // 东西\n  NS, // 北南\n}\n","import React, { ReactElement, useCallback, useEffect, useRef, useState } from 'react';\nimport { setStyles } from '../../utils';\nimport { MoveDirection } from './config';\nimport { DragInfo } from './type';\n\ntype Props<T> = {\n  children: React.ReactElement;\n  direction?: MoveDirection;\n  scrollContainerSelector?: string;\n  autoGrow?: boolean;\n  enable?: boolean;\n  attachData?: T;\n  slow?: number;\n  onStart?(): void;\n  onMove?(dragInfo: DragInfo<T>): void;\n  onEnd?(dragInfo: DragInfo<T>): void;\n};\n\nfunction isLeftButton(e: MouseEvent) {\n  if (e.metaKey || e.ctrlKey || e.altKey || e.shiftKey) {\n    return false;\n  } else if ('buttons' in e) {\n    return e.buttons === 1;\n  } else if ('which' in e) {\n    return e.which === 1;\n  }\n  return (e.button === 1 || e.type === 'click');\n}\n\nconst Draggable = <T extends {}>({\n  children,\n  direction = MoveDirection.ALL,\n  scrollContainerSelector,\n  autoGrow,\n  enable = true,\n  attachData,\n  slow = 1,\n  onStart,\n  onMove,\n  onEnd,\n}: Props<T>): JSX.Element => {\n  const childRef = useRef<HTMLElement | null>(null);\n  const shiftX = useRef(0);\n  const shiftY = useRef(0);\n  const timer = useRef(0);\n  const originalStyle = useRef('');\n  const originalLeft = useRef(0);\n  const originalTop = useRef(0);\n  const preLeft = useRef(0);\n  const preTop = useRef(0);\n  const isEnd = useRef(false);\n  const count = useRef(0);\n  const isMoved = useRef(false);\n  const isHoverScrollContainer = useRef(false);\n\n  const [dragInfo, setDragInfo] = useState<DragInfo<T>>();\n  useEffect(() => {\n    if (dragInfo) {\n      if (isEnd.current) {\n        count.current = 0;\n        onEnd?.(dragInfo);\n      } else {\n        count.current = count.current + 1;\n        (count.current % slow) === 0 && onMove?.(dragInfo);\n      }\n      setDragInfo(undefined);\n    }\n  }, [dragInfo, onEnd, onMove, slow]);\n\n  /**\n   * 更新拖拽元素的位置\n   */\n  const move = useCallback((el: HTMLElement, pageX: number, pageY: number) => {\n    let transformStyle = '';\n    if (MoveDirection.ALL === direction) {\n      transformStyle = `translate(${pageX - shiftX.current}px, ${pageY - shiftY.current}px)`;\n    }\n    if (MoveDirection.EW === direction) {\n      transformStyle = `translate(${pageX - shiftX.current}px, ${originalTop.current}px)`;\n    }\n    if (MoveDirection.NS === direction) {\n      transformStyle = `translate(${originalLeft.current}px, ${pageY - shiftY.current}px)`;\n    }\n    el.style.transform = transformStyle;\n  }, [direction]);\n\n  const handleHold = useCallback((step: number, wrapper: HTMLElement, scrollContainer: HTMLElement) => {\n    timer.current = window.setInterval(() => {\n      const wrapperRect = wrapper.getBoundingClientRect();\n      if (step > 0 && autoGrow && (wrapper.scrollLeft + wrapperRect.width) > (scrollContainer.clientWidth - 100)) {\n        scrollContainer.style.width = `${scrollContainer.clientWidth + 100}px`;\n      }\n      wrapper.scrollLeft += step * 2; // hold的时候加快速度\n    }, 1000 / 60);\n  }, [autoGrow]);\n\n  /**\n   * 更新指定容器的滚动位置\n   */\n  const handleScroll = useCallback((below: HTMLElement, pageX: number, pageY: number) => {\n    if (timer) {\n      window.clearInterval(timer.current);\n      timer.current = 0;\n    }\n    if (scrollContainerSelector) {\n      const scrollThreshold = 100;\n      const scrollContainer = document.querySelector(scrollContainerSelector) as HTMLElement;\n      if (!isHoverScrollContainer.current) {\n        if (!below?.closest(scrollContainerSelector)) { // 如果不在滚动容器内，则不滚动\n          return;\n        } else {\n          isHoverScrollContainer.current = true;\n        }\n      }\n      if (scrollContainer?.parentElement) {\n        const wrapper = scrollContainer.parentElement;\n        const wrapperRect = wrapper.getBoundingClientRect();\n        let step = 0;\n        if (pageX > wrapperRect.right - scrollThreshold) { // 向右👉\n          if (autoGrow && (wrapper.scrollLeft + wrapperRect.width) > (scrollContainer.clientWidth - 100)) {\n            scrollContainer.style.width = `${scrollContainer.clientWidth + 100}px`;\n          }\n          step = 5 * (1 + Math.min((pageX - wrapperRect.right + scrollThreshold) / scrollThreshold, 1));\n        } else if (pageX < wrapperRect.left + scrollThreshold) { // 👈向左\n          step = -5 * (1 + Math.min((wrapperRect.left + scrollThreshold - pageX) / scrollThreshold, 1));\n        }\n        if (step !== 0) {\n          wrapper.scrollLeft += step;\n          handleHold(step, wrapper, scrollContainer);\n        }\n      }\n    }\n  }, [autoGrow, handleHold, scrollContainerSelector]);\n\n  const handleMouseMove = useCallback((e: MouseEvent) => {\n    const el = childRef.current;\n    if (el) {\n      el.hidden = true;\n      const below = document.elementFromPoint(e.clientX, e.clientY) as HTMLElement;\n      move(el, e.pageX, e.pageY);\n      handleScroll(below, e.pageX, e.pageY);\n      const currentLeft = e.pageX - shiftX.current;\n      const currentTop = e.pageY - shiftY.current;\n      const stepLeft = currentLeft - preLeft.current;\n      const stepTop = currentTop - preTop.current;\n      if (stepLeft !== 0 || stepTop !== 0) {\n        isMoved.current = true;\n        setDragInfo({\n          element: el,\n          belowElement: below,\n          left: currentLeft,\n          top: currentTop,\n          originalLeft: originalLeft.current,\n          originalTop: originalTop.current,\n          stepLeft: currentLeft - preLeft.current,\n          stepTop: currentTop - preTop.current,\n          cursorLeft: e.pageX,\n          cursorTop: e.pageY,\n          attachData,\n          isMoved: isMoved.current,\n        });\n        preLeft.current = currentLeft;\n        preTop.current = currentTop;\n      }\n      el.hidden = false;\n    }\n  }, [move, handleScroll, attachData]);\n\n  const handleMouseUp = useCallback((e: MouseEvent) => {\n    const { pageX, pageY } = e;\n    const el = childRef.current;\n    if (el) {\n      el.hidden = true;\n      const below = document.elementFromPoint(e.clientX, e.clientY) as HTMLElement;\n      el.hidden = false;\n      el.classList.remove('dragged');\n      el.setAttribute('style', originalStyle.current);\n      isEnd.current = true;\n      setDragInfo({\n        element: el,\n        belowElement: below,\n        left: pageX - shiftX.current,\n        top: pageY - shiftY.current,\n        originalLeft: originalLeft.current,\n        originalTop: originalTop.current,\n        stepLeft: 0,\n        stepTop: 0,\n        cursorLeft: pageX,\n        cursorTop: pageY,\n        attachData,\n        isMoved: isMoved.current,\n      });\n    }\n    window.clearInterval(timer.current);\n    window.removeEventListener('mousemove', handleMouseMove, false);\n    window.removeEventListener('mouseup', handleMouseUp, false);\n  }, [attachData, handleMouseMove]);\n\n  const handleMouseDown = useCallback((e: MouseEvent) => {\n    e.stopPropagation();\n    if (!isLeftButton(e)) {\n      return;\n    }\n    if (childRef.current) {\n      isEnd.current = false;\n      const el = childRef.current;\n      const { left, top, width, height } = el.getBoundingClientRect();\n      shiftX.current = e.clientX - left;\n      shiftY.current = e.clientY - top;\n\n      // 保留原样式\n      originalStyle.current = el.getAttribute('style') || '';\n      originalLeft.current = left;\n      originalTop.current = top;\n      preLeft.current = left;\n      preTop.current = top;\n      isHoverScrollContainer.current = false;\n      isMoved.current = false;\n\n      setStyles(el, {\n        transform: `translate(${left}px, ${top}px)`,\n        width: `${width}px`,\n        height: `${height}px`,\n      });\n      el.classList.add('dragged');\n      onStart?.();\n      move(el, e.pageX, e.pageY);\n      window.addEventListener('mousemove', handleMouseMove, false);\n      window.addEventListener('mouseup', handleMouseUp, false);\n    }\n  }, [handleMouseMove, handleMouseUp, move, onStart]);\n\n  useEffect(() => {\n    const container = childRef.current;\n    if (container && enable) {\n      container.addEventListener('mousedown', handleMouseDown, false);\n      return () => {\n        container.removeEventListener('mousedown', handleMouseDown, false);\n      };\n    }\n  }, [childRef, enable, handleMouseDown]);\n  return (\n    <>\n      {\n        React.cloneElement(children as ReactElement, {\n          ref: (ref: HTMLElement) => (childRef.current = ref),\n        })\n      }\n    </>\n  );\n};\n\nexport default Draggable;\n","import { EffectType, FitType, TransitionType } from './player';\nimport { OverlayProps } from '../../player/svgs';\nimport { GifFrame, ObjectType } from '.';\nimport { PAGFile } from 'libpag/types/pag-file';\nimport { PAG } from 'libpag/types/types';\nimport { GLTF } from 'three/examples/jsm/loaders/GLTFLoader';\n\nexport enum ClipType {\n  UNKNOWN,\n  VIDEO,\n  IMAGE,\n  AUDIO,\n  TRANSITION,\n  SVG,\n  LOTTIE,\n  TEXT,\n  GIF,\n  PAG,\n  GLTF,\n}\n\nexport interface GeometryInfo {\n  rotate: number;\n  position: {\n    x: number;\n    y: number;\n  },\n  size: {\n    width: number;\n    height: number;\n  },\n}\n\nexport interface Clip {\n  id?: string;\n  name: string;\n  type: ClipType;\n  /** 在时间轴上的位置 */\n  timelineInfo: {\n    start: number;\n    end: number;\n    duration: number;\n  };\n  geometryInfo: GeometryInfo,\n  /** 原始素材的播放范围 */\n  playRange: {\n    start: number;\n    end: number;\n  },\n  fitType: FitType;\n  effect: EffectType;\n  originalWidth: number;\n  originalHeight: number;\n  zIndex: number;\n}\n\nexport interface VideoClip extends Clip {\n  url: string;\n  blobUrl: string;\n  buffer: ArrayBuffer;\n}\n\nexport interface ImageClip extends Clip {\n  url: string;\n  blobUrl: string;\n}\n\nexport interface AudioClip extends Clip {\n  url: string;\n  buffer: ArrayBuffer;\n}\n\nexport interface LottieClip extends Clip {\n  url: string;\n  animationData: ObjectType;\n}\n\nexport interface PagClip extends Clip {\n  url: string;\n  pagFile: PAGFile;\n  pag: PAG;\n}\n\nexport interface GLTFClip extends Clip {\n  url: string;\n  modelData: GLTF;\n}\n\nexport interface TextClip extends Clip {\n  value: string;\n  props: {\n    fontColor: string;\n    fontSize: number;\n    fontFamily: string;\n  };\n}\n\nexport interface SvgClip extends Clip {\n  func(props: OverlayProps): string; \n}\n\nexport interface GifClip extends Clip {\n  url: string;\n  frames: GifFrame[];\n}\n\nexport interface TransitionClip extends Clip {\n  transition: TransitionType;\n  fromId?: string;\n  toId?: string;\n}\n\nexport interface AudioMergeItem {\n  /** 在整个player中的开始时间 */\n  delay: number;\n  /** 原音频中的开始时间 */\n  from: number;\n  /** 原音频中的结束时间 */\n  to: number;\n  /** 播放速度 */\n  tempo: number;\n  type: ClipType;\n  buffer: ArrayBuffer;\n}\n","import { ObjectType } from '../types';\n\ninterface WatchMapValue {\n  [key: string | number | symbol]: Set<(newVal: any, oldVal: any) => void>;\n}\n\nconst watchList: Map<ObjectType, WatchMapValue> = new Map();\n\nexport function watch<ObjType, K extends keyof ObjType>(\n  watchObj: ObjType,\n  key: K,\n  callback: (newVal: ObjType[K], oldVal: ObjType[K]) => void,\n) {\n  if (!watchList.has(watchObj)) {\n    const set = new Set<(newVal: ObjType[K], oldVal: ObjType[K]) => void>();\n    watchList.set(watchObj, { [key]: set });\n  }\n  const map = watchList.get(watchObj);\n  if (map && !map[key]) {\n    map[key] = new Set<(newVal: ObjType[K], oldVal: ObjType[K]) => void>();\n  }\n  watchList.get(watchObj)?.[key].add(callback);\n  let currentVal = watchObj[key];\n  Object.defineProperty(watchObj, key, {\n    get: () => {\n      return currentVal;\n    },\n    set: (newVal: ObjType[K]) => {\n      const oldVal = currentVal;\n      currentVal = newVal;\n      if (newVal !== oldVal) {\n        watchList.get(watchObj)?.[key].forEach((item) => {\n          item(newVal, oldVal);\n          // callback(newVal, oldVal);\n        });\n      }\n    },\n  });\n}\n\nexport function removeWatch<ObjType>(watchObj: ObjType) {\n  if (watchList.has(watchObj)) {\n    watchList.delete(watchObj);\n  }\n}\n","/**\n * 组装transition和effect\n */\nimport { FitType } from '../../common/types/player';\nimport { glsl } from 'typed-glsl';\nimport * as THREE from 'three';\n\ntype EffectProps = {\n  effect: string;\n};\n\n/**\n * 根据适配模式计算uv映射\n */\nexport function calcUVMap(\n  fitType: FitType,\n  /** 播放器宽度 */\n  playerWidth: number,\n  /** 播放器高度 */\n  playerHeight: number,\n  /** width in geometryInfo */\n  currentWidth: number,\n  /** height in geometryInfo */\n  currentHeight: number,\n  /** 素材原始宽度 */\n  originalWidth: number,\n  /** 素材原始高度 */\n  originalHeight: number,\n  /** 相对于左下角的移动距离 */\n  translateInPixel: THREE.Vector2 = new THREE.Vector2(0, 0),\n) {\n  let texWidth = currentWidth; // FitType.CUSTOM\n  let texHeight = currentHeight; // FitType.CUSTOM\n  let translate = translateInPixel.clone(); // FitType.CUSTOM\n  if (fitType === FitType.CONTAIN) {\n    const playerRatio = playerWidth / playerHeight;\n    const texRatio = originalWidth / originalHeight;\n    if (playerRatio / texRatio > 1) {\n      texHeight = playerHeight;\n      texWidth = originalWidth * (playerHeight / originalHeight);\n      translate.set((playerWidth - texWidth) * 0.5, 0);\n    } else {\n      texWidth = playerWidth;\n      texHeight = originalHeight * (playerWidth / originalWidth);\n      translate.set(0, (playerHeight - texHeight) * 0.5);\n    }\n  } else if (fitType === FitType.COVER) {\n    const playerRatio = playerWidth / playerHeight;\n    const texRatio = originalWidth / originalHeight;\n    if (playerRatio / texRatio > 1) {\n      texWidth = playerWidth;\n      texHeight = originalHeight * (playerWidth / originalWidth);\n      translate.set(0, (playerHeight - texHeight) * 0.5);\n    } else {\n      texHeight = playerHeight;\n      texWidth = originalWidth * (playerHeight / originalHeight);\n      translate.set((playerWidth - texWidth) * 0.5, 0);\n    }\n  } else if (fitType === FitType.FILL) {\n    texWidth = playerWidth;\n    texHeight = playerHeight;\n    translate.set(0, 0);\n  }\n  // + 0 可将 -0 变为 0\n  const uRange = new THREE.Vector2(-translate.x / texWidth + 0, (playerWidth - translate.x) / texWidth);\n  const vRange = new THREE.Vector2(-translate.y / texHeight + 0, (playerHeight - translate.y) / texHeight);\n  return [uRange, vRange];\n}\n\nexport class Shader {\n  static GetVertex() {\n    const vertexTemplate = glsl`\n      varying vec2 texCoords;\n      void main() {\n        texCoords = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    `;\n    return vertexTemplate;\n  }\n\n  static GetFragment() {\n    const fragTemplate = glsl`\n      varying vec2 texCoords;\n      uniform sampler2D tex;\n      void main() {\n        gl_FragColor = texture2D(tex, texCoords);\n      }\n    `;\n    return fragTemplate;\n  }\n\n  static GetEffectFragment({ effect }: EffectProps) {\n    const fragTemplate = glsl`\n      varying vec2 texCoords;\n      uniform vec2 uRange;\n      uniform vec2 vRange;\n      uniform sampler2D tex;\n      ${effect}\n      vec4 getColor(vec2 uv) {\n        vec2 newUV = vec2(uRange.x + uv.x * (uRange.y - uRange.x), vRange.x + uv.y * (vRange.y - vRange.x));\n        vec4 color = effect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      void main() {\n        gl_FragColor = getColor(texCoords);\n      }\n    `;\n    return fragTemplate;\n  }\n\n  static GetTransitionFragment(transition: string) {\n    const fragTemplate = glsl`\n      varying vec2 texCoords;\n      uniform sampler2D from, to;\n      uniform float progress;\n      vec4 getFromColor(vec2 uv) {\n        return texture2D(from, uv);\n      }\n      vec4 getToColor(vec2 uv) {\n        return texture2D(to, uv);\n      }\n      ${transition}\n      void main() {\n        gl_FragColor = transition(texCoords);\n      }\n    `;\n    return fragTemplate;\n  }\n}\n","import { noEffect } from './noEffect';\nimport { gray } from './gray';\nimport { EffectType } from '../../common/types/player';\nimport { ObjectType } from '../../common/types';\nimport { gaussianBlur } from './gaussianBlur';\nimport { ClipBase } from '../clips/base';\nimport * as THREE from 'three';\nimport { triangleBlur } from './triangleBlur';\n\nconst effectMap: ObjectType<(clip: ClipBase) => THREE.Texture | undefined> = {\n  [EffectType.NO_EFFECT]: noEffect,\n  [EffectType.GRAY]: gray,\n  [EffectType.GAUSSIAN_BLUR]: gaussianBlur,\n  [EffectType.TRIANGLE_BLUR]: triangleBlur,\n};\n\nexport default function effects(type?: EffectType) {\n  return effectMap[type || EffectType.NO_EFFECT];\n}\n","import { ClipBase } from '../clips/base';\n\nexport function noEffect(clip: ClipBase) {\n  return clip.texture;\n}","import { glsl } from 'typed-glsl';\nimport { ClipBase } from '../clips/base';\nimport * as THREE from 'three';\nimport { Shader } from '../painter/shader';\n\nexport function gray(clip: ClipBase) {\n  const { originalWidth, originalHeight } = clip.config;\n  const tex = clip.texture;\n  const painter = clip.painter;\n  const buffer = new THREE.WebGLRenderTarget(originalWidth, originalHeight, {\n    depthBuffer: false,\n    stencilBuffer: false,\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n  });\n  const camera = new THREE.OrthographicCamera(originalWidth / - 2, originalWidth / 2, originalHeight / 2, originalHeight / - 2, -10000, 10000);\n  const plane = new THREE.PlaneGeometry(originalWidth, originalHeight);\n  const material = new THREE.ShaderMaterial({\n    uniforms: {\n      tex: { value: tex },\n    },\n    vertexShader: Shader.GetVertex(),\n    fragmentShader: glsl`\n      varying vec2 texCoords;\n      uniform sampler2D tex;\n      void main() {\n        vec4 color = texture2D(tex, texCoords);\n        float gray = (color.r+color.g+color.b)/3.;\n        gl_FragColor = vec4(gray,gray,gray,color.a);\n      }\n    `,\n  });\n  const mesh = new THREE.Mesh(plane, material);\n  const scene = new THREE.Scene();\n  scene.add(mesh);\n  painter.render(buffer, scene, camera);\n  return buffer.texture;\n}\n","import { ClipBase } from '../clips/base';\nimport { glsl } from 'typed-glsl';\nimport * as THREE from 'three';\n\nexport function gaussianBlur(clip: ClipBase): THREE.Texture | undefined {\n  const { originalWidth, originalHeight } = clip.config;\n  const tex = clip.texture;\n  const painter = clip.painter;\n  let writeBuffer = new THREE.WebGLRenderTarget(originalWidth, originalHeight, {\n    depthBuffer: false,\n    stencilBuffer: false,\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n  });\n  let readBuffer = new THREE.WebGLRenderTarget(originalWidth, originalHeight, {\n    depthBuffer: false,\n    stencilBuffer: false,\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n  });\n  const camera = new THREE.OrthographicCamera(originalWidth / - 2, originalWidth / 2, originalHeight / 2, originalHeight / - 2, -10000, 10000);\n  const plane = new THREE.PlaneGeometry(originalWidth, originalHeight);\n  const material = new THREE.ShaderMaterial({\n    uniforms: {\n      iResolution: { value: new THREE.Vector3(originalWidth, originalHeight, 0) },\n      iChannel0: { value: tex },\n      direction: { value: new THREE.Vector2(0, 0) },\n    },\n    vertexShader: glsl`\n      void main() {\n        gl_Position = vec4(position, 1.0);\n      }\n    `,\n    fragmentShader: glsl`\n      uniform vec3 iResolution;\n      uniform sampler2D iChannel0;\n      uniform vec2 direction;\n      vec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n        vec4 color = vec4(0.0);\n        vec2 off1 = vec2(1.411764705882353) * direction;\n        vec2 off2 = vec2(3.2941176470588234) * direction;\n        vec2 off3 = vec2(5.176470588235294) * direction;\n        color += texture2D(image, uv) * 0.1964825501511404;\n        color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n        color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n        color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n        color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n        color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n        color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n        return color;\n      }\n      vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n        vec4 color = vec4(0.0);\n        vec2 off1 = vec2(1.3846153846) * direction;\n        vec2 off2 = vec2(3.2307692308) * direction;\n        color += texture2D(image, uv) * 0.2270270270;\n        color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n        color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n        color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n        color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n        return color;\n      }\n      vec4 blur5(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n        vec4 color = vec4(0.0);\n        vec2 off1 = vec2(1.3333333333333333) * direction;\n        color += texture2D(image, uv) * 0.29411764705882354;\n        color += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;\n        color += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;\n        return color; \n      }\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / iResolution.xy);\n        gl_FragColor = blur13(iChannel0, uv, iResolution.xy, direction);\n      }\n    `,\n  });\n  const mesh = new THREE.Mesh(plane, material);\n  const scene = new THREE.Scene();\n  scene.add(mesh);\n  const anim = 0.5;\n  const iterations = 8;\n  for (let i = 0; i < iterations; i++) {\n    const radius = (iterations - i - 1) * anim;\n    if (i === 0) {\n      material.uniforms.iChannel0.value = tex;\n    } else {\n      material.uniforms.iChannel0.value = readBuffer.texture;\n    }\n    material.uniforms.direction.value = i % 2 === 0 ? new THREE.Vector2(radius, 0) : new THREE.Vector2(0, radius);\n    material.uniformsNeedUpdate = true;\n    painter.render(writeBuffer, scene, camera);\n    const tempBuffer = writeBuffer;\n    writeBuffer = readBuffer;\n    readBuffer = tempBuffer;\n  }\n  return readBuffer.texture;\n}\n","import { ClipBase } from '../clips/base';\nimport { glsl } from 'typed-glsl';\nimport * as THREE from 'three';\nimport { Shader } from '../painter/shader';\n\nexport function triangleBlur(clip: ClipBase): THREE.Texture | undefined {\n  const { originalWidth, originalHeight } = clip.config;\n  const radius = 30;\n  const painter = clip.painter;\n  let writeBuffer = new THREE.WebGLRenderTarget(originalWidth, originalHeight, {\n    depthBuffer: false,\n    stencilBuffer: false,\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n  });\n  let readBuffer = new THREE.WebGLRenderTarget(originalWidth, originalHeight, {\n    depthBuffer: false,\n    stencilBuffer: false,\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n  });\n  const camera = new THREE.OrthographicCamera(originalWidth / - 2, originalWidth / 2, originalHeight / 2, originalHeight / - 2, -10000, 10000);\n  const plane = new THREE.PlaneGeometry(originalWidth, originalHeight);\n  const material = new THREE.ShaderMaterial({\n    uniforms: {\n      tex: { value: clip.texture },\n      delta: { value: new THREE.Vector2(radius / originalWidth, 0) },\n    },\n    vertexShader: Shader.GetVertex(),\n    fragmentShader: glsl`\n      uniform sampler2D tex;\n      uniform vec2 delta;\n      varying vec2 texCoords;\n      float random(vec3 scale, float seed) {\n        /* use the fragment position for a different seed per-pixel */\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n      void main() {\n        vec4 color = vec4(0.0);\n        float total = 0.0;\n        /* randomize the lookup values to hide the fixed number of samples */\n        float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n        for (float t = -30.0; t <= 30.0; t++) {\n            float percent = (t + offset - 0.5) / 30.0;\n            float weight = 1.0 - abs(percent);\n            vec4 texColor = texture2D(tex, texCoords + delta * percent);\n            /* switch to pre-multiplied alpha to correctly blur transparent images */\n            texColor.rgb *= texColor.a;\n            color += texColor * weight;\n            total += weight;\n        }\n        gl_FragColor = color / total;\n        /* switch back from pre-multiplied alpha */\n        gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    `,\n  });\n  material.uniformsNeedUpdate = true;\n  const mesh = new THREE.Mesh(plane, material);\n  const scene = new THREE.Scene();\n  scene.add(mesh);\n  for (let i = 0; i < 2; i++) {\n    if (i === 1) {\n      material.uniforms.tex.value = readBuffer.texture;\n      material.uniforms.delta.value = new THREE.Vector2(0, radius / originalHeight);\n    }\n    painter.render(writeBuffer, scene, camera);\n    const tempBuffer = writeBuffer;\n    writeBuffer = readBuffer;\n    readBuffer = tempBuffer;\n  }\n  return readBuffer.texture;\n}\n","import Player from '..';\nimport * as THREE from 'three';\nimport { Clip } from '../../common/types/clip';\nimport Painter from '../painter';\nimport { removeWatch, watch } from '../../common/utils/watch';\nimport effects from '../effects';\n\nexport abstract class ClipBase<T extends Clip = Clip> {\n  private isAttachToPainter: boolean = false;\n\n  /**\n   * 用于控制clip的事件回调\n   */\n  public isEntered: boolean = false;\n\n  public player: Player;\n  public painter: Painter;\n  public geometry: THREE.PlaneBufferGeometry;\n  public material?: THREE.ShaderMaterial;\n  public sprite?: THREE.Mesh;\n  public config: T;\n  public texture?: THREE.Texture;\n\n  // 单独渲染到纹理使用\n  public renderTarget: THREE.WebGLRenderTarget;\n  public renderTargetCamera: THREE.Camera;\n  public renderTargetScene: THREE.Scene;\n\n  constructor(config: T, player: Player) {\n    this.config = config;\n    this.player = player;\n    this.painter = player.painter;\n    const { width: playerWidth, height: playerHeight } = player;\n\n    this.renderTarget = new THREE.WebGLRenderTarget(player.width, player.height, {\n      depthBuffer: false,\n      stencilBuffer: false,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.LinearFilter,\n    });\n    this.renderTargetCamera = this.painter.createCamera(0, playerWidth, 0, playerHeight);\n    this.renderTargetScene = new THREE.Scene();\n\n    const { width, height } = this.config.geometryInfo.size;\n    this.geometry = new THREE.PlaneBufferGeometry(width, height);\n    this.setSize();\n    this.watch();\n  }\n\n  public updateTexture() {\n    if (this.material) {\n      const effectTex = effects(this.config.effect)(this);\n      this.material.uniforms.tex.value = effectTex;\n    }\n  }\n\n  private setSize() {\n    const { width, height } = this.config.geometryInfo.size;\n    const vertices = new Float32Array([\n      0, 0, 0,\n      width, 0, 0,\n      0, height, 0,\n      width, height, 0,\n    ]);\n    this.geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));\n    this.geometry.center();\n  }\n\n  public updateRotate() {\n    if (this.sprite) {\n      this.sprite.rotation.z = this.config.geometryInfo.rotate / 180 * Math.PI;\n    }\n  }\n\n  public updatePosition() {\n    const { x, y } = this.config.geometryInfo.position;\n    const { width, height } = this.config.geometryInfo.size;\n    if (this.sprite) {\n      this.sprite.position.x = x + width / 2;\n      this.sprite.position.y = y + height / 2;\n    }\n  }\n\n  private watch() {\n    watch(this.config.geometryInfo, 'rotate', () => {\n      this.updateRotate();\n    });\n    watch(this.config.geometryInfo, 'size', () => {\n      this.setSize();\n    });\n    watch(this.config.geometryInfo, 'position', () => {\n      this.updatePosition();\n    });\n    watch(this.config, 'effect', () => {\n      this.updateTexture();\n    });\n    watch(this.config, 'zIndex', (val: number) => {\n      if (this.sprite) {\n        this.sprite.position.z = val;\n      }\n    });\n  }\n\n  public abstract init(): Promise<void>;\n\n  public play() {}\n\n  public pause() {}\n\n  public show() {\n    if (this.sprite) {\n      this.sprite.visible = true;\n    }\n  }\n\n  public hide() {\n    if (this.sprite) {\n      this.sprite.visible = false;\n    }\n  }\n\n  public updatePlaybackRate() {}\n\n  public getOriginalDuration() {\n    return this.config.playRange.end - this.config.playRange.start;\n  }\n\n  public addToPainter() {\n    if (!this.isAttachToPainter && this.sprite && this.config.id) {\n      this.isAttachToPainter = true;\n      this.player.painter.add(this.sprite, this.config.id);\n    }\n  }\n\n  public removeFromPainter() {\n    if (this.isAttachToPainter && this.config.id) {\n      this.isAttachToPainter = false;\n      this.player.painter.remove(this.config.id);\n    }\n  }\n\n  /**\n   * 单独渲染到纹理\n   */\n  public renderToTexture() {\n    if (this.sprite) {\n      this.renderTargetScene.clear();\n      const sprite = this.sprite.clone();\n      sprite.visible = true;\n      this.renderTargetScene.add(sprite);\n      this.painter.render(this.renderTarget, this.renderTargetScene, this.renderTargetCamera);\n    }\n  }\n\n  /**\n   * 首次进入clip时调用，不会继续调用onUpdate\n   */\n  public async onEnter(isManual: boolean) {}\n\n  /**\n   * 离开clip时调用\n   */\n  public async onLeave(isManual: boolean) {}\n\n  /**\n   * 播放器时间改变并且clip在有效范围内调用\n   */\n  public async onUpdate(isManual: boolean) {}\n\n  /**\n   * 销毁函数\n   */\n  public async destroy() {\n    this.renderTargetScene.clear();\n    this.renderTarget.dispose();\n    removeWatch(this.config);\n    this.removeFromPainter();\n  }\n}\n","import { AudioClip } from '../../common/types/clip';\nimport { ClipBase } from './base';\n\nexport class Audio extends ClipBase<AudioClip> {\n  private context = new AudioContext();\n  private audioBuffer?: AudioBuffer;\n  private source?: AudioBufferSourceNode;\n  public playbackRate = 1;\n\n  private isPlaying: boolean = false;\n\n  public async init() {\n    try {\n      this.audioBuffer = await this.getAudioBuffer();\n      this.updatePlaybackRate();\n    } catch (error) {\n      alert(error);\n    }\n  }\n\n  private getAudioBuffer(): Promise<AudioBuffer> {\n    return new Promise((resolve, reject) => {\n      this.context.decodeAudioData(this.config.buffer.slice(0), (buffer) => {\n        if (buffer) {\n          resolve(buffer);\n        } else {\n          reject(false);\n        }\n      }, (error) => {\n        reject(error);\n      });\n    });\n  }\n\n  public play() {\n    if (this.audioBuffer) {\n      const source = this.context.createBufferSource();\n      source.buffer = this.audioBuffer;\n      source.loop = false;\n      source.start(0, (this.config.playRange.start + (this.player.currentTime - this.config.timelineInfo.start) * this.playbackRate) / 1000);\n      this.isPlaying = true;\n      this.source = source;\n      this.source.connect(this.context.destination);\n    }\n  }\n\n  public pause() {\n    if (this.source) {\n      this.source.stop();\n      this.isPlaying = false;\n    }\n  }\n\n  public updatePlaybackRate() {\n    const originalDuration = this.config.playRange.end - this.config.playRange.start;\n    this.playbackRate = originalDuration / this.config.timelineInfo.duration;\n  }\n\n  public async onEnter() {\n    if (this.player.isPlaying) {\n      this.play();\n    }\n  }\n\n  public async onLeave() {\n    if (this.player.isPlaying) {\n      this.pause();\n    }\n  }\n\n  public async onUpdate(isManual: boolean) {\n    if (isManual) {\n      this.pause();\n      if (this.player.isPlaying) {\n        this.play();\n      }\n    }\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.source?.stop();\n  }\n}\n","import { ClipBase } from './base';\nimport { Shader } from '../painter/shader';\nimport { ImageClip } from '../../common/types/clip';\nimport * as THREE from 'three';\n\nexport class Image extends ClipBase<ImageClip> {\n  public async init() {\n    await this.initRender();\n  }\n\n  private createTexture(): Promise<THREE.Texture> {\n    return new Promise((resolve) => {\n      new THREE.TextureLoader().load(this.config.blobUrl, (texture) => {\n        resolve(texture);\n      });\n    });\n  }\n\n  private async initRender() {\n    this.texture = await this.createTexture();\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: this.texture },\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetFragment(),\n    });\n    this.material.uniformsNeedUpdate = true;\n    this.material.transparent = true;\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n    this.sprite.position.z = this.config.zIndex;\n    this.updatePosition();\n    this.updateRotate();\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.texture?.dispose();\n    this.geometry.dispose();\n    this.material?.dispose();\n  }\n}\n","import { ClipBase } from './base';\nimport * as THREE from 'three';\nimport { LottieClip } from '../../common/types/clip';\nimport { AnimationItem } from 'lottie-web';\nimport { getPixelRatio, loadLottie, setStyles } from '../../common/utils';\nimport { Shader } from '../painter/shader';\n\nexport class Lottie extends ClipBase<LottieClip> {\n  private lottieInstance?: AnimationItem;\n  private container: HTMLDivElement = document.createElement('div');\n\n  public async init() {\n    setStyles(this.container, {\n      width: `${this.config.originalWidth * getPixelRatio()}px`,\n      height: `${this.config.originalHeight * getPixelRatio()}px`,\n    });\n    document.body.appendChild(this.container);\n    await this.initLottie();\n    this.initRender();\n  }\n\n  private async initLottie() {\n    this.lottieInstance = await loadLottie(this.container, this.config.animationData);\n  }\n\n  private initRender() {\n    const canvas = this.container.querySelector('canvas');\n    if (this.lottieInstance && canvas) {\n      this.texture = new THREE.CanvasTexture(canvas);\n      this.material = new THREE.ShaderMaterial({\n        uniforms: {\n          tex: { value: this.texture },\n        },\n        vertexShader: Shader.GetVertex(),\n        fragmentShader: Shader.GetFragment(),\n      });\n      this.material.uniformsNeedUpdate = true;\n      this.material.transparent = true;\n      this.sprite = new THREE.Mesh(this.geometry, this.material);\n      this.sprite.position.z = this.config.zIndex;\n      this.updatePosition();\n      this.updateRotate();\n    }\n  }\n\n  public async onUpdate() {\n    if (this.texture && this.lottieInstance) {\n      const { player: { currentTime } } = this;\n      this.lottieInstance.goToAndStop(currentTime - this.config.timelineInfo.start);\n      this.texture.needsUpdate = true;\n      this.updateTexture();\n    }\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.lottieInstance?.destroy();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n}","import { SvgClip } from '../../common/types/clip';\nimport { ClipBase } from './base';\nimport * as THREE from 'three';\nimport { svgToCanvas } from '../../common/utils';\nimport { Shader } from '../painter/shader';\n\nexport class Svg extends ClipBase<SvgClip> {\n  private canvas: HTMLCanvasElement = document.createElement('canvas');\n  private context?: CanvasRenderingContext2D | null;\n\n  public async init() {\n    this.initCanvas();\n    this.initRender();\n  }\n\n  private initCanvas() {\n    const { width, height } = this.painter.getRealSize();\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.context = this.canvas.getContext('2d');\n  }\n\n  private initRender() {\n    this.texture = new THREE.CanvasTexture(this.canvas);\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: this.texture },\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetFragment(),\n    });\n    this.material.uniformsNeedUpdate = true;\n    this.material.transparent = true;\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n    this.sprite.position.z = this.config.zIndex;\n    this.updatePosition();\n    this.updateRotate();\n  }\n\n  public async onUpdate() {\n    if (this.texture) {\n      const { start, end } = this.config.timelineInfo;\n      const { player: { currentTime } } = this;\n      const { width, height } = this.painter.getRealSize();\n      const svg = this.config.func({ start, end, currentTime, width, height });\n      await svgToCanvas(svg, this.canvas, this.context);\n      this.texture.needsUpdate = true;\n      this.updateTexture();\n    }\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n}\n","import { TextClip } from '../../common/types/clip';\nimport { ClipBase } from './base';\nimport * as THREE from 'three';\nimport { svgToCanvas, textClipToSvg } from '../../common/utils';\nimport { Shader } from '../painter/shader';\nimport { watch } from '../../common/utils/watch';\n\nexport class Text extends ClipBase<TextClip> {\n  private canvas: HTMLCanvasElement = document.createElement('canvas');\n  private context?: CanvasRenderingContext2D | null;\n\n  public texture?: THREE.CanvasTexture;\n\n  public async init() {\n    await this.initTexture();\n    this.initRender();\n    this.watchChange();\n  }\n\n  private watchChange() {\n    watch(this.config, 'value', async () => {\n      await this.updateCanvas();\n      this.texture!.needsUpdate = true;\n    });\n  }\n\n  private async updateCanvas() {\n    const { originalWidth, originalHeight } = this.config;\n    this.canvas.width = originalWidth;\n    this.canvas.height = originalHeight;\n    this.context?.clearRect(0, 0, originalWidth, originalHeight);\n    const svg = textClipToSvg(this.config);\n    await svgToCanvas(svg, this.canvas, this.context);\n  }\n\n  private async initTexture() {\n    this.context = this.canvas.getContext('2d');\n    await this.updateCanvas();\n    this.texture = new THREE.CanvasTexture(this.canvas);\n  }\n\n  private initRender() {\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: this.texture },\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetFragment(),\n    });\n    this.material.transparent = true;\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n    this.sprite.position.z = this.config.zIndex;\n    this.updatePosition();\n    this.updateRotate();\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.texture?.dispose();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n}\n","import { morph } from './morph';\nimport { dreamy } from './dreamy';\nimport { fade } from './fade';\nimport { TransitionType } from '../../common/types/player';\nimport { hexagonalize } from './hexagonalize';\nimport { ClipBase } from '../clips/base';\nimport { ObjectType } from '../../common/types';\nimport { glitchMemories } from './glitchMemories';\nimport { perlin } from './perlin';\nimport { crossZoom } from './crossZoom';\n\nconst transitionMap = Object.freeze({\n  [TransitionType.MORPH]: morph,\n  [TransitionType.DREAMY]: dreamy,\n  [TransitionType.FADE]: fade,\n  [TransitionType.HEXAGONALIZE]: hexagonalize,\n  [TransitionType.GLITCH_MEMORIES]: glitchMemories,\n  [TransitionType.PERLIN]: perlin,\n  [TransitionType.CROSS_ZOOM]: crossZoom,\n});\n\nexport default function transitions(type: TransitionType): (clip: ClipBase) => { uniforms: ObjectType, fragment: string } {\n  return transitionMap[type];\n}\n","import { glsl } from 'typed-glsl';\n\nexport function morph() {\n  return {\n    uniforms: {\n      strength: { value: 0.1 }\n    },\n    fragment: glsl`\n      uniform float strength; // = 0.1\n      vec4 transition(vec2 p) {\n        vec4 ca = getFromColor(p);\n        vec4 cb = getToColor(p);\n        \n        vec2 oa = (((ca.rg+ca.b)*0.5)*2.0-1.0);\n        vec2 ob = (((cb.rg+cb.b)*0.5)*2.0-1.0);\n        vec2 oc = mix(oa,ob,0.5)*strength;\n        \n        float w0 = progress;\n        float w1 = 1.0-w0;\n        return mix(getFromColor(p+oc*w0), getToColor(p-oc*w1), progress);\n      }\n    `\n  };\n}\n","import { glsl } from 'typed-glsl';\n\nexport function dreamy() {\n  return {\n    uniforms: {},\n    fragment: glsl`\n      vec2 offset(float progress, float x, float theta) {\n        float phase = progress*progress + progress + theta;\n        float shifty = 0.03*progress*cos(10.0*(progress+x));\n        return vec2(0, shifty);\n      }\n      vec4 transition(vec2 p) {\n        return mix(getFromColor(p + offset(progress, p.x, 0.0)), getToColor(p + offset(1.0-progress, p.x, 3.14)), progress);\n      }\n    `\n  };\n}\n","import { glsl } from 'typed-glsl';\n\nexport function fade() {\n  return {\n    uniforms: {},\n    fragment: glsl`\n      vec4 transition(vec2 uv) {\n        return mix(\n          getFromColor(uv),\n          getToColor(uv),\n          progress\n        );\n      }\n    `\n  };\n}\n","import { glsl } from 'typed-glsl';\nimport { ClipBase } from '../clips/base';\n\nexport function hexagonalize(clip: ClipBase) {\n  return {\n    uniforms: {\n      steps: { value: 50 },\n      horizontalHexagons: { value: 20 },\n      ratio: { value: clip.player.width / clip.player.height },\n    },\n    fragment: glsl`\n      uniform int steps; // = 50;\n      uniform float horizontalHexagons; //= 20;\n      uniform float ratio;\n      struct Hexagon {\n        float q;\n        float r;\n        float s;\n      };\n      \n      Hexagon createHexagon(float q, float r){\n        Hexagon hex;\n        hex.q = q;\n        hex.r = r;\n        hex.s = -q - r;\n        return hex;\n      }\n      \n      Hexagon roundHexagon(Hexagon hex){\n        float q = floor(hex.q + 0.5);\n        float r = floor(hex.r + 0.5);\n        float s = floor(hex.s + 0.5);\n        float deltaQ = abs(q - hex.q);\n        float deltaR = abs(r - hex.r);\n        float deltaS = abs(s - hex.s);\n        if (deltaQ > deltaR && deltaQ > deltaS)\n          q = -r - s;\n        else if (deltaR > deltaS)\n          r = -q - s;\n        else\n          s = -q - r;\n        return createHexagon(q, r);\n      }\n      \n      Hexagon hexagonFromPoint(vec2 point, float size) {\n        point.y /= ratio;\n        point = (point - 0.5) / size;\n        float q = (sqrt(3.0) / 3.0) * point.x + (-1.0 / 3.0) * point.y;\n        float r = 0.0 * point.x + 2.0 / 3.0 * point.y;\n        Hexagon hex = createHexagon(q, r);\n        return roundHexagon(hex);\n      }\n      \n      vec2 pointFromHexagon(Hexagon hex, float size) {\n        float x = (sqrt(3.0) * hex.q + (sqrt(3.0) / 2.0) * hex.r) * size + 0.5;\n        float y = (0.0 * hex.q + (3.0 / 2.0) * hex.r) * size + 0.5;\n        return vec2(x, y * ratio);\n      }\n      \n      vec4 transition (vec2 uv) {\n        float dist = 2.0 * min(progress, 1.0 - progress);\n        dist = steps > 0 ? ceil(dist * float(steps)) / float(steps) : dist;\n        float size = (sqrt(3.0) / 3.0) * dist / horizontalHexagons;\n        vec2 point = dist > 0.0 ? pointFromHexagon(hexagonFromPoint(uv, size), size) : uv;\n        return mix(getFromColor(point), getToColor(point), progress);\n      }\n    `\n  };\n}\n","import { glsl } from 'typed-glsl';\n\nexport function glitchMemories() {\n  return {\n    uniforms: {},\n    fragment: glsl`\n      vec4 transition(vec2 p) {\n        vec2 block = floor(p.xy / vec2(16));\n        vec2 uv_noise = block / vec2(64);\n        uv_noise += floor(vec2(progress) * vec2(1200.0, 3500.0)) / vec2(64);\n        vec2 dist = progress > 0.0 ? (fract(uv_noise) - 0.5) * 0.3 *(1.0 -progress) : vec2(0.0);\n        vec2 red = p + dist * 0.2;\n        vec2 green = p + dist * .3;\n        vec2 blue = p + dist * .5;\n        return vec4(mix(getFromColor(red), getToColor(red), progress).r,mix(getFromColor(green), getToColor(green), progress).g,mix(getFromColor(blue), getToColor(blue), progress).b,1.0);\n      }\n    `\n  };\n}\n","import { glsl } from 'typed-glsl';\n\nexport function perlin() {\n  return {\n    uniforms: {\n      scale: { value: 4 },\n      smoothness: { value: 0.01 },\n      seed: { value: 12.9898 },\n    },\n    fragment: glsl`\n      uniform float scale; // = 4.0\n      uniform float smoothness; // = 0.01\n      \n      uniform float seed; // = 12.9898\n      \n      // http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\n      float random(vec2 co)\n      {\n          float a = seed;\n          float b = 78.233;\n          float c = 43758.5453;\n          float dt= dot(co.xy ,vec2(a,b));\n          float sn= mod(dt,3.14);\n          return fract(sin(sn) * c);\n      }\n      \n      // 2D Noise based on Morgan McGuire @morgan3d\n      // https://www.shadertoy.com/view/4dS3Wd\n      float noise (in vec2 st) {\n          vec2 i = floor(st);\n          vec2 f = fract(st);\n      \n          // Four corners in 2D of a tile\n          float a = random(i);\n          float b = random(i + vec2(1.0, 0.0));\n          float c = random(i + vec2(0.0, 1.0));\n          float d = random(i + vec2(1.0, 1.0));\n      \n          // Smooth Interpolation\n      \n          // Cubic Hermine Curve.  Same as SmoothStep()\n          vec2 u = f*f*(3.0-2.0*f);\n          // u = smoothstep(0.,1.,f);\n      \n          // Mix 4 coorners porcentages\n          return mix(a, b, u.x) +\n                  (c - a)* u.y * (1.0 - u.x) +\n                  (d - b) * u.x * u.y;\n      }\n      \n      vec4 transition (vec2 uv) {\n        vec4 from = getFromColor(uv);\n        vec4 to = getToColor(uv);\n        float n = noise(uv * scale);\n      \n        float p = mix(-smoothness, 1.0 + smoothness, progress);\n        float lower = p - smoothness;\n        float higher = p + smoothness;\n      \n        float q = smoothstep(lower, higher, n);\n      \n        return mix(\n          from,\n          to,\n          1.0 - q\n        );\n      }\n    `\n  };\n}\n","import { glsl } from 'typed-glsl';\n\nexport function crossZoom() {\n  return {\n    uniforms: {\n      strength: { value: 0.4 },\n    },\n    fragment: glsl`\n      uniform float strength; // = 0.4\n\n      const float PI = 3.141592653589793;\n      \n      float Linear_ease(in float begin, in float change, in float duration, in float time) {\n          return change * time / duration + begin;\n      }\n      \n      float Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {\n          if (time == 0.0)\n              return begin;\n          else if (time == duration)\n              return begin + change;\n          time = time / (duration / 2.0);\n          if (time < 1.0)\n              return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;\n          return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;\n      }\n      \n      float Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {\n          return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;\n      }\n      \n      float rand (vec2 co) {\n        return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n      }\n      \n      vec3 crossFade(in vec2 uv, in float dissolve) {\n          return mix(getFromColor(uv).rgb, getToColor(uv).rgb, dissolve);\n      }\n      \n      vec4 transition(vec2 uv) {\n          vec2 texCoord = uv.xy / vec2(1.0).xy;\n      \n          // Linear interpolate center across center half of the image\n          vec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);\n          float dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);\n      \n          // Mirrored sinusoidal loop. 0->strength then strength->0\n          float strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);\n      \n          vec3 color = vec3(0.0);\n          float total = 0.0;\n          vec2 toCenter = center - texCoord;\n      \n          /* randomize the lookup values to hide the fixed number of samples */\n          float offset = rand(uv);\n      \n          for (float t = 0.0; t <= 40.0; t++) {\n              float percent = (t + offset) / 40.0;\n              float weight = 4.0 * (percent - percent * percent);\n              color += crossFade(texCoord + toCenter * percent * strength, dissolve) * weight;\n              total += weight;\n          }\n          return vec4(color / total, 1.0);\n      }\n    `\n  };\n}\n","import { Shader } from '../painter/shader';\nimport transitions from '../transitions';\nimport { ClipBase } from './base';\nimport { TransitionClip } from '../../common/types/clip';\nimport * as THREE from 'three';\nimport { watch } from '../../common/utils/watch';\n\nexport class Transition extends ClipBase<TransitionClip> {\n  private fromClip?: ClipBase;\n  private toClip?: ClipBase;\n\n  public async init() {\n    await this.initRender();\n    this.watchChange();\n  }\n\n  private watchChange() {\n    if (this.fromClip && this.toClip) {\n      watch(this.fromClip.config, 'effect', () => {\n        this.updateFromClipTexture();\n      });\n      watch(this.fromClip.config.geometryInfo, 'size', () => {\n        this.updateFromClipTexture();\n      });\n      watch(this.fromClip.config.geometryInfo, 'position', () => {\n        this.updateFromClipTexture();\n      });\n      watch(this.fromClip.config.geometryInfo, 'rotate', () => {\n        this.updateFromClipTexture();\n      });\n      watch(this.toClip.config, 'effect', () => {\n        this.updateToClipTexture();\n      });\n      watch(this.toClip.config.geometryInfo, 'size', () => {\n        this.updateToClipTexture();\n      });\n      watch(this.toClip.config.geometryInfo, 'position', () => {\n        this.updateToClipTexture();\n      });\n      watch(this.toClip.config.geometryInfo, 'rotate', () => {\n        this.updateToClipTexture();\n      });\n    }\n  }\n\n  private updateFromClipTexture() {\n    if (this.fromClip && this.material) {\n      this.fromClip.renderToTexture();\n      this.material.uniforms.from.value = this.fromClip.renderTarget.texture;\n    }\n  }\n\n  private updateToClipTexture() {\n    if (this.toClip && this.material) {\n      this.toClip.renderToTexture();\n      this.material.uniforms.to.value = this.toClip.renderTarget.texture;\n    }\n  }\n\n  // 由于不知道关联视频或者图片的初始状态，所以需要等到渲染的时候再初始化\n  private async initRender() {\n    const { player } = this;\n    const { fromId, toId, transition } = this.config;\n    const fromClip = this.fromClip = player.getClipById(fromId);\n    const toClip = this.toClip = player.getClipById(toId);\n    if (fromClip && toClip) {\n      fromClip.renderToTexture();\n      toClip.renderToTexture();\n      const { uniforms: transitionUniforms, fragment: transitionFragment } = transitions(transition)(this);\n      this.material = new THREE.ShaderMaterial({\n        uniforms: {\n          from: { value: fromClip.renderTarget.texture },\n          to: { value: toClip.renderTarget.texture },\n          progress: { value: 0 },\n          ...transitionUniforms,\n        },\n        vertexShader: Shader.GetVertex(),\n        fragmentShader: Shader.GetTransitionFragment(transitionFragment),\n      });\n      this.material.uniformsNeedUpdate = true;\n      this.material.transparent = true;\n      this.sprite = new THREE.Mesh(this.geometry, this.material);\n      this.sprite.position.z = toClip.config.zIndex;\n      this.updatePosition();\n    }\n  }\n\n  public async onEnter() {\n    if (this.fromClip && this.toClip) {\n      this.fromClip.hide();\n      this.toClip.hide();\n      this.onUpdate();\n    }\n  }\n\n  public async onLeave() {\n    if (this.fromClip && this.toClip) {\n      this.fromClip.show();\n      this.toClip.show();\n    }\n  }\n\n  public async onUpdate() {\n    if (this.material?.uniforms) {\n      const { start, end } = this.config.timelineInfo;\n      const progress = (this.player.currentTime - start) / (end - start);\n      this.material.uniforms.progress.value = progress;\n    }\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.texture?.dispose();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n }\n","import { ClipBase } from './base';\nimport { Shader } from '../painter/shader';\nimport * as THREE from 'three';\nimport { VideoClip } from '../../common/types/clip';\n\nexport class Video extends ClipBase<VideoClip> {\n  public texture?: THREE.VideoTexture;\n  private video?: HTMLVideoElement;\n  public playbackRate = 1;\n  private isPlaying = false;\n\n  public async init() {\n    await this.initRender();\n    this.updatePlaybackRate();\n  }\n\n  private createTexture(): Promise<THREE.VideoTexture> {\n    return new Promise(async (resolve, reject) => {\n      this.video = document.createElement('video');\n      this.video.loop = false;\n      this.video.autoplay = false;\n      this.video.addEventListener('loadedmetadata', async () => {\n        if (this.video) {\n          const texture = new THREE.VideoTexture(this.video);\n          // @ts-ignore\n          await texture.setCurrentTime(this.config.playRange.start);\n          texture.onUpdate = this.updateTexture;\n          resolve(texture);\n        }\n      });\n      this.video.src = this.config.blobUrl;\n    });\n  }\n\n  private async initRender() {\n    this.texture = await this.createTexture();\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: this.texture },\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetFragment(),\n    });\n    this.material.uniformsNeedUpdate = true;\n    this.material.transparent = true;\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n    this.sprite.position.z = this.config.zIndex;\n    this.updatePosition();\n    this.updateRotate();\n  }\n\n  public play() {\n    this.video?.play();\n    this.isPlaying = true;\n  }\n\n  public pause() {\n    this.video?.pause();\n    this.isPlaying = false;\n  }\n\n  public updatePlaybackRate() {\n    const originalDuration = this.config.playRange.end - this.config.playRange.start;\n    this.playbackRate = originalDuration / this.config.timelineInfo.duration;\n  }\n\n  // 根据player的currentTime校正video的currentTime\n  private async correctVideoCurrentTime() {\n    const currentTime = this.player.currentTime;\n    if (this.video && Math.abs(this.video.playbackRate - this.playbackRate) >= 10e-6) {\n      this.video.playbackRate = this.playbackRate;\n    }\n    const newCurrentTime = this.config.playRange.start + (currentTime - this.config.timelineInfo.start) * this.playbackRate;\n    // @ts-ignore\n    await this.texture.setCurrentTime(newCurrentTime);\n  }\n\n  public async onEnter() {\n    // await this.correctVideoCurrentTime();\n    if (this.player.isPlaying) {\n      this.play();\n    }\n  }\n\n  public async onLeave() {\n    this.pause();\n    if (this.texture) {\n      // @ts-ignore\n      await this.texture.setCurrentTime(this.config.playRange.start);\n    }\n  }\n\n  public async onUpdate(isManual: boolean) {\n    if (isManual) {\n      await this.correctVideoCurrentTime();\n    }\n    this.updateTexture();\n  }\n\n  public async destroy() {\n    super.destroy();\n    if (this.video) {\n      this.video = undefined;\n    }\n    this.texture?.dispose();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n}\n","interface AsyncQueueItem {\n  action: (...args: any[]) => Promise<any>;\n  resolve: (value: unknown) => void;\n  reject: (reason?: any) => void;\n}\n\nexport class Queue<T> {\n  private items: T[] = [];\n  public enqueue(item: T) {\n    this.items.push(item);\n  }\n  public dequeue() {\n    return this.items.shift();\n  }\n  public get size() {\n    return this.items.length;\n  }\n}\n\nexport class AsyncAutoQueue {\n  private items: AsyncQueueItem[] = [];\n  private pendingPromise: boolean = false;\n\n  public enqueue<T>(action: () => Promise<T>) {\n    return new Promise((resolve, reject) => {\n      this.items.push({ action, resolve, reject });\n      if (!this.pendingPromise) {\n        this.dequeue();\n      }\n    }).then((result) => {\n      return result;\n    }).catch((error) => {\n      throw new Error(error);\n    }).finally(() => {\n      this.pendingPromise = false;\n      this.dequeue();\n    });\n  }\n\n  public async dequeue() {\n    const item = this.items.shift();\n    if (!item) {\n      return false;\n    }\n    try {\n      this.pendingPromise = true;\n      const payload = await item.action();\n      item.resolve(payload);\n    } catch (e) {\n      item.reject(e);\n    }\n    return true;\n  }\n}\n","export function extractDuration(field: string) {\n  try {\n    const duration = field.split(',')[0].replace('Duration:', '');\n    return duration.trim();\n  } catch {\n    return '';\n  }\n}\n\nexport function extractVideoInfo(field: string) {\n  try {\n    const infoItems = field.split('Video:')[1].replace(/\\(.*?\\)/gi, '').split(',');\n    const resolution = infoItems[2].split('x');\n    return {\n      codec: infoItems[0].trim(),\n      colorSpace: infoItems[1].trim(),\n      resolution: {\n        width: parseInt(resolution[0].trim()),\n        height: parseInt(resolution[1].trim()),\n      },\n      fps: parseInt(infoItems[4].replace('fps', '').trim()),\n    };\n  } catch {\n    return {};\n  }\n}\n\nexport function extractAudioInfo(field: string) {\n  try {\n    const infoItems = field.split('Audio:')[1].replace(/\\(.*?\\)/gi, '').split(',');\n    return {\n      codec: infoItems[0].trim(),\n      Hz: parseInt(infoItems[1].replace('Hz', '').trim()),\n    };\n  } catch {\n    return {};\n  }\n}\n\nexport function getAudioTempoChain(tempo: number): string {\n  if (Math.abs(tempo - 1) <= 10e-6) {\n    return '';\n  }\n  if (tempo >= 0.5 && tempo <= 2.0) {\n    return `,atempo=${tempo}`;\n  }\n  if (tempo > 0 && tempo < 0.5) {\n    let start = 0.5;\n    let result = `,atempo=0.5`;\n    while (start > tempo) {\n      start *= 0.5;\n      result += `,atempo=0.5`;\n    }\n    if (Math.abs(start - tempo) > 10e-6) {\n      result += `,atempo=${(tempo / start).toFixed(2)}`;\n    }\n    return result;\n  }\n  if (tempo > 2.0) {\n    let start = 2.0;\n    let result = `,atempo=2.0`;\n    while (start < tempo) {\n      start *= 2.0;\n      result += `,atempo=2.0`;\n    }\n    if (Math.abs(start - tempo) > 10e-6) {\n      result += `,atempo=${(start / tempo).toFixed(2)}`;\n    }\n    return result;\n  }\n  return '';\n}\n","import { createFFmpeg, FFmpeg } from '@ffmpeg/ffmpeg';\nimport { v4 } from 'uuid';\nimport { AsyncAutoQueue } from '../common/libs/queue';\nimport { MediaInfo } from '../common/types';\nimport { AudioMergeItem } from '../common/types/clip';\nimport { extractAudioInfo, extractDuration, extractVideoInfo, getAudioTempoChain } from './util';\n\nclass FFmpegHelperClass {\n  public static ffmpeg: FFmpeg;\n\n  public static async Load() {\n    if (!FFmpegHelper.ffmpeg.isLoaded()) {\n      await FFmpegHelper.ffmpeg.load();\n    }\n  }\n\n  public static async GetVersion() {\n    await FFmpegHelper.ffmpeg.run('-version');\n  }\n\n  public static async VideoTranscode(buffer: ArrayBuffer, codec = 'h264') {\n    const ffmpeg = FFmpegHelperClass.ffmpeg;\n    const inputFileName = `${v4()}`;\n    const outputFileName = `${v4()}.mp4`;\n    // 写入文件\n    ffmpeg.FS('writeFile', inputFileName, new Uint8Array(buffer));\n    // 执行命令\n    await ffmpeg.run('-i', inputFileName, '-c:v', codec, '-c:a', 'aac', outputFileName);\n    // 读取生成的文件\n    const video = ffmpeg.FS('readFile', outputFileName);\n    // 删除写入的文件\n    ffmpeg.FS('unlink', inputFileName);\n    ffmpeg.FS('unlink', outputFileName);\n    return video.buffer;\n  }\n\n  public static async GetMediaInfo(buffer: ArrayBuffer) {\n    const ffmpeg = FFmpegHelperClass.ffmpeg;\n    const inputFileName = `${v4()}`;\n    const mediaInfo: MediaInfo = {};\n    ffmpeg.setLogger(({ type, message }) => {\n      if (type === 'fferr') {\n        if (message.includes('Duration')) {\n          mediaInfo.duration = extractDuration(message);\n        } else if (message.includes('Stream #0')) { // 视频流或者音频流\n          if (message.includes('Video:')) {\n            mediaInfo.video = extractVideoInfo(message);\n          } else if (message.includes('Audio:')) {\n            mediaInfo.audio = extractAudioInfo(message);\n          }\n        }\n      }\n    });\n    // 写入文件\n    ffmpeg.FS('writeFile', inputFileName, new Uint8Array(buffer));\n    // 执行命令\n    await ffmpeg.run('-i', inputFileName);\n    // 删除写入的文件\n    ffmpeg.FS('unlink', inputFileName);\n    return mediaInfo;\n  }\n\n  public static async MergeAudios(items: AudioMergeItem[]) {\n    const ffmpeg = FFmpegHelperClass.ffmpeg;\n    const outputFileName = `${v4()}.aac`;\n    const inputFileName = v4();\n    const inputs = items.map((item, index) => {\n      return ['-i', `${inputFileName}_${index}`, '-ss', `${item.from / 1000}`, '-to', `${(item.to - item.from) / 1000}`];\n    }).flat(1);\n    const filters = items.map((item, index) => {\n      const delay = item.delay / 1000;\n      return `[${index}:a]adelay=${delay}|${delay}|${delay}|${delay}${getAudioTempoChain(item.tempo)}[a${index}];`;\n    }).join('');\n    const amixPrefix = items.map((item, index) => {\n      return `[a${index}]`;\n    }).join('');\n    // 写入文件\n    items.forEach((item, index) => {\n      ffmpeg.FS('writeFile', `${inputFileName}_${index}`, new Uint8Array(item.buffer));\n    });\n    // 执行命令\n    await ffmpeg.run(\n      ...inputs,\n      '-filter_complex',\n      `${filters}${amixPrefix}amix=inputs=${items.length}:duration=first:dropout_transition=0,dynaudnorm[aout]`,\n      '-map', '[aout]',\n      outputFileName\n    );\n    // 读取生成的文件\n    const audio = ffmpeg.FS('readFile', outputFileName);\n    // 删除写入的文件\n    items.forEach((item, index) => {\n      ffmpeg.FS('unlink', `${inputFileName}_${index}`);\n    });\n    ffmpeg.FS('unlink', outputFileName);\n    return audio.buffer;\n  }\n  \n  public static async ImagesToVideo(frames: ArrayBuffer[], fps: number = 30) {\n    const padNum = 6;\n    const ffmpeg = FFmpegHelperClass.ffmpeg;\n    const outputFileName = `${v4()}.mp4`;\n    // 写入文件\n    frames.forEach((item, index) => {\n      ffmpeg.FS('writeFile', `export_${index.toString().padStart(padNum, '0')}.jpg`, new Uint8Array(item));\n    });\n    // 执行命令\n    await ffmpeg.run(\n      '-framerate', `${fps}`,\n      '-i', `export_%0${padNum}d.jpg`,\n      '-c:v', 'libx264',\n      '-pix_fmt', 'yuv420p',\n      '-preset', 'ultrafast',\n      '-crf', '24',\n      outputFileName\n    );\n    // 读取生成的文件\n    const video = ffmpeg.FS('readFile', outputFileName);\n    // 删除写入的文件\n    frames.forEach((item, index) => {\n      ffmpeg.FS('unlink', `export_${index.toString().padStart(padNum, '0')}.jpg`);\n    });\n    ffmpeg.FS('unlink', outputFileName);\n    return video.buffer;\n  }\n  \n  public static async MergeVideoAudio(videoBuffer: ArrayBufferLike, audioBuffer: ArrayBufferLike) {\n    const ffmpeg = FFmpegHelperClass.ffmpeg;\n    const videoFileName = `${v4()}.mp4`;\n    const audioFileName = `${v4()}.aac`;\n    const outputFileName = `${v4()}.mp4`;\n    // 写入文件\n    ffmpeg.FS('writeFile', videoFileName, new Uint8Array(videoBuffer));\n    ffmpeg.FS('writeFile', audioFileName, new Uint8Array(audioBuffer));\n    // 执行命令\n    await ffmpeg.run(\n      '-i', videoFileName,\n      '-i', audioFileName,\n      '-c', 'copy',\n      outputFileName\n    );\n    // 读取生成的文件\n    const finalVideo = ffmpeg.FS('readFile', outputFileName);\n    // 删除写入的文件\n    ffmpeg.FS('unlink', videoFileName);\n    ffmpeg.FS('unlink', audioFileName);\n    ffmpeg.FS('unlink', outputFileName);\n    return finalVideo.buffer;\n  }\n}\n\nFFmpegHelperClass.ffmpeg = createFFmpeg({ log: true });\n\nconst asyncQueue = new AsyncAutoQueue();\n\nconst FFmpegHelper = new Proxy(FFmpegHelperClass, {\n  get(target, prop: keyof FFmpegHelperClass) {\n    const result = prop in target ? target[prop] : undefined;\n    if (typeof result === 'function') {\n      return async function(...args: any[]) {\n        return asyncQueue.enqueue(async () => {\n          await FFmpegHelperClass.Load();\n          return await (result as unknown as Function).apply(target, args);\n        });\n      }\n    }\n    return result;\n  }\n});\n\nexport default FFmpegHelper;\n","import { GifClip } from '../../common/types/clip';\nimport { ClipBase } from './base';\nimport * as THREE from 'three';\nimport { Shader } from '../painter/shader';\n\nexport class Gif extends ClipBase<GifClip> {\n  private playbackRate = 1;\n  private textureData?: Uint8ClampedArray;\n\n  public texture?: THREE.DataTexture;\n\n  public async init() {\n    this.initRender();\n  }\n\n  private createTexture(data: Uint8ClampedArray, width: number, height: number): THREE.DataTexture {\n    this.textureData = new Uint8ClampedArray(data);\n    const texture = new THREE.DataTexture(this.textureData, width, height, THREE.RGBAFormat);\n    texture.flipY = true;\n    return texture;\n  }\n\n  private initRender() {\n    const {\n      originalWidth,\n      originalHeight,\n      frames,\n    } = this.config;\n    this.texture = this.createTexture(frames[0].data.data, originalWidth, originalHeight);\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: this.texture },\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetFragment(),\n    });\n    this.material.transparent = true;\n    this.material.uniformsNeedUpdate = true;\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n    this.sprite.position.z = this.config.zIndex;\n    this.updatePosition();\n    this.updateRotate();\n  }\n\n  private getFrame() {\n    const {\n      playRange,\n      frames,\n      timelineInfo,\n    } = this.config;\n    const currentTime = playRange.start + (this.player.currentTime - timelineInfo.start) * this.playbackRate;\n    let sumFrameDelay = 0;\n    for (let i = 0; i < frames.length; i++) {\n      const frame = frames[i];\n      sumFrameDelay += frame.delay;\n      if (currentTime <= sumFrameDelay) {\n        return frame;\n      }\n    }\n  }\n\n  public updatePlaybackRate() {\n    const originalDuration = this.config.playRange.end - this.config.playRange.start;\n    this.playbackRate = originalDuration / this.config.timelineInfo.duration;\n  }\n\n  public async onUpdate() {\n    const frame = this.getFrame();\n    if (frame && this.texture && this.textureData) {\n      this.textureData.set(frame.data.data);\n      this.texture.needsUpdate = true;\n    }\n    this.updateTexture();\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.texture?.dispose();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n}\n","import { ClipBase } from './base';\nimport * as THREE from 'three';\nimport { PagClip } from '../../common/types/clip';\nimport { Shader } from '../painter/shader';\nimport { PAGView } from 'libpag/types/pag-view';\nimport { getPixelRatio, setStyles } from '../../common/utils';\n\nexport class Pag extends ClipBase<PagClip> {\n  private canvas: HTMLCanvasElement = document.createElement('canvas');\n  private pagView?: PAGView;\n\n  public async init() {\n    await this.initPagView();\n    this.initRender();\n  }\n\n  private async initPagView() {\n    setStyles(this.canvas, {\n      width: `${this.config.originalWidth * getPixelRatio()}px`,\n      height: `${this.config.originalHeight * getPixelRatio()}px`,\n    });\n    this.pagView = await this.config.pag.PAGView.init(this.config.pagFile, this.canvas);\n  }\n\n  private initRender() {\n    if (this.pagView && this.canvas) {\n      this.texture = new THREE.CanvasTexture(this.canvas);\n      this.material = new THREE.ShaderMaterial({\n        uniforms: {\n          tex: { value: this.texture },\n        },\n        vertexShader: Shader.GetVertex(),\n        fragmentShader: Shader.GetFragment(),\n      });\n      this.material.uniformsNeedUpdate = true;\n      this.material.transparent = true;\n      this.sprite = new THREE.Mesh(this.geometry, this.material);\n      this.sprite.position.z = this.config.zIndex;\n      this.updatePosition();\n      this.updateRotate();\n    }\n  }\n\n  public async onUpdate() {\n    if (this.texture && this.pagView) {\n      const { player: { currentTime }, config } = this;\n      const progress = (currentTime - config.timelineInfo.start) / (config.playRange.end - config.playRange.start);\n      await this.pagView.setProgress(progress);\n      this.texture.needsUpdate = true;\n      this.updateTexture();\n    }\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.pagView?.destroy();\n    this.geometry?.dispose();\n    this.material?.dispose();\n  }\n}","import * as THREE from 'three';\nimport { GLTF } from 'three/examples/jsm/loaders/GLTFLoader';\nimport Painter from '.';\n\nexport default class ModelHelper {\n  // 动作相关属性\n  private actions: THREE.AnimationAction[] = [];\n  private duration: number = 0;\n  private mixer?: THREE.AnimationMixer;\n\n  // 基础属性\n  private modelData: GLTF;\n  private width: number;\n  private height: number;\n\n  // 渲染相关\n  private frameBuffer: THREE.WebGLRenderTarget;\n  private scene = new THREE.Scene();\n  private camera: THREE.PerspectiveCamera;\n  private painter: Painter;\n\n  // 播放相关\n  private playing: boolean = false;\n\n  constructor(width: number, height: number, modelData: GLTF, painter: Painter) {\n    this.width = width * 2;\n    this.height = height * 2;\n    this.modelData = modelData;\n    this.painter = painter;\n    this.frameBuffer = new THREE.WebGLRenderTarget(this.width, this.height, {\n      depthBuffer: true,\n      stencilBuffer: false,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.LinearFilter,\n    });\n    this.camera = new THREE.PerspectiveCamera(45, this.width / this.height, 1, 1000);\n    this.camera.position.set(0, 1, 5.5);\n    // this.camera.lookAt(0, 1, 0);\n\n    this.initScene();\n    this.initAnimationMixer();\n    this.update(0);\n  }\n\n  private initScene() {\n    const hemisphereLight = new THREE.HemisphereLight(0xffffff, 0x444444);\n    hemisphereLight.position.set(0, 20, 0);\n    this.scene.add(hemisphereLight);\n\n    const dirLight = new THREE.DirectionalLight(0xffffff);\n    dirLight.position.set(-3, 10, -10);\n    dirLight.castShadow = true;\n    dirLight.shadow.camera.top = 2;\n    dirLight.shadow.camera.bottom = -2;\n    dirLight.shadow.camera.left = -2;\n    dirLight.shadow.camera.right = 2;\n    dirLight.shadow.camera.near = 0.1;\n    dirLight.shadow.camera.far = 40;\n    this.scene.add(dirLight);\n\n    const model = this.modelData.scene;\n    this.scene.add(model);\n\n    model.traverse((object) => {\n      if (object.isObject3D) {\n        object.castShadow = true;\n        object.receiveShadow = true;\n      }\n    });\n\n    const skeleton = new THREE.SkeletonHelper(model);\n    skeleton.visible = false;\n    this.scene.add(skeleton);\n  }\n\n  public initAnimationMixer() {\n    const animations = this.modelData.animations;\n    this.mixer = new THREE.AnimationMixer(this.modelData.scene);\n    \n    // 初始化一组动作\n    const defaultAction = this.mixer.clipAction(animations[0]);\n    // const walkAction = this.mixer.clipAction(animations[3]);\n    // const runAction = this.mixer.clipAction(animations[1]);\n    this.setActions([defaultAction]);\n    this.activate();\n  }\n\n  // TODO:\n  public setActions(actions: THREE.AnimationAction[]) {\n    this.actions = actions;\n    this.duration = actions.reduce((previousValue, currentValue) => {\n      return previousValue + currentValue.getClip().duration * 1000;\n  }, 0);\n  }\n\n  public activate() {\n    this.actions.forEach((action) => {\n      action.play();\n    });\n  }\n\n  public deactivate() {\n    this.actions.forEach((action) => {\n      action.stop();\n    });\n  }\n\n  public play() {\n    if (!this.playing) {\n      this.actions.forEach((action) => {\n        action.paused = false;\n      });\n    }\n  }\n\n  public pause() {\n    if (this.playing) {\n      this.actions.forEach((action) => {\n        action.paused = true;\n      });\n    }\n  }\n\n  public update(currentTime: number) {\n    this.mixer?.setTime(currentTime / 1000);\n    this.painter.render(this.frameBuffer, this.scene, this.camera);\n  }\n\n  public getTexture() {\n    return this.frameBuffer.texture;\n  }\n\n  public destroy() {\n    \n  }\n}\n","import * as THREE from 'three';\nimport { GLTFClip } from '../../common/types/clip';\nimport ModelHelper from '../painter/modelHelper';\nimport { ClipBase } from './base';\n\nexport class GLTF extends ClipBase<GLTFClip> {\n  private modelMaterial?: THREE.MeshBasicMaterial;\n  private modelHelper?: ModelHelper;\n\n  public async init() {\n    this.modelHelper = new ModelHelper(\n      this.config.originalWidth,\n      this.config.originalHeight,\n      this.config.modelData,\n      this.painter,\n    );\n    this.initRender();\n  }\n\n  private async initRender() {\n    this.texture = this.modelHelper?.getTexture();\n    this.modelMaterial = new THREE.MeshBasicMaterial({\n      map: this.texture,\n    });\n    this.modelMaterial.transparent = true;\n    this.sprite = new THREE.Mesh(this.geometry, this.modelMaterial);\n    this.sprite.position.z = this.config.zIndex;\n    this.updatePosition();\n    this.updateRotate();\n  }\n\n  public play() {\n    this.modelHelper?.play();\n  }\n\n  public pause(): void {\n    this.modelHelper?.pause();\n  }\n\n  public async onUpdate() {\n    if (this.modelHelper) {\n      this.modelHelper.update(this.player.currentTime - this.config.timelineInfo.start);\n      this.texture = this.modelHelper.getTexture();\n      this.updateTexture();\n    }\n  }\n\n  public async destroy() {\n    super.destroy();\n    this.modelHelper?.destroy();\n    this.texture?.dispose();\n    this.geometry.dispose();\n    this.modelMaterial?.dispose();\n  }\n}\n","import {\n  AudioClip,\n  AudioMergeItem,\n  Clip,\n  ClipType,\n  GifClip,\n  GLTFClip,\n  ImageClip,\n  LottieClip,\n  PagClip,\n  SvgClip,\n  TextClip,\n  TransitionClip,\n  VideoClip,\n} from '../common/types/clip';\nimport { downloadFile, sleep } from '../common/utils';\nimport { Audio } from './clips/audio';\nimport { Image } from './clips/image';\nimport { Lottie } from './clips/lottie';\nimport { Svg } from './clips/svg';\nimport { Text } from './clips/text';\nimport { Transition } from './clips/transition';\nimport { Video } from './clips/video';\nimport Player from '.';\nimport FFmpegHelper from '../ffmpeg';\nimport { Gif } from './clips/gif';\nimport { FitType } from '../common/types/player';\nimport { ParsedFrame, ParsedGif } from 'gifuct-js';\nimport { Pag } from './clips/pag';\nimport { GLTF } from './clips/gltf';\n\nexport function createClip(config: Clip, player: Player) {\n  switch (config.type) {\n    case ClipType.VIDEO:\n      return new Video(config as VideoClip, player);\n    case ClipType.IMAGE:\n      return new Image(config as ImageClip, player);\n    case ClipType.TRANSITION:\n      return new Transition(config as TransitionClip, player);\n    case ClipType.TEXT:\n      return new Text(config as TextClip, player);\n    case ClipType.AUDIO:\n      return new Audio(config as AudioClip, player);\n    case ClipType.SVG:\n      return new Svg(config as SvgClip, player);\n    case ClipType.LOTTIE:\n      return new Lottie(config as LottieClip, player);\n    case ClipType.GIF:\n      return new Gif(config as GifClip, player);\n    case ClipType.PAG:\n      return new Pag(config as PagClip, player);\n    case ClipType.GLTF:\n      return new GLTF(config as GLTFClip, player);\n  }\n}\n\nexport function canvasToArrayBuffer(canvas: HTMLCanvasElement) {\n  return new Promise<ArrayBuffer>((resolve) => {\n    canvas.toBlob(async (blob) => {\n      if (blob) {\n        const arrayBuffer = await blob.arrayBuffer();\n        resolve(arrayBuffer);\n      }\n    }, 'image/jpeg', 1.0);\n  });\n}\n\nasync function snap(\n  player: Player,\n  interval: number,\n  currentTime: number,\n  frames: ArrayBuffer[],\n) {\n  await player.setCurrentTime(currentTime);\n  const imageData = await canvasToArrayBuffer(player.painter.getDomElement());\n  frames.push(imageData);\n  currentTime += interval;\n  if (currentTime <= player.duration) {\n    await snap(player, interval, currentTime, frames);\n  }\n}\n\nasync function generateVideo(player: Player, fps: number) {\n  const interval = Math.round(1000 / fps);\n  const frames: ArrayBuffer[] = [];\n  await snap(player, interval, 0, frames);\n  if (player.duration % interval !== 0) {\n    player.setCurrentTime(player.duration);\n    const imageData = await canvasToArrayBuffer(player.painter.getDomElement());\n    frames.push(imageData);\n  }\n  const data = await FFmpegHelper.ImagesToVideo(frames, fps);\n  frames.length = 0; // 清空图片\n  return data;\n}\n\nfunction getAudioMergeItemFromPlayer(player: Player) {\n  const result: AudioMergeItem[] = [];\n  player.clips.forEach((clip) => {\n    if ([ClipType.AUDIO, ClipType.VIDEO].includes(clip.config.type)) {\n      result.push({\n        delay: clip.config.timelineInfo.start,\n        from: 0,\n        to: (clip as Video).getOriginalDuration(),\n        tempo: (clip as Video).playbackRate,\n        type: clip.config.type,\n        buffer: (clip as Video).config.buffer.slice(0),\n      });\n    }\n  });\n  return result;\n}\n\nasync function generateAudio(player: Player) {\n  const audioMergeItems = getAudioMergeItemFromPlayer(player);\n  if (audioMergeItems.length) {\n    return await FFmpegHelper.MergeAudios(audioMergeItems);\n  }\n  return;\n}\n\n/**\n * 将player导出为h264视频文件\n */\nexport async function exportAsVideo(player: Player, fileName = 'export.mp4', fps = 30) {\n  try {\n    const videoBuffer = await generateVideo(player, fps).catch((error) => {\n      alert(`video: ${error}`);\n    });\n    await sleep(100);\n    const audioBuffer = await generateAudio(player).catch((error) => {\n      alert(`audio: ${error}`);\n    });\n    await sleep(100);\n    let finalVideoBuffer: ArrayBuffer;\n    if (videoBuffer instanceof ArrayBuffer && audioBuffer instanceof ArrayBuffer) {\n      finalVideoBuffer = await FFmpegHelper.MergeVideoAudio(videoBuffer, audioBuffer);\n    } else if (videoBuffer instanceof ArrayBuffer) {\n      finalVideoBuffer = videoBuffer;\n    } else {\n      return;\n    }\n    downloadFile(URL.createObjectURL(new Blob([finalVideoBuffer], { type: 'video/mp4' })), fileName);\n  } catch (error) {\n    alert(error);\n  }\n}\n\n/**\n * 获取clip渲染相关的参数\n */\nexport function getClipRenderInfo(clip: Clip, playerWidth: number, playerHeight: number) {\n  const { originalWidth, originalHeight, fitType } = clip;\n  const {\n    size: {\n      width: currentWidth,\n      height: currentHeight,\n    },\n    position: {\n      x: currentLeft,\n      y: currentTop,\n    },\n  } = clip.geometryInfo;\n  let texWidth = currentWidth; // FitType.CUSTOM\n  let texHeight = currentHeight; // FitType.CUSTOM\n  let left = currentLeft; // FitType.CUSTOM\n  let top = currentTop; // FitType.CUSTOM\n  if (fitType === FitType.CONTAIN) {\n    const playerRatio = playerWidth / playerHeight;\n    const texRatio = originalWidth / originalHeight;\n    if (playerRatio / texRatio > 1) {\n      texHeight = playerHeight;\n      texWidth = originalWidth * (playerHeight / originalHeight);\n      left = (playerWidth - texWidth) * 0.5;\n      top = 0;\n    } else {\n      texWidth = playerWidth;\n      texHeight = originalHeight * (playerWidth / originalWidth);\n      left = 0;\n      top = (playerHeight - texHeight) * 0.5;\n    }\n  } else if (fitType === FitType.COVER) {\n    const playerRatio = playerWidth / playerHeight;\n    const texRatio = originalWidth / originalHeight;\n    if (playerRatio / texRatio > 1) {\n      texWidth = playerWidth;\n      texHeight = originalHeight * (playerWidth / originalWidth);\n      left = 0;\n      top = (playerHeight - texHeight) * 0.5;\n    } else {\n      texHeight = playerHeight;\n      texWidth = originalWidth * (playerHeight / originalHeight);\n      left = (playerWidth - texWidth) * 0.5;\n      top = 0;\n    }\n  } else if (fitType === FitType.FILL) {\n    texWidth = playerWidth;\n    texHeight = playerHeight;\n    left = 0;\n    top = 0;\n  }\n  return { width: texWidth, height: texHeight, left, top };\n}\n\n/**\n * 获取完整的gif帧图像数据\n * @param gif\n * @param currentFrame\n * @param previousFrame\n * 1 - 不处置图形，把图形从当前位置移去\n * 2 - 回复到背景色\n * 3 - 回复到先前状态\n */\nlet disposalRestoreFromIdx: number;\nlet lastFrameData: ImageData;\nexport function getGifCompleteFrame(gif: ParsedGif, currentFrame: ParsedFrame, frameIndex: number, previousFrame?: ParsedFrame) {\n  const { width, height } = gif.lsd;\n  let canvas = document.getElementById('canvasForGif') as HTMLCanvasElement;\n  if (!canvas) {\n    canvas = document.createElement('canvas');\n    canvas.id = 'canvasForGif';\n    canvas.width = width;\n    canvas.height = height;\n  }\n  const ctx = canvas.getContext('2d');\n  if (previousFrame) {\n    if (currentFrame.disposalType === 3) {\n      if (disposalRestoreFromIdx && lastFrameData) {\n        ctx?.putImageData(lastFrameData, 0, 0)\n      } else {\n        ctx?.clearRect(previousFrame.dims.left, previousFrame.dims.top, previousFrame.dims.width, previousFrame.dims.height);\n      }\n    } else {\n      disposalRestoreFromIdx = frameIndex - 1;\n    }\n\n    if (currentFrame.disposalType === 2) {\n      ctx?.clearRect(previousFrame.dims.left, previousFrame.dims.top, previousFrame.dims.width, previousFrame.dims.height);\n    }\n  }\n\n  const imgData = ctx?.getImageData(currentFrame.dims.left, currentFrame.dims.top, currentFrame.dims.width, currentFrame.dims.height);\n  const ct = currentFrame.colorTable;\n  const transparency = currentFrame.transparentIndex;\n  if (imgData) {\n    currentFrame.pixels.forEach((pixel, i) => {\n      // imgData.data === [R,G,B,A,R,G,B,A,...]\n      if (pixel !== transparency) {\n        imgData.data[i * 4 + 0] = ct[pixel][0];\n        imgData.data[i * 4 + 1] = ct[pixel][1];\n        imgData.data[i * 4 + 2] = ct[pixel][2];\n        imgData.data[i * 4 + 3] = 255; // Opaque.\n      }\n    });\n    lastFrameData = imgData;\n    ctx?.putImageData(imgData, currentFrame.dims.left, currentFrame.dims.top);\n  }\n  return ctx?.getImageData(0, 0, width, height);\n}\n","import { Ratio } from '../common/configs';\nimport { EditorContext, PlayerContext } from './type';\n\nexport const TRACK_WRAPPER_CLASS_NAME = 'track-wrapper';\n\nexport const NEW_TRACK_THRESHOLD = 12;\n\n/**\n * 一秒对应的像素宽度\n */\nexport const SECOND_WIDTH = 100;\n\n/**\n * track内部高度\n */\nexport const TRACK_HEIGHT = 56;\n\nexport const TRACK_OUTER_HEIGHT = 60;\n\nexport const INIT_EDITOR_CONTEXT: EditorContext = {\n  hoverTrack: null,\n  setHoverTrack: () => {},\n\n  tracks: [],\n  setTracks: () => {},\n\n  newTrackIndex: -1,\n  setNewTrackIndex: () => {},\n\n  activeClip: undefined,\n  setActiveClip: () => {},\n\n  currentTime: 0,\n  setCurrentTime: () => {},\n\n  totalDuration: 0,\n  setTotalDuration: () => {},\n\n  isPlaying: false,\n  setIsPlaying: () => {},\n\n  ratio: Ratio.RATIO_16_9,\n  setRatio: () => {},\n\n  setDraggingClip: () => {},\n};\n\nexport const INIT_PLAYER_CONTEXT: PlayerContext = {\n  player: undefined,\n  isPlaying: false,\n  setIsPlaying: () => {},\n  handleIsPlayingChange: async () => {},\n  handleCurrentTimeChange: async () => {},\n};\n","import { v4 } from 'uuid';\nimport { Ratio } from '../common/configs';\nimport { Position, Range } from '../common/types';\nimport { Asset, AssetType, AudioAsset, GLTFAsset, LottieAsset, PagAsset, TextAsset, TransitionAsset, VideoAsset } from '../common/types/asset';\nimport { AudioClip, Clip, ClipType, GifClip, GLTFClip, ImageClip, LottieClip, PagClip, TextClip, TransitionClip, VideoClip } from '../common/types/clip';\nimport { EffectType, FitType } from '../common/types/player';\nimport { getRatioValue } from '../common/utils';\nimport { NEW_TRACK_THRESHOLD, SECOND_WIDTH, TRACK_WRAPPER_CLASS_NAME } from './config';\nimport { EditorContext } from './type';\n\nconst trackWrapperSelector = `.${TRACK_WRAPPER_CLASS_NAME}`;\n\n/**\n * 将光标位置转换为元素内的坐标\n */\nexport function cursorPositionToElementPosition(cursorPosition: Position, element: HTMLElement): Position {\n  if (cursorPosition && element) {\n    const rect = element.getBoundingClientRect();\n    return {\n      x: Math.max(0, cursorPosition.x - rect.x),\n      y: Math.max(0, cursorPosition.y - rect.y),\n    };\n  }\n  return { x: 0, y: 0 };\n}\n\n/**\n * \n */\nexport function cursorPositionToTracksWrapperPosition(cursorPosition: Position) {\n  const tracksWrapper = document.querySelector('.tracks-wrapper') as HTMLElement;\n  if (cursorPosition && tracksWrapper) {\n    const rect = tracksWrapper.getBoundingClientRect();\n    const paddingLeft = parseInt(getComputedStyle(tracksWrapper).paddingLeft, 10);\n    return {\n      x: Math.max(0, cursorPosition.x - rect.x - paddingLeft),\n      y: Math.max(0, cursorPosition.y - rect.y),\n    };\n  }\n  return { x: 0, y: 0 };\n}\n\n/**\n * 获取track index\n */\nexport function getTrackIndex(track?: HTMLElement | null) {\n  if (track) {\n    return Array.prototype.slice.call(track.parentElement?.querySelectorAll(trackWrapperSelector)).indexOf(track);\n  }\n  return -1;\n}\n\n// export function getTrackWrapper(el: HTMLElement) {\n//   let parentElement = el?.parentElement;\n//   while (parentElement) {\n//     if (parentElement.classList.contains(TRACK_WRAPPER_CLASS_NAME)) {\n//       return parentElement;\n//     }\n//     parentElement = parentElement.parentElement;\n//   }\n//   return null;\n// }\n\n/**\n * \n * @param belowEl 当前光标下方的元素\n * @param cursorLeft 光标距离屏幕左方距离\n * @param cursorTop 光标距离屏幕上方距离\n * @returns { isNew: number, index: number, trackElement: HTMLElement }\n */\nexport function getTrackInfoForDrag(belowEl: HTMLElement, cursorLeft: number, cursorTop: number) {\n  const tracksWrapper = belowEl.closest('.tracks-wrapper');\n  if (tracksWrapper) {\n    const trackList = tracksWrapper.querySelectorAll(`.${TRACK_WRAPPER_CLASS_NAME}`);\n    for (let i = 0; i < trackList.length; i++) {\n      const { y, height } = trackList[i].getBoundingClientRect();\n      if (cursorTop >= y && cursorTop <= (y + height)) {\n        if (cursorTop >= y && cursorTop <= (y + NEW_TRACK_THRESHOLD)) { // 顶部边缘\n          return {\n            isTop: true,\n            index: i,\n            trackElement: trackList[i],\n          };\n        } else if (cursorTop <= (y + height) && cursorTop >= (y + height - NEW_TRACK_THRESHOLD)) { // 下部边缘\n          return {\n            isBottom: true,\n            index: i,\n            trackElement: trackList[i],\n          };\n        } else if (cursorTop >= y && cursorTop <= (y + height)) { // 内部\n          return {\n            isNew: false,\n            index: i,\n            trackElement: trackList[i],\n          };\n        } \n      }\n    }\n  }\n  return {\n    index: -1,\n    trackElement: null,\n  };\n}\n\n/**\n * 获取trackElement的trackIndex和clipIndex\n */\nexport function getTrackAndClipIndex(data: Clip[][], id?: string) {\n  for (let i = 0; i < data.length; i++) {\n    for (let j = 0; j < data[i].length; j++) {\n      if (data[i][j].id === id) {\n        return { trackIndex: i, clipIndex: j };\n      }\n    }\n  }\n  return { trackIndex: -1, clipIndex: -1 };\n}\n\nexport function needShowPrepareTrack(data: Clip[][]) {\n  return !(data.length === 0 || (data.length === 1 && data[0].length === 0));\n}\n\nexport function millisecondsToWidth(milliseconds?: number) {\n  return (milliseconds || 0) / 1000 * SECOND_WIDTH;\n}\n\nexport function widthToMilliseconds(width: number) {\n  return Math.round(width / SECOND_WIDTH * 1000);\n}\n\nexport function getClipInsertIndex(cursorX: number, data: Clip[]) {\n  if (data.length) {\n    for (let i = 0; i < data.length; i++) {\n      const { start, end } = data[i].timelineInfo;\n      if (cursorX >= start && cursorX <= end) {\n        return -1;\n      }\n      if (cursorX < start) {\n        return i;\n      }\n    }\n    if (cursorX > data[data.length - 1].timelineInfo.end) {\n      return data.length;\n    }\n  }\n  return 0;\n}\n\nexport function getAvailableStartAndEnd(prepareInsertIndex: number, data: Clip[]) {\n  const pre = data[prepareInsertIndex - 1];\n  const next = data[prepareInsertIndex];\n  if (!pre && !next) {\n    return { start: 0, end: 10e9 };\n  }\n  if (!pre && next) {\n    return { start: 0, end: next.timelineInfo.start };\n  }\n  if (pre && next) {\n    return { start: pre.timelineInfo.end, end: next.timelineInfo.start };\n  }\n  if (pre && !next) {\n    return { start: pre.timelineInfo.end, end: 10e9 };\n  }\n  return { start: 0, end: 0 };\n}\n\n/**\n * 调整插入范围\n * @param availableRange 当前可供插入的范围\n * @param insertRange 要插入的范围\n */\nexport function adjustStartAndEnd(availableRange: Range, insertRange: Range): Range {\n  if (insertRange[0] >= availableRange[0] && insertRange[1] <= availableRange[1]) {\n    return insertRange;\n  }\n  if (insertRange[0] >= availableRange[0] && insertRange[1] > availableRange[1]) { // 需要左移\n    const diff = insertRange[1] - availableRange[1];\n    return [\n      Math.max(insertRange[0] - diff, availableRange[0]),\n      Math.min(insertRange[1] - diff, availableRange[1]),\n    ];\n  }\n  if (insertRange[0] < availableRange[0] && insertRange[1] <= availableRange[1]) { // 需要右移\n    const diff = availableRange[0] - insertRange[0];\n    return [\n      Math.max(insertRange[0] + diff, availableRange[0]),\n      Math.min(insertRange[1] + diff, availableRange[1]),\n    ];\n  }\n  if (insertRange[0] <= availableRange[0] && insertRange[1] >= availableRange[1]) {\n    return availableRange;\n  }\n  return insertRange;\n}\n\n/**\n * 获取当前编辑内容的总时长\n */\nexport function getTotalDuration(data: Clip[][]) {\n  let result = 0;\n  data.forEach((track) => {\n    if (track?.length) {\n      const lastClip = track[track.length - 1];\n      result = Math.max(result, lastClip.timelineInfo.end);\n    }\n  });\n  return result;\n}\n\n/**\n * 判断两个clip是否相邻\n */\nexport function isClipsNext(clip1?: Clip, clip2?: Clip) {\n  if (clip1 && clip2) {\n    return Math.abs(clip1.timelineInfo.end - clip2.timelineInfo.start) <= 10e-6;\n  }\n  return false;\n}\n\nexport function canWithTransition(clipType: ClipType) {\n  return [\n    ClipType.VIDEO,\n    ClipType.IMAGE,\n    ClipType.GIF,\n  ].includes(clipType);\n}\n\nexport function isTransitionStart(tracks: Clip[][], clipId?: string) {\n  const transitions = tracks.flat(1).filter((clip) => clip.type === ClipType.TRANSITION);\n  return transitions.findIndex((transition) => (transition as TransitionClip).fromId === clipId) > -1;\n}\n\nexport function isTransitionEnd(tracks: Clip[][], clipId?: string) {\n  const transitions = tracks.flat(1).filter((clip) => clip.type === ClipType.TRANSITION);\n  return transitions.findIndex((transition) => (transition as TransitionClip).toId === clipId) > -1;\n}\n\nexport function getTransition(tracks: Clip[][], clipId?: string) {\n  const transitions = tracks.flat(1).filter((clip) => clip.type === ClipType.TRANSITION);\n  return transitions.findIndex((transition) => (transition as TransitionClip).fromId === clipId) > -1;\n}\n\nexport function deleteSelectedClip(editorContextValue: EditorContext) {\n  const { tracks, activeClip: clip, setTracks, setActiveClip } = editorContextValue;\n  if (clip) {\n    const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, clip.id);\n    // 如果是transition，需要更新toClip的position\n    if (clip.type === ClipType.TRANSITION) {\n      const fromClip = tracks[trackIndex][clipIndex - 1];\n      const toClip = tracks[trackIndex][clipIndex + 1];\n      const afterToClip = tracks[trackIndex][clipIndex + 2];\n      const newRange = adjustStartAndEnd(\n        [fromClip?.timelineInfo?.end || 0, afterToClip?.timelineInfo?.start || 10e9],\n        [toClip.timelineInfo.start + clip.timelineInfo.duration / 2, toClip.timelineInfo.end + clip.timelineInfo.duration / 2]\n      );\n      Object.assign(toClip, {\n        timelineInfo: {\n          start: newRange[0],\n          end: newRange[1],\n          duration: newRange[1] - newRange[0],\n        },\n      });\n      tracks[trackIndex].splice(clipIndex, 1); // 删除clip\n    } else if (isTransitionStart(tracks, clip.id)) {\n      tracks[trackIndex].splice(clipIndex, 1); // 删除clip\n      tracks[trackIndex].splice(clipIndex, 1); // 删除transition\n    } else if (isTransitionEnd(tracks, clip.id)) {\n      tracks[trackIndex].splice(clipIndex, 1); // 删除clip\n      tracks[trackIndex].splice(clipIndex - 1, 1); // 删除transition\n    } else {\n      tracks[trackIndex].splice(clipIndex, 1); // 删除clip\n    }\n    setActiveClip(undefined);\n    setTracks([...tracks]);\n  }\n}\n\nexport function isClipCanSplit(data: Clip[][], currentTime: number, id?: string) {\n  const { trackIndex, clipIndex } = getTrackAndClipIndex(data, id);\n  if (trackIndex > -1 && clipIndex > -1) {\n    const clip = data[trackIndex][clipIndex];\n    const canSplit = isClipTypeCanSplit(clip.type);\n    const { start, end } = clip.timelineInfo;\n    return canSplit && start < currentTime && end > currentTime;\n  }\n  return false;\n}\n\nexport function isClipTypeCanSplit(clipType: ClipType) {\n  return [\n    ClipType.AUDIO,\n    ClipType.GIF,\n    ClipType.IMAGE,\n    ClipType.VIDEO,\n  ].includes(clipType);\n}\n\nexport function splitSelectedClip(editorContextValue: EditorContext) {\n  const { tracks, activeClip: clip, setTracks, currentTime: timelineSplitTime } = editorContextValue;\n  if (clip) {\n    const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, clip.id);\n    const canSplit = isClipTypeCanSplit(clip.type);\n    const { start, end } = clip.timelineInfo;\n    if (canSplit && start < timelineSplitTime && end > timelineSplitTime) {\n      const splitPercent = (timelineSplitTime - start) / (end - start);\n      const playRangeSplitTime = clip.playRange.start + Math.round((clip.playRange.end - clip.playRange.start) * splitPercent);\n      // 需保持playRange在positionInTimeline之前，不然计算playbackRate会有bug\n      tracks[trackIndex].splice(clipIndex + 1, 0, {\n        ...clip,\n        id: v4(),\n        playRange: {\n          start: playRangeSplitTime,\n          end: clip.playRange.end,\n        },\n        timelineInfo: {\n          start: timelineSplitTime,\n          end,\n          duration: end - timelineSplitTime,\n        },\n      });\n      Object.assign(clip, {\n        playRange: {\n          start: clip.playRange.start,\n          end: playRangeSplitTime,\n        },\n        timelineInfo: {\n          start,\n          end: timelineSplitTime,\n          duration: timelineSplitTime - start,\n        },\n      });\n      setTracks([...tracks]);\n    }\n  }\n}\n\n/**\n * 资源onLoad之前的初始化值\n */\n export function assetToClip(asset: Asset, start?: number, end?: number): Clip {\n  const common = {\n    name: asset.name,\n    timelineInfo: {\n      start,\n      end,\n      duration: 0,\n    },\n    fitType: FitType.CONTAIN,\n    geometryInfo: {\n      rotate: 0,\n      position: {\n        x: 0,\n        y: 0,\n      },\n      size: {\n        width: 0,\n        height: 0,\n      },\n    },\n    playRange: {\n      start: 0,\n      end: 0,\n    },\n    effect: EffectType.NO_EFFECT,\n  };\n  switch (asset.type) {\n    case AssetType.VIDEO:\n      return {\n        ...common,\n        type: ClipType.VIDEO,\n        url: (asset as VideoAsset).url,\n      } as VideoClip;\n    case AssetType.IMAGE:\n      return {\n        ...common,\n        type: ClipType.IMAGE,\n        url: (asset as VideoAsset).url,\n      } as ImageClip;\n    case AssetType.AUDIO:\n      return {\n        ...common,\n        type: ClipType.AUDIO,\n        url: (asset as AudioAsset).url,\n      } as AudioClip;\n    case AssetType.TRANSITION:\n      return {\n        ...common,\n        type: ClipType.TRANSITION,\n        transition: (asset as TransitionAsset).transition,\n      } as TransitionClip;\n    case AssetType.GIF:\n      return {\n        ...common,\n        fitType: FitType.CUSTOM,\n        type: ClipType.GIF,\n        url: (asset as VideoAsset).url,\n        frames: [],\n        originalWidth: 0,\n        originalHeight: 0,\n        zIndex: 0,\n      } as GifClip;\n    case AssetType.TEXT:\n      return {\n        ...common,\n        fitType: FitType.CUSTOM,\n        props: {\n          fontColor: '#fff',\n          fontSize: 16,\n          fontFamily: 'Helvetica',\n        },\n        value: (asset as TextAsset).value,\n        type: ClipType.TEXT,\n        originalWidth: 0,\n        originalHeight: 0,\n        zIndex: 0,\n      } as TextClip;\n    case AssetType.LOTTIE:\n      return {\n        ...common,\n        fitType: FitType.CUSTOM,\n        url: (asset as LottieAsset).url,\n        type: ClipType.LOTTIE,\n      } as LottieClip;\n    case AssetType.PAG:\n      return {\n        ...common,\n        fitType: FitType.CUSTOM,\n        url: (asset as PagAsset).url,\n        type: ClipType.PAG,\n      } as PagClip;\n    case AssetType.GLTF:\n      return {\n        ...common,\n        fitType: FitType.FILL,\n        url: (asset as GLTFAsset).url,\n        type: ClipType.GLTF,\n      } as GLTFClip;\n    default:\n      return {} as Clip;\n  }\n}\n\nexport function getPlayerContainerBounding(): DOMRect {\n  const playerContainer = document.querySelector('.player');\n  if (playerContainer) {\n    return playerContainer.getBoundingClientRect();\n  }\n  return {\n    width: 0,\n    height: 0,\n    x: 0,\n    y: 0,\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    toJSON: () => {},\n  };\n}\n\n/**\n * 根据比例和容器大小计算player长宽\n */\nexport function getPlayerResolution(ratio: Ratio, containerWidth: number, containerHeight: number) {\n  const ratioValue = getRatioValue(ratio);\n  let newWidth = 0;\n  let newHeight = 0;\n  if (ratioValue * containerHeight > containerWidth) {\n    newWidth = Math.round(containerWidth);\n    newHeight = Math.round(containerWidth / ratioValue);\n  } else {\n    newWidth = Math.round(ratioValue * containerHeight);\n    newHeight = Math.round(containerHeight);\n  }\n  if (newWidth % 2 !== 0) {\n    newWidth -= 1;\n  }\n  if (newHeight % 2 !== 0) {\n    newHeight -= 1;\n  }\n  return {\n    width: newWidth,\n    height: newHeight,\n  };\n}\n\n/**\n * 计算两个线段的交点\n */\nexport function lineIntersect(x1: number, y1: number, x2: number, y2: number, x3: number, y3: number, x4: number, y4: number) {\n  // Check if none of the lines are of length 0\n  if ((x1 === x2 && y1 === y2) || (x3 === x4 && y3 === y4)) {\n    return false;\n  }\n\n  const denominator = ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1));\n\n  // Lines are parallel\n  if (denominator === 0) {\n    return false;\n  }\n\n  const ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator;\n  const ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator;\n\n  // is the intersection along the segments\n  if (ua < 0 || ua > 1 || ub < 0 || ub > 1) {\n    return false;\n  }\n\n  // Return a object with the x and y coordinates of the intersection\n  const x = x1 + ua * (x2 - x1);\n  const y = y1 + ua * (y2 - y1);\n\n  return { x, y };\n}\n\n/**\n * 获取moveable框的中心点坐标\n */\nexport function getMoveableCenter() {\n  const controls = document.querySelectorAll('.moveable-control.moveable-direction');\n  const points: number[] = [];\n  controls.forEach((control) => {\n    const { x, y } = control.getBoundingClientRect();\n    points.push(x, y);\n  });\n  const p = lineIntersect(\n    points[0],\n    points[1],\n    points[6],\n    points[7],\n    points[2],\n    points[3],\n    points[4],\n    points[5],\n  );\n  if (!p) {\n    return {\n      x: 0,\n      y: 0,\n    };\n  }\n  return p;\n}\n","import React, { useEffect } from 'react';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { AudioClip } from '../../../../../common/types/clip';\n\ntype Props = {\n  data: AudioClip;\n  onLoaded(data: AudioClip): void;\n};\n\nconst AudioCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    if (!data.buffer) {\n      fetch(data.url).then((response) => {\n        return response.blob();\n      }).then((file: Blob) => {\n        const blobUrl = URL.createObjectURL(file);\n        const audio = document.createElement('audio');\n        audio.loop = false;\n        audio.addEventListener('loadedmetadata', () => {\n          file.arrayBuffer().then((buffer) => {\n            const duration = Math.round(audio.duration * 1000);\n            onLoaded({\n              ...data,\n              timelineInfo: {\n                ...data.timelineInfo,\n                duration: duration,\n              },\n              playRange: {\n                start: 0,\n                end: duration,\n              },\n              buffer,\n            });\n          }).catch((error) => {\n            alert(error.message);\n          });\n        });\n        audio.src = blobUrl;\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded]);\n  return (\n    <StyledAssetCard>\n      <audio src={data.url} />\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default AudioCard;\n","import React, { useEffect } from 'react';\nimport { GifClip } from '../../../../../common/types/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { GifFrame } from '../../../../../common/types';\n\ntype Props = {\n  data: GifClip;\n  onLoaded(data: GifClip): void;\n};\n\ninterface GifProps {\n  width: number;\n  height: number;\n  frames: GifFrame[];\n}\n\nfunction parseGif(buffer: ArrayBuffer) {\n  return new Promise<GifProps>((resolve) => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n    // @ts-ignore\n    const superGif = new SuperGif({\n      gif: container,\n      draw_while_loading: false,\n    });\n    superGif.load_raw(new Uint8Array(buffer), () => {\n      const { width, height } = superGif.get_canvas() as HTMLCanvasElement;\n      container.parentNode?.removeChild(container);\n      resolve({\n        frames: [...superGif.get_frames()] as GifFrame[],\n        width,\n        height,\n      });\n    });\n  });\n}\n\nconst GifCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    if (!data?.frames?.length) {\n      fetch(data.url).then((response) => {\n        return response.arrayBuffer();\n      }).then(async (buffer: ArrayBuffer) => {\n        const {\n          frames,\n          width,\n          height,\n        } = await parseGif(buffer);\n        // 转为毫秒\n        frames.forEach(frame => {\n          frame.delay = frame.delay * 10 || 100;\n        });\n        const duration = frames.reduce((a, b) => (a + b.delay), 0);\n        onLoaded({\n          ...data,\n          timelineInfo: {\n            ...data.timelineInfo,\n            duration,\n          },\n          geometryInfo: {\n            ...data.geometryInfo,\n            size: {\n              width,\n              height,\n            },\n          },\n          playRange: {\n            start: 0,\n            end: duration,\n          },\n          frames,\n          originalWidth: width,\n          originalHeight: height,\n        });\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded]);\n  return (\n    <StyledAssetCard>\n      <img src={data.url} alt=\"\" draggable=\"false\" />\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default GifCard;\n","import React, { useContext, useEffect } from 'react';\nimport { GLTFClip } from '../../../../../common/types/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { GLTF, GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { MODEL_DEFAULT_DURATION } from '../../../../../common/configs/clip';\nimport { playerContext } from '../../../..';\n\ntype Props = {\n  data: GLTFClip;\n  onLoaded(data: GLTFClip): void;\n};\n\nconst GLTFCard: React.FC<Props> = ({ data, onLoaded }) => {\n  const { player } = useContext(playerContext);\n  useEffect(() => {\n    if (!data?.originalWidth) {\n      const loader = new GLTFLoader();\n      loader.loadAsync(data.url).then((modelData: GLTF) => {\n        onLoaded({\n          ...data,\n          timelineInfo: {\n            ...data.timelineInfo,\n            duration: MODEL_DEFAULT_DURATION,\n          },\n          geometryInfo: {\n            ...data.geometryInfo,\n            size: {\n              width: player?.width || 0,\n              height: player?.height || 0,\n            },\n          },\n          playRange: {\n            start: 0,\n            end: MODEL_DEFAULT_DURATION,\n          },\n          originalWidth: player?.width || 0,\n          originalHeight: player?.height || 0,\n          modelData,\n        });\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded, player?.height, player?.width]);\n  return (\n    <StyledAssetCard>\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default GLTFCard;\n","export const TRANSITION_DEFAULT_DURATION = 1000;\n\nexport const TEXT_DEFAULT_DURATION = 2000;\n\nexport const IMAGE_DEFAULT_DURATION = 2000;\n\nexport const MODEL_DEFAULT_DURATION = 2000;\n","import React, { useEffect } from 'react';\nimport { IMAGE_DEFAULT_DURATION } from '../../../../../common/configs/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { ImageClip } from '../../../../../common/types/clip';\n\ntype Props = {\n  data: ImageClip;\n  onLoaded(data: ImageClip): void;\n};\n\nconst ImageCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    if (!data.blobUrl) {\n      fetch(data.url).then((response) => {\n        return response.blob();\n      }).then((file: Blob) => {\n        const blobUrl = URL.createObjectURL(file);\n        const img = document.createElement('img');\n        img.addEventListener('load', () => {\n          onLoaded({\n            ...data,\n            timelineInfo: {\n              ...data.timelineInfo,\n              duration: IMAGE_DEFAULT_DURATION,\n            },\n            geometryInfo: {\n              ...data.geometryInfo,\n              size: {\n                width: img.naturalWidth,\n                height: img.naturalHeight,\n              },\n            },\n            originalWidth: img.naturalWidth,\n            originalHeight: img.naturalHeight,\n            blobUrl,\n          });\n        });\n        img.src = blobUrl;\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded]);\n  return (\n    <StyledAssetCard>\n      <img src={data.url} alt=\"\" draggable=\"false\" />\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default ImageCard;\n","import React, { useEffect } from 'react';\nimport { LottieClip } from '../../../../../common/types/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { ObjectType } from '../../../../../common/types';\nimport { getLottieInfo } from '../../../../../common/utils';\n\ntype Props = {\n  data: LottieClip;\n  onLoaded(data: LottieClip): void;\n};\n\nconst LottieCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    if (!data?.originalWidth) {\n      fetch(data.url).then((response) => {\n        return response.json();\n      }).then(async (animationData: ObjectType) => {\n        const { width, height, duration } = await getLottieInfo(animationData);\n        onLoaded({\n          ...data,\n          timelineInfo: {\n            ...data.timelineInfo,\n            duration,\n          },\n          geometryInfo: {\n            ...data.geometryInfo,\n            size: {\n              width,\n              height,\n            },\n          },\n          playRange: {\n            start: 0,\n            end: duration,\n          },\n          originalWidth: width,\n          originalHeight: height,\n          animationData,\n        });\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded]);\n  return (\n    <StyledAssetCard>\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default LottieCard;\n","import React, { useEffect } from 'react';\nimport { PagClip } from '../../../../../common/types/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { getPixelRatio, loadPagWasmModule } from '../../../../../common/utils';\n\ntype Props = {\n  data: PagClip;\n  onLoaded(data: PagClip): void;\n};\n\nconst PagCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    if (!data?.originalWidth) {\n      fetch(data.url).then((response) => {\n        return response.blob();\n      }).then(async (blob: Blob) => {\n        const file = new File([blob], data.url.replace(/(.*\\/)*([^.]+)/i, '$2'));\n        const pagWasm = await loadPagWasmModule();\n        const pagFile = await pagWasm.PAGFile.load(file);\n        const width = pagFile.width() / getPixelRatio();\n        const height = pagFile.height() / getPixelRatio();\n        const duration = pagFile.duration() / 1_000;\n        onLoaded({\n          ...data,\n          timelineInfo: {\n            ...data.timelineInfo,\n            duration,\n          },\n          geometryInfo: {\n            ...data.geometryInfo,\n            size: {\n              width,\n              height,\n            },\n          },\n          playRange: {\n            start: 0,\n            end: duration,\n          },\n          originalWidth: width,\n          originalHeight: height,\n          pagFile,\n          pag: pagWasm,\n        });\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded]);\n  return (\n    <StyledAssetCard>\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default PagCard;\n","import React, { useEffect } from 'react';\nimport { TEXT_DEFAULT_DURATION } from '../../../../../common/configs/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { TextClip } from '../../../../../common/types/clip';\nimport { getPixelRatio, getTextClipSize } from '../../../../../common/utils';\n\ntype Props = {\n  data: TextClip;\n  onLoaded(data: TextClip): void;\n};\n\nconst TextCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    const { width, height } = getTextClipSize(data);\n    onLoaded({\n      ...data,\n      timelineInfo: {\n        ...data.timelineInfo,\n        duration: TEXT_DEFAULT_DURATION,\n      },\n      geometryInfo: {\n        ...data.geometryInfo,\n        size: {\n          width: width / getPixelRatio(),\n          height: height / getPixelRatio(),\n        },\n      },\n      originalWidth: width,\n      originalHeight: height,\n    });\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return (\n    <StyledAssetCard>\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default TextCard;\n","import React, { useContext, useEffect } from 'react';\nimport { playerContext } from '../../../..';\nimport { TRANSITION_DEFAULT_DURATION } from '../../../../../common/configs/clip';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { TransitionClip } from '../../../../../common/types/clip';\n\ntype Props = {\n  data: TransitionClip;\n  onLoaded(data: TransitionClip): void;\n};\n\nconst TransitionCard: React.FC<Props> = ({ data, onLoaded }) => {\n  const { player } = useContext(playerContext);\n  useEffect(() => {\n    onLoaded({\n      ...data,\n      timelineInfo: {\n        ...data.timelineInfo,\n        duration: TRANSITION_DEFAULT_DURATION,\n      },\n      geometryInfo: {\n        ...data.geometryInfo,\n        size: {\n          width: player?.width || 0,\n          height: player?.height || 0,\n        }\n      }\n    });\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [player?.width, player?.height]);\n  return (\n    <StyledAssetCard>\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default TransitionCard;\n","import React, { useEffect } from 'react';\nimport { StyledAssetCard } from '../../../../../common/styleds';\nimport { VideoClip } from '../../../../../common/types/clip';\n\ntype Props = {\n  data: VideoClip;\n  onLoaded(data: VideoClip): void;\n};\n\nconst VideoCard: React.FC<Props> = ({ data, onLoaded }) => {\n  useEffect(() => {\n    if (!data.blobUrl) {\n      fetch(data.url).then((response) => {\n        return response.blob();\n      }).then(async (file: Blob) => {\n        const buffer = await file.arrayBuffer();\n        const blobUrl = URL.createObjectURL(file);\n        const video = document.createElement('video');\n        video.loop = false;\n        video.addEventListener('loadedmetadata', () => {\n          const duration = Math.round(video.duration * 1000);\n          onLoaded({\n            ...data,\n            timelineInfo: {\n              ...data.timelineInfo,\n              duration: duration,\n            },\n            geometryInfo: {\n              ...data.geometryInfo,\n              size: {\n                width: video.videoWidth,\n                height: video.videoHeight,\n              },\n            },\n            playRange: {\n              start: 0,\n              end: duration,\n            },\n            originalWidth: video.videoWidth,\n            originalHeight: video.videoHeight,\n            blobUrl,\n            buffer,\n          });\n        });\n        video.src = blobUrl;\n      }).catch((error) => {\n        alert(error.message);\n      });\n    }\n  }, [data, onLoaded]);\n  return (\n    <StyledAssetCard>\n      <video src={data.blobUrl} />\n      <div className=\"title\">{data.name}</div>\n    </StyledAssetCard>\n  );\n};\n\nexport default VideoCard;\n","import styled from 'styled-components';\n\nexport const StyledCard = styled.div`\n  width: 200px;\n  height: 112px;\n  line-height: 112px;\n  text-align: center;\n  border-radius: 4px;\n  background-color: #000;\n  cursor: pointer;\n`;\n","import React, { useCallback, useContext, useState } from 'react';\nimport { v4 } from 'uuid';\nimport { editorContext } from '../..';\nimport Draggable from '../../../common/components/Draggable';\nimport { MoveDirection } from '../../../common/components/Draggable/config';\nimport { DragInfo } from '../../../common/components/Draggable/type';\nimport { Asset } from '../../../common/types/asset';\nimport { AudioClip, Clip, ClipType, GifClip, GLTFClip, ImageClip, LottieClip, PagClip, TextClip, TransitionClip, VideoClip } from '../../../common/types/clip';\nimport { getClipRenderInfo } from '../../../player/util';\nimport {\n  adjustStartAndEnd,\n  assetToClip,\n  cursorPositionToTracksWrapperPosition,\n  getAvailableStartAndEnd,\n  getClipInsertIndex,\n  getPlayerContainerBounding,\n  getTrackAndClipIndex,\n  getTrackIndex,\n  getTrackInfoForDrag,\n  millisecondsToWidth,\n  needShowPrepareTrack,\n  widthToMilliseconds,\n} from '../../util';\nimport AudioCard from './components/AudioCard';\nimport GifCard from './components/GifCard';\nimport GLTFCard from './components/GLTFCard';\nimport ImageCard from './components/ImageCard';\nimport LottieCard from './components/LottieCard';\nimport PagCard from './components/PagCard';\nimport TextCard from './components/TextCard';\nimport TransitionCard from './components/TransitionCard';\nimport VideoCard from './components/VideoCard';\nimport { StyledCard } from './styled';\n\nfunction getAssetCard(data: Clip | undefined, handleLoaded: (data: Clip) => void) {\n  switch (data?.type) {\n    case ClipType.VIDEO:\n      return <VideoCard data={data as VideoClip} onLoaded={handleLoaded} />;\n    case ClipType.IMAGE:\n      return <ImageCard data={data as ImageClip} onLoaded={handleLoaded} />;\n    case ClipType.AUDIO:\n      return <AudioCard data={data as AudioClip} onLoaded={handleLoaded} />;\n    case ClipType.TRANSITION:\n      return <TransitionCard data={data as TransitionClip} onLoaded={handleLoaded} />;\n    case ClipType.GIF:\n      return <GifCard data={data as GifClip} onLoaded={handleLoaded} />;\n    case ClipType.TEXT:\n      return <TextCard data={data as TextClip} onLoaded={handleLoaded} />;\n    case ClipType.LOTTIE:\n      return <LottieCard data={data as LottieClip} onLoaded={handleLoaded} />;\n    case ClipType.PAG:\n      return <PagCard data={data as PagClip} onLoaded={handleLoaded} />;\n    case ClipType.GLTF:\n      return <GLTFCard data={data as GLTFClip} onLoaded={handleLoaded} />;\n    default:\n      return null;\n  }\n}\n\ntype Props = {\n  data: Asset;\n};\n\nconst AssetCard: React.FC<Props> = ({ data }) => {\n  const {\n    setHoverTrack,\n    tracks,\n    setTracks,\n    setNewTrackIndex,\n    newTrackIndex,\n    setDraggingClip,\n  } = useContext(editorContext);\n\n  const [loaded, setLoaded] = useState(false);\n  const [clip, setClip] = useState<Clip>(assetToClip(data));\n\n  const handleStart = useCallback(() => {\n    setDraggingClip(clip);\n  }, [clip, setDraggingClip]);\n\n  const handleMove = useCallback((dragInfo: DragInfo<Asset>) => {\n    const { belowElement, cursorLeft, cursorTop } = dragInfo;\n    if (!belowElement) {\n      return;\n    }\n    if (clip?.type === ClipType.TRANSITION) {\n      return;\n    }\n    const { trackElement, index: trackIndex, isTop, isBottom } = getTrackInfoForDrag(belowElement, cursorLeft, cursorTop);\n    if (trackElement && trackIndex >= 0) {\n      const showPrepareTrack = needShowPrepareTrack(tracks);\n      if (isTop && showPrepareTrack) {\n        setNewTrackIndex(trackIndex);\n      } else if (isBottom && showPrepareTrack) {\n        setNewTrackIndex(trackIndex + 1);\n      } else {\n        setNewTrackIndex(-1);\n      }\n    }\n    setHoverTrack(trackElement as HTMLElement);\n  }, [clip?.type, setHoverTrack, setNewTrackIndex, tracks]);\n\n  /**\n   * transition单独处理\n   */\n  const handleTransitionEnd = useCallback((dragInfo: DragInfo<Asset>) => {\n    const { belowElement } = dragInfo;\n    if (belowElement.classList.contains('transition-insert') && clip) {\n      const fromId = belowElement.dataset.from;\n      const toId = belowElement.dataset.to;\n      const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, fromId);\n      const from = tracks[trackIndex][clipIndex];\n      const to = tracks[trackIndex][clipIndex + 1];\n      const halfTransitionDuration = clip.timelineInfo.duration / 2;\n      const newClip: TransitionClip = {\n        ...(clip as TransitionClip),\n        id: v4(),\n        timelineInfo: {\n          ...clip.timelineInfo,\n          start: from.timelineInfo.end - halfTransitionDuration,\n          end: from.timelineInfo.end + halfTransitionDuration,\n        },\n        fromId,\n        toId,\n      };\n      Object.assign(to, {\n        timelineInfo: {\n          ...to.timelineInfo,\n          start: to.timelineInfo.start - halfTransitionDuration,\n          end: to.timelineInfo.end - halfTransitionDuration,\n        },\n      });\n      tracks[trackIndex].splice(clipIndex + 1, 0, newClip);\n      setTracks([...tracks]);\n    }\n    setDraggingClip(undefined);\n    setNewTrackIndex(-1);\n    setHoverTrack(null);\n  }, [clip, setDraggingClip, setHoverTrack, setNewTrackIndex, setTracks, tracks]);\n\n  const handleEnd = useCallback((dragInfo: DragInfo<Asset>) => {\n    const { belowElement, cursorLeft, cursorTop, element } = dragInfo;\n    if (!belowElement) {\n      return;\n    }\n    if (clip?.type === ClipType.TRANSITION) {\n      handleTransitionEnd(dragInfo);\n      return;\n    }\n    const { trackElement } = getTrackInfoForDrag(belowElement, cursorLeft, cursorTop);\n    const pos = cursorPositionToTracksWrapperPosition({ x: cursorLeft, y: cursorTop });\n    let trackIndex = -1;\n    if (newTrackIndex > -1) {\n      trackIndex = newTrackIndex;\n      tracks.splice(trackIndex, 0, []);\n    } else if (trackElement) {\n      trackIndex = getTrackIndex(trackElement as HTMLElement);\n    }\n    const track = tracks[trackIndex];\n    if (trackIndex > -1 && track) {\n      // 获取将要插入的索引\n      const prepareInsertIndex = getClipInsertIndex(widthToMilliseconds(pos.x), track);\n      if (prepareInsertIndex > -1) {\n        // 获取可供插入的范围\n        const availableDuration = getAvailableStartAndEnd(prepareInsertIndex, track);\n        if (availableDuration.start || availableDuration.end) {\n          const duration = clip?.timelineInfo?.duration || 0;\n          const width = millisecondsToWidth(duration); // 拖拽的元素放到track上的宽度\n          const dragElementWidth = element.clientWidth;\n          const shiftX = cursorLeft - dragInfo.left;\n          const start = widthToMilliseconds(Math.max(0, pos.x - (shiftX / dragElementWidth) * width));\n          const [finalStart, finalEnd] = adjustStartAndEnd(\n            [availableDuration.start, availableDuration.end],\n            [start, start + duration]\n          );\n          const { height: playerHeight, width: playerWidth } = getPlayerContainerBounding();\n          const { width: renderWidth, height: renderHeight, left, top } = getClipRenderInfo(clip, playerWidth, playerHeight);\n          const newClip: Clip = {\n            ...clip,\n            id: v4(),\n            timelineInfo: {\n              start: finalStart,\n              end: finalEnd,\n              duration: finalEnd - finalStart,\n            },\n            geometryInfo: {\n              ...clip.geometryInfo,\n              size: {\n                width: renderWidth,\n                height: renderHeight,\n              },\n              position: {\n                x: left,\n                y: top,\n              }\n            },\n          };\n          track.splice(prepareInsertIndex, 0, newClip);\n          setTracks([...tracks]);\n        }\n      }\n    }\n    setDraggingClip(undefined);\n    setNewTrackIndex(-1);\n    setHoverTrack(null);\n  }, [clip, handleTransitionEnd, newTrackIndex, setDraggingClip, setHoverTrack, setNewTrackIndex, setTracks, tracks]);\n\n  const handleLoaded = useCallback((data: Clip) => {\n    setClip({ ...clip, ...data });\n    setLoaded(true);\n  }, [clip]);\n\n  return (\n    <Draggable\n      direction={MoveDirection.ALL}\n      scrollContainerSelector=\".tracks-wrapper\"\n      autoGrow={true}\n      enable={loaded}\n      slow={2}\n      onStart={handleStart}\n      onMove={handleMove}\n      onEnd={handleEnd}\n    >\n      <StyledCard>\n        {getAssetCard(clip, handleLoaded)}\n      </StyledCard>\n    </Draggable>\n  );\n};\n\nexport default AssetCard;\n","import React from 'react';\nimport { ASSET } from '../../../../../asset';\nimport { AssetCardContainer, AssetWhole } from '../../../../../common/styleds';\nimport AssetCard from '../../../AssetCard';\n\nconst MediaPanel: React.FC = () => {\n  return (\n    <>\n      {\n        ASSET.videos.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        ASSET.images.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        ASSET.gifs.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        ASSET.audios.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        ASSET.lotties.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        ASSET.pags.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        ASSET.gltfs.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n    </>\n  );\n};\n\nexport default MediaPanel;\n","import React, { useCallback } from 'react';\nimport { MenuItemContainer } from '../../../../../common/styleds';\n\ntype Props = {\n  isActive: boolean;\n  title: string;\n  icon: React.ReactNode;\n  resourcePanel?: React.ReactNode;\n  onClick(title: string): void;\n};\n\nconst MenuItem: React.FC<Props> = ({ icon, title, isActive, onClick }) => {\n  const handleClick = useCallback(() => {\n    onClick(title);\n  }, [onClick, title]);\n  return (\n    <>\n      <MenuItemContainer className={isActive ? 'active' : ''} onClick={handleClick}>\n        <div className=\"icon\">{icon}</div>\n        <div className=\"title\">{title}</div>\n      </MenuItemContainer>\n    </>\n  );\n};\n\nexport default MenuItem;\n","import styled from 'styled-components';\n\nexport const ResourcePanel = styled.div`\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 80px;\n  bottom: 0;\n  overflow: overlay;\n  display: flex;\n  flex-wrap: wrap;\n  align-content: flex-start;\n  padding: 24px 0 24px 24px;\n`;\n","import { Upload } from 'antd';\nimport { UploadChangeParam } from 'antd/lib/upload';\nimport { UploadFile } from 'antd/lib/upload/interface';\nimport React, { useCallback, useState } from 'react';\nimport { AssetCardContainer, AssetWhole, Radius10Button, SubMenuButton, SubMenuContainer } from '../../../../../common/styleds';\nimport { AssetType, AudioAsset, GifAsset, ImageAsset, VideoAsset } from '../../../../../common/types/asset';\nimport AssetCard from '../../../AssetCard';\n\nconst MinePanel: React.FC = () => {\n  const [videoList, setVideoList] = useState<VideoAsset[]>([]);\n  const [imageList, setImageList] = useState<(ImageAsset | GifAsset)[]>([]);\n  const [audioList, setAudioList] = useState<AudioAsset[]>([]);\n  const handleBeforeUpload = useCallback(() => {\n    return false;\n  } ,[]);\n  const handleFileChange = useCallback((info: UploadChangeParam<UploadFile<any>>) => {\n    const file = info.file as unknown as File;\n    const fileType = file.type;\n    if (fileType?.includes('video/')) {\n      const asset: VideoAsset = {\n        name: file.name,\n        type: AssetType.VIDEO,\n        url: URL.createObjectURL(file),\n      };\n      setVideoList([ ...videoList, asset ]);\n    }\n    if (fileType?.includes('image')) {\n      let asset = {\n        name: file.name,\n        type: AssetType.IMAGE,\n        url: URL.createObjectURL(file),\n      } as ImageAsset;\n      if (fileType.includes('image/gif')) {\n        asset = {\n          name: file.name,\n          type: AssetType.GIF,\n          url: URL.createObjectURL(file),\n        } as GifAsset;\n      }\n      setImageList([ ...imageList, asset ]);\n    }\n    if (fileType?.includes('audio')) {\n      const asset: AudioAsset = {\n        name: file.name,\n        type: AssetType.AUDIO,\n        url: URL.createObjectURL(file),\n      };\n      setAudioList([ ...audioList, asset ]);\n    }\n  }, [audioList, imageList, videoList]);\n  return (\n    <>\n      <SubMenuContainer>\n        <SubMenuButton className=\"active\">\n          全部\n        </SubMenuButton>\n        <Upload\n          beforeUpload={handleBeforeUpload}\n          onChange={handleFileChange}\n          multiple={false}\n          accept=\"video/*,audio/*,image/png,image/jpeg,image/jpg,image/gif\"\n          showUploadList={false}\n        >\n          <Radius10Button style={{ color: '#7B9FD6' }}>\n            +\n          </Radius10Button>\n        </Upload>\n      </SubMenuContainer>\n      {\n        videoList.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        audioList.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n      {\n        imageList.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n    </>\n  );\n};\n\nexport default MinePanel;\n","import React from 'react';\nimport { ASSET } from '../../../../../asset';\nimport { AssetCardContainer, AssetWhole } from '../../../../../common/styleds';\nimport AssetCard from '../../../AssetCard';\n\nconst TextPanel: React.FC = () => {\n  return (\n    <>\n      {\n        ASSET.texts.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n    </>\n  );\n};\n\nexport default TextPanel;\n","import React from 'react';\nimport { ASSET } from '../../../../../asset';\nimport { AssetCardContainer, AssetWhole } from '../../../../../common/styleds';\nimport AssetCard from '../../../AssetCard';\n\nconst TransitionPanel: React.FC = () => {\n  return (\n    <>\n      {\n        ASSET.transitions.map((item) => {\n          return (\n            <AssetWhole key={item.name}>\n              <AssetCardContainer>\n                <AssetCard data={item} />\n              </AssetCardContainer>\n              <div className=\"asset-title\">{item.name}</div>\n            </AssetWhole>\n          );\n        })\n      }\n    </>\n  );\n};\n\nexport default TransitionPanel;\n","import styled from 'styled-components';\n\nexport const StyledAssetMenu = styled.div`\n  display: flex;\n  background: #060C15;\n  width: 100%;\n  height: 80px;\n  padding-left: 10px;\n  overflow: overlay;\n`;\n","import React, { useCallback, useState } from 'react';\n// import MenuAudio from '../../../icons/MenuAudio';\n// import MenuImage from '../../../icons/MenuImage';\nimport MenuMedia from '../../../icons/MenuMedia';\nimport MenuMine from '../../../icons/MenuMine';\n// import MenuShape from '../../../icons/MenuShape';\nimport MenuText from '../../../icons/MenuText';\nimport MenuTransition from '../../../icons/MenuTransition';\n// import MenuVideo from '../../../icons/MenuVideo';\n// import AudioPanel from './components/AudioPanel';\n// import ImagePanel from './components/ImagePanel';\nimport MediaPanel from './components/MediaPanel';\nimport MenuItem from './components/MenuItem';\nimport { ResourcePanel } from './components/MenuItem/styled';\nimport MinePanel from './components/MinePanel';\n// import ShapePanel from './components/ShapePanel';\nimport TextPanel from './components/TextPanel';\nimport TransitionPanel from './components/TransitionPanel';\n// import VideoPanel from './components/VideoPanel';\nimport { StyledAssetMenu } from './styled';\n\nconst menuList = [\n  { title: '我的素材', icon: <MenuMine />, resourcePanel: <MinePanel /> },\n  { title: '转场', icon: <MenuTransition />, resourcePanel: <TransitionPanel /> },\n  { title: '文字', icon: <MenuText />, resourcePanel: <TextPanel /> },\n  // { title: '图片', icon: <MenuImage />, resourcePanel: <ImagePanel /> },\n  // { title: '声音', icon: <MenuAudio />, resourcePanel: <AudioPanel /> },\n  // { title: '视频', icon: <MenuVideo />, resourcePanel: <VideoPanel /> },\n  // { title: '形状', icon: <MenuShape />, resourcePanel: <ShapePanel /> },\n  { title: '多媒体', icon: <MenuMedia />, resourcePanel: <MediaPanel /> },\n];\n\nconst AssetMenu: React.FC = () => {\n  const [activeTab, setActiveTab] = useState<string>('多媒体');\n  const handleMenuItemClick = useCallback((title: string) => {\n    if (activeTab !== title) {\n      setActiveTab(title);\n    }\n  }, [activeTab]);\n  return (\n    <StyledAssetMenu>\n      {\n        menuList.map((item) => {\n          return (\n            <MenuItem\n              key={item.title}\n              title={item.title}\n              icon={item.icon}\n              resourcePanel={item.resourcePanel}\n              isActive={activeTab === item.title}\n              onClick={handleMenuItemClick}\n            />\n          );\n        })\n      }\n      {\n        menuList.map((item) => {\n          return (\n            <ResourcePanel\n              key={item.title}\n              style={{ ...(!(activeTab === item.title) ? { display: 'none' } : null) }}\n            >\n              {item.resourcePanel}\n            </ResourcePanel>\n          );\n        })\n      }\n    </StyledAssetMenu>\n  );\n};\n\nexport default AssetMenu;\n","import * as React from 'react';\n\nfunction IndicatorBar(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={20}\n      height={20}\n      fill=\"none\"\n      {...props}\n    >\n      <g filter=\"url(#prefix__filter0_d_437_2164)\">\n        <circle cx={10} cy={8} r={8} fill=\"#3647E4\" />\n      </g>\n      <circle cx={10} cy={8} r={5} fill=\"#2524A7\" />\n      <circle cx={10} cy={8} r={2} fill=\"#3647E4\" />\n      <defs>\n        <filter\n          id=\"prefix__filter0_d_437_2164\"\n          x={0}\n          y={0}\n          width={20}\n          height={20}\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity={0} result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy={2} />\n          <feGaussianBlur stdDeviation={1} />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.35 0\" />\n          <feBlend\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_437_2164\"\n          />\n          <feBlend\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_437_2164\"\n            result=\"shape\"\n          />\n        </filter>\n      </defs>\n    </svg>\n  );\n}\n\nexport default IndicatorBar;\n","import styled from 'styled-components';\n\nexport const StyledTrackWrapper = styled.div`\n  width: 100%;\n  height: 70px;\n  padding: 5px 0px;\n  flex-shrink: 0;\n`;\n\nexport const StyledTrack = styled.div`\n  width: 100%;\n  height: 100%;\n  /* border: 2px dashed #203351; */\n  /* border-radius: 8px; */\n  position: relative;\n  background: #13161c;\n`;\n\nexport const StyledNewPrepareTrack = styled.div`\n  height: 0;\n  position: relative;\n  pointer-events: none;\n  &::after {\n    content: '';\n    position: absolute;\n    background: #38AA26;\n    width: 100%;\n    height: 2px;\n    border-radius: 2px;\n    left: 0;\n    right: 0;\n    top: -1px;\n  }\n`;\n","import React, { useContext } from 'react';\nimport { editorContext } from '../../../..';\nimport { Clip } from '../../../../../common/types/clip';\nimport { TRACK_WRAPPER_CLASS_NAME } from '../../../../config';\nimport {\n  getTrackIndex,\n  needShowPrepareTrack,\n} from '../../../../util';\nimport { StyledNewPrepareTrack, StyledTrack, StyledTrackWrapper } from './styled';\n\ntype Props = {\n  clips: Clip[];\n  index: number;\n  style?: React.CSSProperties;\n};\n\nconst Track: React.FC<Props> = ({ style, index }) => {\n  const { hoverTrack, tracks, newTrackIndex } = useContext(editorContext);\n  const hoverIndex = getTrackIndex(hoverTrack);\n  const showPrepareTrack = needShowPrepareTrack(tracks);\n  return (\n    <>\n      {\n        showPrepareTrack && newTrackIndex === index ? <StyledNewPrepareTrack /> : null\n      }\n      <StyledTrackWrapper style={style} className={TRACK_WRAPPER_CLASS_NAME}>\n        <StyledTrack\n          style={{\n            ...(hoverIndex === index && newTrackIndex === -1 ? { background: 'rgb(18 19 20 / 50%)' } : null)\n          }}\n        >\n        </StyledTrack>\n      </StyledTrackWrapper>\n      {\n        showPrepareTrack && newTrackIndex === index + 1 ? <StyledNewPrepareTrack /> : null\n      }\n    </>\n  );\n};\n\nexport default Track;\n","import styled from 'styled-components';\n\nexport const Container = styled.div`\n  width: 100%;\n  &::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: #B61DA6;\n    opacity: 0.8;\n    z-index: 2;\n  }\n  >div {\n    position: absolute;\n    inset: 0;\n  }\n`;\n","import React, { useEffect, useRef } from 'react';\nimport { AudioClip } from '../../../../../../../common/types/clip';\nimport WaveSurfer from 'wavesurfer.js';\nimport { TRACK_HEIGHT } from '../../../../../../config';\nimport { Container } from './styled';\n\ntype Props = {\n  clip: AudioClip;\n};\n\nconst AudioTrack: React.FC<Props> = ({ clip }) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const container = containerRef.current;\n    if (container) {\n      const waveSurfer = WaveSurfer.create({\n        container: container,\n        waveColor: '#fff',\n        progressColor: 'purple',\n        fillParent: true,\n        partialRender: true,\n        interact: false,\n        height: TRACK_HEIGHT,\n        barWidth: 1,\n      });\n      waveSurfer.load(clip.url);\n      return () => {\n        waveSurfer.destroy();\n      };\n    }\n  }, [clip.url]);\n  return (\n    <Container>\n      <div ref={containerRef}></div>\n    </Container>\n  );\n};\n\nexport default AudioTrack;\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/gifToCanvas.worker.0639ec91.worker.js\");\n}\n","import React, { memo, useEffect, useRef } from 'react';\nimport { GifFrame } from '../../../../../../../common/types';\nimport { GifClip } from '../../../../../../../common/types/clip';\nimport WebWorker from '../../../../../../../workers/gifToCanvas.worker.ts';\nimport { TRACK_HEIGHT } from '../../../../../../config';\nimport { millisecondsToWidth } from '../../../../../../util';\n\ntype Props = {\n  clip: GifClip;\n};\n\nasync function drawToCanvas(\n  worker: WebWorker,\n  snapCount: number,\n  from: number,\n  to: number,\n  frames: GifFrame[],\n  width: number,\n  height: number,\n) {\n  worker.postMessage({\n    snapCount,\n    from,\n    to,\n    frames,\n    width,\n    height,\n  });\n}\n\nconst GifTrack: React.FC<Props> = ({ clip }) => {\n  const { timelineInfo, originalWidth, originalHeight, frames } = clip;\n  const snapCount = Math.ceil(millisecondsToWidth(timelineInfo.duration) / TRACK_HEIGHT);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const workerRef = useRef<WebWorker>(new WebWorker());\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const worker = workerRef.current;\n    if (canvas && worker) {\n      // @ts-ignore\n      const offscreenCanvas = canvas.transferControlToOffscreen();\n      worker.postMessage({\n        canvas: offscreenCanvas,\n      }, [offscreenCanvas]);\n    }\n  }, []);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const worker = workerRef.current;\n    if (canvas && worker) {\n      drawToCanvas(worker, snapCount, clip.playRange.start, clip.playRange.end, frames, originalWidth, originalHeight);\n    }\n  }, [frames, clip.playRange.end, clip.playRange.start, snapCount, originalWidth, originalHeight]);\n  return (\n    <div style={{ width: '100%' }}>\n      <div style={{ position: 'absolute', left: 0, right: 0, top: 0, bottom: 0 }}>\n        <canvas\n          ref={canvasRef}\n          style={{ transformOrigin: 'left top', transform: `scale(${TRACK_HEIGHT / originalHeight})` }}\n          width={snapCount * originalWidth}\n          height={originalHeight}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default memo(GifTrack);\n","import React, { useMemo } from 'react';\nimport { ImageClip } from '../../../../../../../common/types/clip';\n\ntype Props = {\n  clip: ImageClip;\n};\n\nconst ImageTrack: React.FC<Props> = ({ clip }) => {\n  const style = useMemo(() => {\n    return {\n      position: 'absolute',\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n      background: `url(${clip.blobUrl})`,\n      backgroundRepeat: 'repeat',\n      backgroundSize: 'contain',\n    } as React.CSSProperties;\n  }, [clip.blobUrl]);\n  return (\n    <div style={{ width: '100%' }}>\n      <div style={style}></div>\n    </div>\n  );\n};\n\nexport default ImageTrack;\n","import React, { useEffect, useRef } from 'react';\nimport { VideoClip } from '../../../../../../../common/types/clip';\nimport { TRACK_HEIGHT } from '../../../../../../config';\nimport { millisecondsToWidth } from '../../../../../../util';\n\ntype Props = {\n  clip: VideoClip;\n};\n\nfunction seekVideo(video: HTMLVideoElement, currentTime: number) {\n  return new Promise((resolve) => {\n    function seeked() {\n      resolve(true);\n    }\n    // @ts-ignore\n    video.requestVideoFrameCallback(seeked);\n    video.currentTime = currentTime / 1000;\n  });\n}\n\nasync function drawVideoToCanvas(\n  canvas: HTMLCanvasElement,\n  videoUrl: string,\n  snapWidth: number,\n  snapHeight: number,\n  snapCount: number,\n  from: number,\n  to: number,\n) {\n  const timeStep = (to - from) / snapCount;\n  const ctx = canvas.getContext('2d');\n  const video = document.createElement('video');\n  video.src = videoUrl;\n  let index = 0;\n  while (index < snapCount) {\n    await seekVideo(video, from + timeStep * index + 1);\n    ctx?.drawImage(video, snapWidth * index, 0, snapWidth, snapHeight);\n    index += 1;\n  }\n}\n\nconst VideoTrack: React.FC<Props> = ({ clip }) => {\n  const { timelineInfo, originalWidth, originalHeight, playRange, blobUrl } = clip;\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const { width, height: snapHeight } = canvas.getBoundingClientRect();\n      const snapWidth = snapHeight * originalWidth / originalHeight;\n      const snapCount = Math.ceil(width / snapWidth); // 需要展示多少snap\n      drawVideoToCanvas(canvas, blobUrl, snapWidth, snapHeight, snapCount, playRange.start, playRange.end);\n    }\n  }, [blobUrl, playRange.end, playRange.start, originalHeight, originalWidth, timelineInfo.duration]);\n  return (\n    <div style={{ width: '100%' }}>\n      <div style={{ position: 'absolute', left: 0, right: 0, top: 0, bottom: 0 }}>\n        <canvas\n          ref={canvasRef}\n          width={millisecondsToWidth(timelineInfo.duration)}\n          height={TRACK_HEIGHT}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default VideoTrack;\n","import React from 'react';\nimport { TextClip } from '../../../../../../../common/types/clip';\nimport { TRACK_HEIGHT } from '../../../../../../config';\n\ntype Props = {\n  clip: TextClip;\n};\n\nconst TextTrack: React.FC<Props> = ({ clip }) => {\n  const { value } = clip;\n\n  return (\n    <div style={{ width: '100%' }}>\n      <div\n        style={{\n          position: 'absolute',\n          left: 20,\n          right: 20,\n          lineHeight: `${TRACK_HEIGHT}px`,\n          color: '#fff',\n          overflow: 'hidden',\n          whiteSpace: 'nowrap',\n          textOverflow: 'ellipsis',\n        }}\n        title={value}\n      >\n        {value}\n      </div>\n    </div>\n  );\n};\n\nexport default TextTrack;","import styled from 'styled-components';\n\nexport const StyledTrackElement = styled.div`\n  /* background-color: #22a5df; */\n  border-radius: 4px;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  overflow: hidden;\n  display: flex;\n  border: 2px solid transparent;\n  transition: border-color 0.3s;\n  &::after {\n    content: '';\n    position: absolute;\n    z-index: 3;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    border-radius: 4px;\n    border-style: solid;\n    border-color: #fff;\n    border-width: 0;\n    transition: border-width 0.05s;\n    pointer-events: none;\n  }\n  &:hover::after {\n    border-width: 2px;\n  }\n  &.active::after {\n    border-width: 2px;\n    border-color: #5754ff;\n  }\n`;\n\nexport const StyledLeftHandler = styled.div`\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  left: 0;\n  top: 0;\n  bottom: 0;\n`;\n\nexport const StyledRightHandler = styled.div`\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n`;\n\nexport const StyledName = styled.div`\n  color: #fff;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n  flex-grow: 1;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n`;\n\nexport const StyledHandle = styled.div`\n  background: #5754ff;\n  width: 12px;\n  cursor: ew-resize;\n  flex-shrink: 0;\n  position: relative;\n  z-index: 3;\n\n  &::before, &::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 3px;\n    transform: translateY(-50%);\n    width: 2px;\n    height: 15px;\n    background: #2524A7;\n    border-radius: 1px;\n    pointer-events: none;\n  }\n  &::after {\n    left: 7px;\n  }\n`;\n","import React, { memo, useCallback, useContext } from 'react';\nimport { editorContext } from '../../../..';\nimport Draggable from '../../../../../common/components/Draggable';\nimport { MoveDirection } from '../../../../../common/components/Draggable/config';\nimport { DragInfo } from '../../../../../common/components/Draggable/type';\nimport { Asset } from '../../../../../common/types/asset';\nimport { AudioClip, Clip, ClipType, GifClip, ImageClip, VideoClip, TextClip } from '../../../../../common/types/clip';\nimport { TRACK_OUTER_HEIGHT } from '../../../../config';\nimport {\n  adjustStartAndEnd,\n  cursorPositionToTracksWrapperPosition,\n  getAvailableStartAndEnd,\n  getClipInsertIndex,\n  getTrackAndClipIndex,\n  getTrackInfoForDrag,\n  isTransitionEnd,\n  isTransitionStart,\n  millisecondsToWidth,\n  needShowPrepareTrack,\n  widthToMilliseconds,\n} from '../../../../util';\nimport AudioTrack from './components/AudioTrack';\nimport GifTrack from './components/GifTrack';\nimport ImageTrack from './components/ImageTrack';\nimport VideoTrack from './components/VideoTrack';\nimport TextTrack from './components/TextTrack';\nimport { StyledHandle, StyledName, StyledTrackElement } from './styled';\n\nconst transitionStyle = {\n  zIndex: 999,\n  border: '2px solid #fff',\n};\n\nfunction getTrackComponent(clip: Clip) {\n  switch (clip.type) {\n    case ClipType.VIDEO:\n      return <VideoTrack clip={clip as VideoClip} />;\n    case ClipType.GIF:\n      return <GifTrack clip={clip as GifClip} />;\n    case ClipType.AUDIO:\n      return <AudioTrack clip={clip as AudioClip} />;\n    case ClipType.IMAGE:\n      return <ImageTrack clip={clip as ImageClip} />;\n    case ClipType.TEXT:\n      return <TextTrack clip={clip as TextClip} />;\n    default:\n      return <StyledName>{clip.name}</StyledName>;\n  }\n}\n\ninterface Props {\n  clip: Clip;\n  trackIndex: number;\n  onUpdate?(data: Partial<Clip>, trackIndex: number, clipIndex: number, isNewTrack: boolean): void;\n}\n\nconst TrackElement: React.FC<Props> = ({ clip, onUpdate, trackIndex }) => {\n  const { timelineInfo, id, type } = clip;\n  const {\n    setHoverTrack,\n    tracks,\n    setTracks,\n    setNewTrackIndex,\n    newTrackIndex,\n    activeClip,\n    setActiveClip,\n  } = useContext(editorContext);\n\n  const handleTransition = useCallback((dragInfo: DragInfo<Asset>) => {\n    if (dragInfo.stepLeft !== 0 || dragInfo.stepTop !== 0) {\n      const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, id);\n      if (isTransitionStart(tracks, id)) {\n        // 删除transition\n        tracks[trackIndex].splice(clipIndex + 1, 1);\n        setTracks([...tracks]);\n      } else if (isTransitionEnd(tracks, id)) {\n        // 删除transition\n        tracks[trackIndex].splice(clipIndex - 1, 1);\n        setTracks([...tracks]);\n      }\n    }\n  }, [id, setTracks, tracks]);\n\n  const handleMove = useCallback((dragInfo: DragInfo<Asset>) => {\n    if (!dragInfo.belowElement) {\n      return;\n    }\n\n    handleTransition(dragInfo);\n\n    const { trackElement, index: trackIndex, isTop, isBottom } = getTrackInfoForDrag(dragInfo.belowElement, dragInfo.cursorLeft, dragInfo.cursorTop);\n    if (trackElement && trackIndex >= 0) {\n      const showPrepareTrack = needShowPrepareTrack(tracks);\n      if (isTop && showPrepareTrack) {\n        setNewTrackIndex(trackIndex);\n      } else if (isBottom && showPrepareTrack) {\n        setNewTrackIndex(trackIndex + 1);\n      } else {\n        setNewTrackIndex(-1);\n      }\n    }\n    setHoverTrack(trackElement as HTMLElement);\n  }, [handleTransition, setHoverTrack, setNewTrackIndex, tracks]);\n\n  const handleEnd = useCallback((dragInfo: DragInfo<Asset>) => {\n    if (!dragInfo.belowElement) {\n      return;\n    }\n    if (dragInfo.isMoved) {\n      const { trackElement, index: trackIndex } = getTrackInfoForDrag(dragInfo.belowElement, dragInfo.cursorLeft, dragInfo.cursorTop);\n      const pos = cursorPositionToTracksWrapperPosition({ x: dragInfo.cursorLeft, y: dragInfo.cursorTop });\n      let newStart = widthToMilliseconds(Math.max(0, pos.x - (dragInfo.cursorLeft - dragInfo.left)));\n      let updated = false;\n      if (newTrackIndex > -1) {\n        updated = true;\n        onUpdate?.({\n          timelineInfo: {\n            ...timelineInfo,\n            start: newStart, \n            end: newStart + timelineInfo.duration \n          },\n        }, newTrackIndex, 0, true);\n      } else if (trackElement) {\n        const { trackIndex: originalTrackIndex } = getTrackAndClipIndex(tracks, id);\n        let track = tracks[trackIndex];\n        if (trackIndex === originalTrackIndex) {\n          track = track.filter((item) => item.id !== id);\n        }\n        if (trackIndex > -1 && track) {\n          const prepareInsertIndex = getClipInsertIndex(widthToMilliseconds(pos.x), track);\n          if (prepareInsertIndex > -1) {\n            const availableDuration = getAvailableStartAndEnd(prepareInsertIndex, track);\n            if (availableDuration.start || availableDuration.end) {\n              const [start, end] = adjustStartAndEnd(\n                [availableDuration.start, availableDuration.end],\n                [newStart, newStart + timelineInfo.duration]\n              );\n              updated = true;\n              onUpdate?.({\n                timelineInfo: {\n                  start,\n                  end,\n                  duration: end - start,\n                },\n              }, trackIndex, prepareInsertIndex, false);\n            }\n          }\n        }\n      }\n      // 删除transition之后可能会错位，需要修正\n      if (!updated) {\n        const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, id);\n        const before = tracks[trackIndex][clipIndex - 1];\n        const after = tracks[trackIndex][clipIndex + 1];\n        if ((before && before.timelineInfo.end > timelineInfo.start) || (after && after.timelineInfo.start < timelineInfo.end)) {\n          const newRange = adjustStartAndEnd(\n            [before?.timelineInfo?.end || 0, after?.timelineInfo?.start || 10e9],\n            [timelineInfo.start, timelineInfo.end]\n          );\n          onUpdate?.({\n            timelineInfo: {\n              start: newRange[0],\n              end: newRange[1],\n              duration: newRange[1] - newRange[0],\n            },\n          }, trackIndex, clipIndex, false);\n        }\n      }\n    }\n    setNewTrackIndex(-1);\n    setHoverTrack(null);\n  }, [id, newTrackIndex, onUpdate, timelineInfo, setHoverTrack, setNewTrackIndex, tracks]);\n\n  const handleLeftHandleMove = useCallback((dragInfo: DragInfo<Asset>) => {\n    const newStart = timelineInfo.start + widthToMilliseconds(dragInfo.stepLeft);\n    if (timelineInfo.end - newStart >= 500) {\n      const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, id);\n      const preClipEnd = tracks[trackIndex][clipIndex - 1]?.timelineInfo?.end || 0;\n      onUpdate?.({\n        timelineInfo: {\n          ...timelineInfo,\n          start: Math.max(newStart, preClipEnd),\n          duration: timelineInfo.end - Math.max(newStart, preClipEnd),\n        },\n      }, trackIndex, clipIndex, false);\n    }\n  }, [id, onUpdate, timelineInfo, tracks]);\n\n  const handleRightHandleMove = useCallback((dragInfo: DragInfo<Asset>) => {\n    const newEnd = timelineInfo.end + widthToMilliseconds(dragInfo.stepLeft);\n    if (newEnd - timelineInfo.start >= 500) {\n      const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, id);\n      const nextClipStart = tracks[trackIndex][clipIndex + 1]?.timelineInfo?.start || 10e9;\n      onUpdate?.({\n        timelineInfo: {\n          ...timelineInfo,\n          end: Math.min(newEnd, nextClipStart),\n          duration: Math.min(newEnd, nextClipStart) - timelineInfo.start,\n        },\n      }, trackIndex, clipIndex, false);\n    }\n  }, [timelineInfo, tracks, id, onUpdate]);\n\n  /**\n   * 拖拽结束的时候更新duration\n   */\n  const handleHandleEnd = useCallback(() => {\n    const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, id);\n    onUpdate?.({\n      timelineInfo: {\n        ...timelineInfo,\n        duration: timelineInfo.end - timelineInfo.start,\n      },\n    }, trackIndex, clipIndex, false);\n  }, [id, onUpdate, timelineInfo, tracks]);\n\n  const handleClick = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, id);\n    setActiveClip(tracks?.[trackIndex]?.[clipIndex]);\n  }, [id, setActiveClip, tracks]);\n\n  const isTransition = type === ClipType.TRANSITION;\n  const isActive = activeClip?.id === id;\n\n  return (\n    <Draggable\n      scrollContainerSelector=\".tracks-wrapper\"\n      autoGrow={true}\n      slow={2}\n      onMove={handleMove}\n      onEnd={handleEnd}\n      enable={!isTransition}\n    >\n      <StyledTrackElement\n        className={`track-element ${isActive ? 'active' : ''}`}\n        onClick={handleClick}\n        style={{\n          top: `calc(50% - ${tracks.length * 70 / 2}px + 5px + ${trackIndex * 70}px)`,\n          width: millisecondsToWidth(timelineInfo.end - timelineInfo.start),\n          height: TRACK_OUTER_HEIGHT,\n          left: millisecondsToWidth(timelineInfo.start),\n          ...( type === ClipType.TRANSITION ? transitionStyle : null ),\n        }}\n      >\n        {\n          !isTransition && !isTransitionEnd(tracks, id) && isActive ? <StyledHandle>\n            <Draggable\n              direction={MoveDirection.EW}\n              onMove={handleLeftHandleMove}\n              onEnd={handleHandleEnd}\n            >\n              <div style={{ width: '100%', height: '100%' }}></div>\n            </Draggable>\n          </StyledHandle> : null\n        }\n        {getTrackComponent(clip)}\n        {\n          !isTransition && !isTransitionStart(tracks, id) && isActive ? <StyledHandle>\n            <Draggable\n              direction={MoveDirection.EW}\n              onMove={handleRightHandleMove}\n              onEnd={handleHandleEnd}\n            >\n              <div style={{ width: '100%', height: '100%' }}></div>\n            </Draggable>\n          </StyledHandle> : null\n        }\n      </StyledTrackElement>\n    </Draggable>\n  );\n};\n\nexport default memo(TrackElement);\n","import styled from 'styled-components';\n\nexport const StyledTracksWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  padding: 10px 20px;\n  position: relative;\n  overflow-y: auto;\n  overscroll-behavior: unset;\n  background: #000;\n`;\n\nexport const StyledTracks = styled.div`\n  flex: 1 1 0%;\n  display: flex;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  justify-content: center;\n  position: relative;\n  /* top: 50%; */\n  /* transform: translateY(-50%); */\n`;\n\nexport const StyledIndicator = styled.div`\n  width: 0;\n  top: 40px;\n  bottom: 4px;\n  position: absolute;\n  /* cursor: move; */\n  z-index: 1000;\n  pointer-events: none;\n\n  &::before {\n    content: '';\n    width: 2px;\n    background-color: #3A36E4;\n    opacity: 0.8;\n    left: -1px;\n    top: -26px;\n    bottom: 0;\n    border-radius: 2px;\n    position: absolute;\n  }\n\n  .indicator-bar {\n    position: absolute;\n    top: -40px;\n    left: -10px;\n  }\n`;\n","import React, { useCallback, useContext } from 'react';\nimport { editorContext } from '../..';\nimport { Clip, ClipType } from '../../../common/types/clip';\nimport IndicatorBar from '../../../icons/IndicatorBar';\nimport { canWithTransition, cursorPositionToTracksWrapperPosition, getTotalDuration, getTrackAndClipIndex, isClipsNext, millisecondsToWidth, widthToMilliseconds } from '../../util';\nimport Track from './components/Track';\nimport TrackElement from './components/TrackElement';\nimport { StyledTrackElement } from './components/TrackElement/styled';\nimport { StyledIndicator, StyledTracks, StyledTracksWrapper } from './styled';\n\ntype Props = {\n  onCurrentTimeChange(currentTime: number): void;\n};\n\nconst Tracks: React.FC<Props> = ({ onCurrentTimeChange }) => {\n  const { tracks, currentTime, draggingClip, setTracks } = useContext(editorContext);\n  const trackStyle: React.CSSProperties = tracks.length === 1 && tracks[0].length === 0 ? { height: 90 } : {};\n\n  const handleCurrentTimeChange = useCallback((x: number, y: number, width: number) => {\n    const totalDuration = getTotalDuration(tracks);\n    const pos = cursorPositionToTracksWrapperPosition({ x, y });\n    const newCurrentTime = widthToMilliseconds(Math.max(0, pos.x - width));\n    onCurrentTimeChange(Math.min(newCurrentTime, totalDuration));\n  }, [onCurrentTimeChange, tracks]);\n\n  const handleTracksWrapperClick = useCallback((e: React.MouseEvent) => {\n    handleCurrentTimeChange(e.pageX, e.pageY, 0);\n  }, [handleCurrentTimeChange]);\n\n  const handleUpdate = useCallback((oldData: Clip, newData: Partial<Clip>, newTrackIndex: number, newClipIndex: number, isNewTrack: boolean) => {\n    // 获取原数据所在索引\n    const { trackIndex, clipIndex } = getTrackAndClipIndex(tracks, oldData.id);\n    if (trackIndex > -1 && clipIndex > -1) {\n      // 删除原clip\n      const oldData = tracks[trackIndex].splice(clipIndex, 1)[0];\n      Object.assign(oldData, newData);\n      if (isNewTrack) {\n        tracks.splice(newTrackIndex, 0, [oldData]);\n      } else {\n        tracks[newTrackIndex].splice(newClipIndex, 0, oldData);\n      }\n      setTracks([...tracks]);\n    }\n  }, [setTracks, tracks]);\n\n  const isDraggingTransition = draggingClip?.type === ClipType.TRANSITION;\n  const flatClips = tracks.flat(1);\n\n  return (\n    <>\n      <StyledTracksWrapper className=\"tracks-wrapper\" onClick={handleTracksWrapperClick}>\n        <StyledTracks\n          // style={{ top: `calc(50% - ${tracks.length * 35}px)` }}\n        >\n          {\n            tracks.map((clips, index) => {\n              return (\n                <Track index={index} clips={clips} key={index} style={trackStyle} />\n              );\n            })\n          }\n          {\n            flatClips.map((clip, index) => {\n              const { trackIndex } = getTrackAndClipIndex(tracks, clip.id);\n              const nextClip = flatClips[index + 1];\n              let showTransitionPrepareInsert = false;\n              if (isDraggingTransition && isClipsNext(clip, nextClip)) {\n                if (canWithTransition(clip?.type) && canWithTransition(nextClip?.type)) {\n                  showTransitionPrepareInsert = true;\n                }\n              }\n              return (\n                <React.Fragment key={clip.id}>\n                  <TrackElement\n                    trackIndex={trackIndex}\n                    clip={clip}\n                    onUpdate={(data: Partial<Clip>, newTrackIndex: number, newClipIndex: number, isNewTrack: boolean) => {\n                      handleUpdate(clip, data, newTrackIndex, newClipIndex, isNewTrack);\n                    }}\n                  />\n                  {\n                    showTransitionPrepareInsert && draggingClip ? <StyledTrackElement\n                      className=\"transition-insert\"\n                      data-from={clip.id}\n                      data-to={nextClip.id}\n                      style={{\n                        width: millisecondsToWidth(draggingClip.timelineInfo.duration),\n                        left: millisecondsToWidth(clip.timelineInfo.end - draggingClip.timelineInfo.duration / 2),\n                        zIndex: 999,\n                        opacity: 0.5,\n                        border: '2px solid #fff',\n                      }}\n                    /> : null\n                  }\n                </React.Fragment>\n              );\n            })\n          }\n        </StyledTracks>\n      </StyledTracksWrapper>\n      <StyledIndicator style={{ left: millisecondsToWidth(currentTime) + 20 }}>\n        <IndicatorBar className=\"indicator-bar\" />\n      </StyledIndicator>\n    </>\n  );\n};\n\nexport default Tracks;\n","import styled from 'styled-components';\n\nexport const StyledEditor = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  user-select: none;\n  overflow: hidden;\n`;\n\nexport const AssetAndStage = styled.div`\n  display: flex;\n  height: 55%;\n  flex-shrink: 0;\n`;\n\nexport const AssetPanel = styled.div`\n  display: flex;\n  flex-shrink: 0;\n  height: 100%;\n  width: 740px;\n  position: relative;\n  z-index: 2000;\n  background: #1A212A;\n  border-right: 1px solid #232A35;\n\n  @media (max-width: 1650px) {\n    width: 500px\n  }\n\n  @media (max-width: 1280px) {\n    width: 261px;\n  }\n`;\n\nexport const TimelineWrapper = styled.div`\n  background-color: #14181D;\n  overflow: hidden;\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n  position: relative;\n`;\n\nexport const TracksScrollContainer = styled.div`\n  overflow-x: overlay;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  position: relative;\n  padding-top: 10px;\n  background: #1C2430;\n`;\n\nexport const Stage = styled.div`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  align-items: center;\n  justify-content: center;\n  margin: 0 45px;\n  position: relative;\n`;\n\nexport const PlayerContainer = styled.div`\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 16px;\n  bottom: 65px;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  canvas {\n    background: #000;\n  }\n`;\n","import styled from 'styled-components';\n\nexport const StyledRuler = styled.div`\n  padding: 0 20px;\n  height: 30px;\n  display: flex;\n  overflow: hidden;\n  flex-grow: 0;\n  flex-shrink: 0;\n  background: #1C2430;\n  border-top: 1px solid #14171B;\n  border-bottom: 1px solid #232A35;\n  /* box-shadow: 0px 12px 16px rgba(0, 0, 0, 0.14); */\n`;\n\nexport const StyledRulerItem = styled.div`\n  position: relative;\n  height: 20px;\n  padding: 14px 5px;\n  font-size: 12px;\n  line-height: 12px;\n  font-family: 'DIN Alternate';\n  color: #7185A6;\n  flex-grow: 0;\n  flex-shrink: 0;\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    height: 10px;\n    background-color: #39485f;\n  }\n  &::after {\n    content: '';\n    position: absolute;\n    left: 50%;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    height: 6px;\n    background: #2d394c;\n  }\n`;\n\n","import React, { useEffect, useState } from 'react';\nimport { formatMillisecond } from '../../../common/utils';\nimport { SECOND_WIDTH } from '../../config';\nimport { StyledRuler, StyledRulerItem } from './styled';\n\nconst Ruler: React.FC = () => {\n  const [width, setWidth] = useState(0);\n  useEffect(() => {\n    const tracksWrapper = document.querySelector('.tracks-wrapper') as HTMLElement;\n    if (tracksWrapper) {\n      setWidth(tracksWrapper.clientWidth);\n      const observer = new ResizeObserver(() => {\n        const tracksWrapperWidth = tracksWrapper.clientWidth;\n        if (tracksWrapperWidth !== width) {\n          setWidth(tracksWrapper.clientWidth);\n        }\n      });\n      observer.observe(tracksWrapper)\n      return () => {\n        observer.disconnect();\n      };\n    }\n  }, [width]);\n  return (\n    <StyledRuler style={{ width }}>\n      {\n        Array.from(Array(Math.ceil(width / SECOND_WIDTH))).map((value, index) => {\n          return (\n            <StyledRulerItem key={index} style={{ width: SECOND_WIDTH }}>\n              {formatMillisecond(index * 1000, false, false)}\n            </StyledRulerItem>\n          );\n        })\n      }\n    </StyledRuler>\n  );\n};\n\nexport default Ruler;\n","import { EditorContext, PlayerContext } from '../type';\nimport { deleteSelectedClip, splitSelectedClip } from '../util';\nimport { useKeyPress } from 'ahooks';\n\nexport const useDeleteClip = (editorContextValue: EditorContext) => {\n  useKeyPress('Backspace', () => {\n    deleteSelectedClip(editorContextValue);\n  });\n};\n\n/**\n * 切分当前选中的clip\n */\nexport const useSplitClip = (editorContextValue: EditorContext) => {\n  useKeyPress('ctrl.c', () => {\n    splitSelectedClip(editorContextValue);\n  });\n};\n\n/**\n * 播放/暂停\n */\n export const usePlayControl = (editorContextValue: EditorContext, playerContext: PlayerContext) => {\n  useKeyPress(' ', () => {\n    const { isPlaying } = editorContextValue;\n    playerContext.handleIsPlayingChange(!isPlaying);\n  });\n};\n\nexport const useKeyboard = (editorContextValue: EditorContext, playerContext: PlayerContext) => {\n  useDeleteClip(editorContextValue);\n  useSplitClip(editorContextValue);\n  usePlayControl(editorContextValue, playerContext);\n};\n","import * as THREE from 'three';\nimport { getPixelRatio } from '../../common/utils';\n\nexport default class Painter {\n  private scene: THREE.Scene;\n  private camera: THREE.Camera;\n  private renderer: THREE.WebGLRenderer;\n  private maxAnisotropy: number;\n\n  constructor(width: number, height: number) {\n    this.scene = new THREE.Scene();\n    this.camera = this.createCamera(0, width, 0, height);\n    this.renderer = new THREE.WebGLRenderer({\n      preserveDrawingBuffer: true,\n      antialias: true,\n      alpha: true,\n    });\n    this.renderer.setPixelRatio(getPixelRatio());\n    this.renderer.setSize(width, height);\n    this.renderer.outputEncoding = THREE.sRGBEncoding;\n    this.renderer.shadowMap.enabled = true;\n    this.maxAnisotropy = this.renderer.capabilities.getMaxAnisotropy();\n  }\n\n  public createCamera(left: number, right: number, top: number, bottom: number) {\n    return new THREE.OrthographicCamera(left, right, top, bottom, -1000, 1000);\n  }\n\n  public updateSize(width: number, height: number) {\n    this.renderer.setSize(width, height);\n    this.camera = this.createCamera(0, width, 0, height);\n  }\n\n  public add(sprite: THREE.Mesh, name: string) {\n    sprite.name = name;\n    this.scene.add(sprite);\n  }\n\n  public remove(name: string) {\n    const selectedObject = this.scene.getObjectByName(name);\n    if (selectedObject) {\n      this.scene.remove(selectedObject);\n    }\n  }\n\n  public getRealSize() {\n    const result = new THREE.Vector2();\n    this.renderer.getDrawingBufferSize(result);\n    return result;\n  }\n\n  public getDomElement() {\n    return this.renderer.domElement;\n  }\n\n  public render(target?: THREE.RenderTarget, specificScene?: THREE.Scene, specificCamera?: THREE.Camera) {\n    const { renderer, scene, camera } = this;\n    if (target && specificScene && specificCamera) {\n      renderer.setRenderTarget(target);\n      renderer.render(specificScene, specificCamera);\n    } else {\n      renderer.setRenderTarget(null); // 输出到canvas\n      renderer.render(scene, camera);\n    }\n  }\n}\n","import Painter from './painter';\nimport { Clip, ClipType } from '../common/types/clip';\nimport { ClipBase } from './clips/base';\nimport { createClip } from './util';\nimport { watch } from '../common/utils/watch';\nimport { Transition } from './clips/transition';\n\ntype Props = {\n  width: number;\n  height: number;\n  onCurrentTimeChange?(currentTime: number): void;\n  onEnd?(): void;\n};\n\nexport default class Player {\n  // 自动播放相关\n  private tickTime = 0;\n  private rafId = 0;\n  private tickFunc;\n\n  private onCurrentTimeChangeCallback?: (currentTime: number) => void;\n  private onEnd?: () => void;\n\n  public painter: Painter;\n  public clips: ClipBase<Clip>[] = [];\n\n  /**\n   * 播放相关属性\n   */\n  public currentTime = 0;\n  public duration = 0;\n  public isPlaying = false;\n  public width = 0;\n  public height = 0;\n\n  constructor({ width, height, onCurrentTimeChange, onEnd }: Props) {\n    this.width = width;\n    this.height = height;\n    this.painter = new Painter(width, height);\n    this.onCurrentTimeChangeCallback = onCurrentTimeChange;\n    this.onEnd = onEnd;\n    this.tickFunc = this.tick.bind(this);\n    this.rafId = requestAnimationFrame(this.tickFunc);\n  }\n\n  private async tick(time: number) {\n    await this.render(time);\n    this.rafId = requestAnimationFrame(this.tickFunc);\n  }\n\n  public isInRange(clip: ClipBase<Clip>) {\n    const { start, end } = clip.config.timelineInfo;\n    return start <= this.currentTime && end >= this.currentTime;\n  }\n\n  public updateResolution(width: number, height: number): boolean {\n    if (width === this.width && height === this.height) {\n      return false;\n    }\n    this.width = width;\n    this.height = height;\n    this.painter.updateSize(width, height);\n    return true;\n  }\n\n  public updateDuration() {\n    this.duration = 0;\n    this.clips.forEach(({ config }) => {\n      if (config.timelineInfo.end > this.duration) {\n        this.duration = config.timelineInfo.end;\n      }\n    });\n    if (this.duration === 0) {\n      this.currentTime = 0;\n    }\n  }\n\n  public getClipById(id?: string) {\n    return this.clips.find((clip) => clip.config.id === id);\n  }\n\n  public async addClip(clip: Clip) {\n    const newClip = createClip(clip, this) as ClipBase<Clip>;\n    await newClip.init();\n    this.clips.push(newClip);\n    await this.onCurrentTimeChange();\n    this.updateDuration();\n\n    // 位置改变时\n    watch(newClip.config, 'timelineInfo', async (val) => {\n      newClip.updatePlaybackRate();\n      if (this.isInRange(newClip)) {\n        if (newClip.isEntered) {\n          await newClip.onUpdate(true);\n        } else {\n          newClip.isEntered = true;\n          newClip.addToPainter();\n          await newClip.onEnter(true);\n        }\n      } else {\n        if (newClip.isEntered) {\n          newClip.isEntered = false;\n          newClip.removeFromPainter();\n          await newClip.onLeave(true);\n        }\n      }\n    });\n    // watch(newClip.config, 'playRange', async () => {\n    //   await newClip.onUpdate(true);\n    // });\n  }\n\n  public async removeClip(id?: string) {\n    const clip = this.getClipById(id);\n    if (clip) {\n      await clip.destroy();\n      if (clip.config.type === ClipType.TRANSITION) {\n        const fromClip = this.getClipById((clip as Transition).config.fromId);\n        const toClip = this.getClipById((clip as Transition).config.toId);\n        fromClip?.show();\n        toClip?.show();\n      }\n      this.clips.splice(this.clips.indexOf(clip), 1);\n      this.updateDuration();\n    }\n  }\n\n  private async render(time: number) {\n    const intTime = Math.floor(time); // 转为整数\n    if (this.isPlaying) {\n      this.currentTime += intTime - this.tickTime;\n      this.currentTime = Math.min(this.currentTime, this.duration);\n      await this.onCurrentTimeChange();\n      if (this.currentTime >= this.duration) {\n        this.pause();\n        this.onEnd?.();\n      }\n    }\n    this.painter.render();\n    this.tickTime = intTime;\n  }\n\n  /**\n   * 播放\n   */\n  public async play() {\n    if (!this.isPlaying && this.currentTime < this.duration) {\n      this.isPlaying = true;\n      this.clips.forEach((clip) => {\n        if (this.isInRange(clip)) {\n          clip.play();\n        }\n      });\n    }\n  }\n\n  /**\n   * 暂停\n   */\n  public async pause() {\n    if (this.isPlaying) {\n      this.isPlaying = false;\n      this.clips.forEach((clip) => {\n        clip.pause();\n      });\n    }\n  }\n\n  /**\n   * 手动更新时间戳\n   */\n  public async setCurrentTime(currentTime: number) {\n    this.currentTime = Math.max(0, Math.min(currentTime, this.duration));\n    await this.onCurrentTimeChange(true);\n    if (this.currentTime >= this.duration) {\n      this.pause();\n      this.onEnd?.();\n    }\n  }\n\n  /**\n   * 时间戳变化\n   */\n  private async onCurrentTimeChange(isManual: boolean = false) {\n    let task: Promise<void>[] = [];\n    this.clips.forEach((clip) => {\n      if (this.isInRange(clip)) {\n        if (clip.isEntered) {\n          task.push(clip.onUpdate(isManual));\n        } else {\n          clip.isEntered = true;\n          clip.addToPainter();\n          task.push(clip.onEnter(isManual));\n        }\n      } else {\n        if (clip.isEntered) {\n          clip.isEntered = false;\n          clip.removeFromPainter();\n          task.push(clip.onLeave(isManual));\n        }\n      }\n    });\n    await Promise.all(task).catch((error) => {\n      alert(error.message);\n    });\n    task = [];\n    this.onCurrentTimeChangeCallback?.(this.currentTime);\n  }\n\n  /**\n   * 将播放器插入到指定节点\n   */\n  public attachTo(container: HTMLElement) {\n    container?.appendChild(this.painter.getDomElement());\n  }\n\n  /**\n   * 销毁播放器\n   */\n  public async destroy() {\n    cancelAnimationFrame(this.rafId);\n    let task: Promise<void>[] = [];\n    this.clips.forEach((clip) => {\n      task.push(clip.destroy());\n    });\n    await Promise.all(task).catch((error) => {\n      alert(error.message);\n    });\n    task = [];\n    this.clips.length = 0;\n    this.clips = [];\n    const canvas = this.painter.getDomElement();\n    if (canvas) {\n      canvas.parentNode?.removeChild(canvas);\n    }\n  }\n}\n","import { useDebounceEffect, useSize } from 'ahooks';\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport { Clip } from '../../common/types/clip';\nimport Player from '../../player';\nimport { ClipBase } from '../../player/clips/base';\nimport { getClipRenderInfo } from '../../player/util';\nimport { EditorContext, PlayerContext } from '../type';\nimport { getPlayerResolution } from '../util';\n\n/**\n * 找出tracks出现了哪些改变\n */\nconst findDiff = (playerData: ClipBase[], newData: Clip[][]) => {\n  const newClips: Clip[] = [];\n  const deleteClips: string[] = [];\n  const flatNewData = newData.flat(1);\n  playerData.forEach((instance) => {\n    const newClip = flatNewData.find((clip) => clip.id === instance.config.id);\n    if (!newClip && instance.config.id) { // 表示删除\n      deleteClips.push(instance.config.id);\n    }\n  });\n  flatNewData.forEach((clip) => {\n    const oldClip = playerData.find((item) => item.config.id === clip.id);\n    if (!oldClip) {\n      newClips.push(clip);\n    }\n  });\n  return {\n    newClips,\n    deleteClips,\n  };\n}\n\n/**\n * clips增删\n */\nconst tracksChanged = async (player: Player, newClips: Clip[], deleteClips: string[]) => {\n  if (player) {\n    const task: Promise<void>[] = [];\n    newClips.forEach((clip) => {\n      task.push(player?.addClip(clip));\n    });\n    deleteClips.forEach((id) => {\n      task.push(player.removeClip(id));\n    });\n    await Promise.all(task).catch((error) => {\n      alert(error.message);\n    });\n  }\n};\n\nexport const usePlayer = (\n  editorContextValue: EditorContext,\n  containerRef: React.RefObject<HTMLDivElement>,\n): PlayerContext => {\n  const playerRef = useRef<Player>();\n  const {\n    tracks,\n    totalDuration,\n    currentTime,\n    setCurrentTime,\n    isPlaying,\n    setIsPlaying,\n    ratio,\n    setActiveClip,\n  } = editorContextValue;\n\n  const { width: containerWidth, height: containerHeight } = useSize(containerRef);\n\n  useDebounceEffect(() => {\n    const player = playerRef.current;\n    if (player && containerWidth && containerHeight) {\n      const { width, height } = getPlayerResolution(ratio, containerWidth, containerHeight);\n      if (player.updateResolution(width, height)) {\n        setActiveClip(undefined);\n        tracks.forEach((clips) => {\n          clips.forEach((clip) => {\n            player.removeClip(clip.id);\n          });\n        });\n        tracks.forEach((clips) => {\n          clips.forEach((clip) => {\n            const renderInfo = getClipRenderInfo(clip, width, height);\n            Object.assign(clip.geometryInfo, {\n              ...clip.geometryInfo,\n              size: {\n                width: renderInfo.width,\n                height: renderInfo.height,\n              },\n              position: {\n                x: renderInfo.left,\n                y: renderInfo.top,\n              },\n            });\n            player.addClip(clip);\n          });\n        });\n      }\n    }\n  }, [containerHeight, containerWidth, ratio, tracks], { wait: 100 });\n\n  /**\n   * 初始化播放器\n   */\n  useEffect(() => {\n    if (!playerRef.current && containerRef.current && containerWidth && containerHeight) {\n      const { width, height } = getPlayerResolution(ratio, containerWidth, containerHeight);\n      playerRef.current = new Player({\n        width,\n        height,\n        onCurrentTimeChange(currentTime: number) {\n          setCurrentTime(currentTime);\n        },\n        onEnd() {\n          setIsPlaying(false);\n        },\n      });\n      playerRef.current.attachTo(containerRef.current.querySelector('.player') as HTMLElement);\n    }\n  }, [containerHeight, containerRef, containerWidth, ratio, setCurrentTime, setIsPlaying, tracks]);\n\n  /**\n   * 增删\n   */\n  useEffect(() => {\n    if (playerRef.current && tracks.length) {\n      const { newClips, deleteClips } = findDiff(playerRef.current.clips, tracks);\n      tracksChanged(playerRef.current, newClips, deleteClips);\n    }\n  }, [tracks]);\n\n  /**\n   * 暂停/播放\n   */\n   const handleIsPlayingChange = useCallback(async (isPlaying: boolean) => {\n    if (playerRef.current) {\n      if (!isPlaying || currentTime >= totalDuration) {\n        await playerRef.current.pause();\n        setIsPlaying(false);\n      } else {\n        await playerRef.current.play();\n        setIsPlaying(true);\n      }\n    }\n  }, [currentTime, setIsPlaying, totalDuration]);\n\n  /**\n   * 定位时长\n   */\n  const handleCurrentTimeChange = useCallback(async (currentTime: number) => {\n    const player = playerRef.current;\n    if (player) {\n      player.pause();\n      await player.setCurrentTime(currentTime);\n      setIsPlaying(false);\n      setCurrentTime(currentTime);\n    }\n  }, [setCurrentTime, setIsPlaying]);\n\n  /**\n   * 更新总时长\n   */\n  useEffect(() => {\n    if (playerRef.current && totalDuration >= 0) {\n      playerRef.current.updateDuration();\n    }\n  }, [totalDuration]);\n\n  return {\n    player: playerRef.current,\n    isPlaying,\n    setIsPlaying,\n    handleIsPlayingChange,\n    handleCurrentTimeChange,\n  };\n};\n","import * as React from \"react\";\n\nfunction Logo(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width={19}\n      height={27}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      {...props}\n    >\n      <path fill=\"url(#prefix__pattern0)\" d=\"M0 0h19v27H0z\" />\n      <defs>\n        <pattern\n          id=\"prefix__pattern0\"\n          patternContentUnits=\"objectBoundingBox\"\n          width={1}\n          height={1}\n        >\n          <use\n            xlinkHref=\"#prefix__image0_348:26\"\n            transform=\"matrix(.01923 0 0 .01351 -.635 -.297)\"\n          />\n        </pattern>\n        <image\n          id=\"prefix__image0_348:26\"\n          width={120}\n          height={120}\n          xlinkHref=\"data:image/png;base64,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\"\n        />\n      </defs>\n    </svg>\n  );\n}\n\nexport default Logo;\n","import styled from 'styled-components';\n\nexport const StyledHeader = styled.div`\n  width: 100%;\n  height: 50px;\n  user-select: none;\n  overflow: hidden;\n  background: #1A2028;\n  border-bottom: 1px solid #232A35;\n  position: relative;\n  z-index: 10000;\n  display: flex;\n  flex-shrink: 0;\n  align-items: center;\n  padding-left: 20px;\n`;\n","import React from 'react';\nimport Logo from '../../../icons/Logo';\nimport { StyledHeader } from './styled';\n\nconst Header: React.FC = () => {\n  return (\n    <StyledHeader>\n      <Logo />\n    </StyledHeader>\n  );\n};\n\nexport default Header;\n","import * as React from 'react';\n\nfunction Cut(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={14}\n      height={12}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        d=\"M12.898.317a.667.667 0 01-.212.918l-4.42 2.762 2.677 1.672h.035a3.167 3.167 0 11-1.803.466L7.009 4.783 4.834 6.14a3.167 3.167 0 11-1.759-.474l2.676-1.67-4.419-2.762a.667.667 0 01-.25-.85L1.12.317a.667.667 0 01.919-.212l4.97 3.106 4.97-3.106a.667.667 0 01.919.212zM3.167 7a1.833 1.833 0 100 3.667 1.833 1.833 0 000-3.667zm7.666 0a1.833 1.833 0 100 3.667 1.833 1.833 0 000-3.667z\"\n        fill=\"#7185A6\"\n      />\n    </svg>\n  );\n}\n\nexport default Cut;\n","import * as React from 'react';\n\nfunction Delete(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={14}\n      height={14}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        d=\"M12.667 2.467a.667.667 0 010 1.333h-.69l-.281 8.509a1.407 1.407 0 01-1.304 1.354l-.102.004H3.704a1.407 1.407 0 01-1.407-1.36L2.021 3.8h-.688a.667.667 0 110-1.332h11.334zm-2.024 1.332H3.357l.273 8.463c.001.03.02.055.046.066l.028.005h6.586c.04 0 .072-.031.073-.071l.28-8.463zM7 5.333A.667.667 0 017.667 6v4a.667.667 0 01-1.334 0V6A.667.667 0 017 5.333zm2.667-5a.667.667 0 110 1.334H4.333a.667.667 0 110-1.334h5.334z\"\n        fill=\"#7185A6\"\n      />\n    </svg>\n  );\n}\n\nexport default Delete;\n","import * as React from 'react';\n\nfunction Redo(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={14}\n      height={13}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        d=\"M9.18.877a.667.667 0 01.943-.03l3.333 3.13.056.06a.667.667 0 01-.055.912l-3.333 3.143-.065.053a.667.667 0 01-.878-.081l-.053-.065a.667.667 0 01.08-.878l2.255-2.124H4.827a3.163 3.163 0 00-3.16 3.166 3.164 3.164 0 003.015 3.164l.145.004h7.84a.667.667 0 01.078 1.328l-.079.005h-7.84a4.497 4.497 0 01-4.493-4.5A4.497 4.497 0 014.67 3.667l.158-.003h6.345L9.21 1.818l-.057-.061a.667.667 0 01.027-.88z\"\n        fill=\"#7185A6\"\n      />\n    </svg>\n  );\n}\n\nexport default Redo;\n","import * as React from 'react';\n\nfunction Undo(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={14}\n      height={13}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        d=\"M4.82.877a.667.667 0 00-.943-.03L.544 3.977l-.056.06a.667.667 0 00.055.912l3.333 3.143.065.053a.667.667 0 00.878-.081l.053-.065a.667.667 0 00-.08-.878L2.536 4.997h6.636a3.163 3.163 0 013.16 3.166 3.164 3.164 0 01-3.015 3.164l-.145.004h-7.84a.667.667 0 00-.078 1.328l.078.005h7.84a4.497 4.497 0 004.494-4.5A4.496 4.496 0 009.33 3.667l-.158-.003H2.827L4.79 1.818l.057-.061a.667.667 0 00-.027-.88z\"\n        fill=\"#7185A6\"\n      />\n    </svg>\n  );\n}\n\nexport default Undo;\n","import styled from 'styled-components';\n\nexport const StyledToolBar = styled.div`\n  height: 50px;\n  background: #1C2430;\n  border-top: 1px solid #232A35;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  flex-shrink: 0;\n  padding: 0 24px;\n`;\n\nexport const Time = styled.div`\n  font-family: 'DIN Alternate';\n  font-style: normal;\n  font-weight: normal;\n  font-size: 16px;\n`;\n\nexport const ClipOperators = styled.div`\n  display: flex;\n  >div {\n    margin-right: 10px;\n  }\n`;\n\nexport const TimeLineZoom = styled.div`\n  width: 200px;\n  flex-shrink: 0;\n`;\n","import React, { useCallback, useContext } from 'react';\nimport { editorContext } from '../..';\nimport { Radius10Button } from '../../../common/styleds';\nimport { formatMillisecond } from '../../../common/utils';\nimport Cut from '../../../icons/Cut';\nimport Delete from '../../../icons/Delete';\nimport Redo from '../../../icons/Redo';\nimport Undo from '../../../icons/Undo';\nimport { deleteSelectedClip, isClipCanSplit, splitSelectedClip } from '../../util';\nimport { ClipOperators, StyledToolBar, Time, TimeLineZoom } from './styled';\n\nconst ToolBar: React.FC = () => {\n  const editorContextValue = useContext(editorContext);\n  const { totalDuration, currentTime, activeClip, tracks } = editorContextValue;\n  const handleDelete = useCallback(() => {\n    deleteSelectedClip(editorContextValue);\n  }, [editorContextValue]);\n  const handleSplitClip = useCallback(() => {\n    splitSelectedClip(editorContextValue);\n  }, [editorContextValue]);\n  return (\n    <StyledToolBar>\n\n      <ClipOperators>\n        <Radius10Button className=\"disabled\">\n          <Undo />\n        </Radius10Button>\n        <Radius10Button className=\"disabled\">\n          <Redo />\n        </Radius10Button>\n        <Radius10Button onClick={handleSplitClip} className={isClipCanSplit(tracks, currentTime, activeClip?.id) ? '' : 'disabled'}>\n          <Cut />\n        </Radius10Button>\n        <Radius10Button onClick={handleDelete} className={`warn ${activeClip ? '' : 'disabled'}`}>\n          <Delete />\n        </Radius10Button>\n      </ClipOperators>\n\n      <Time>\n        {formatMillisecond(currentTime, true)}\n        <span style={{ color: '#455570' }}> / {formatMillisecond(totalDuration, true)}</span>\n      </Time>\n\n      <TimeLineZoom>\n        \n      </TimeLineZoom>\n\n    </StyledToolBar>\n  );\n};\n\nexport default ToolBar;\n","import styled from 'styled-components';\n\nexport const StyledTarget = styled.div`\n  position: fixed;\n  z-index: 99999;\n`;\n","import { useSize } from 'ahooks';\nimport React, { useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport Moveable from 'react-moveable';\nimport { editorContext } from '../..';\nimport { ClipType } from '../../../common/types/clip';\nimport { FitType } from '../../../common/types/player';\nimport { getPlayerContainerBounding } from '../../util';\nimport { StyledTarget } from './styled';\n\nconst renderDirections = ['nw', 'ne', 'sw', 'se'];\n\nconst ResizeRotate: React.FC = () => {\n  const { activeClip, tracks, setTracks } = useContext(editorContext);\n  const [target, setTarget] = useState<HTMLDivElement | null>(null);\n  const [targetStyle, setTargetStyle] = useState<React.CSSProperties>();\n  const moveableRef = useRef<Moveable>(null);\n  const targetRef = useCallback((node: HTMLDivElement) => {\n    setTarget(node);\n  }, []);\n\n  useEffect(() => {\n    if (activeClip) {\n      const { left, top } = getPlayerContainerBounding();\n      const { size: { width, height }, position: { x, y }, rotate } = activeClip.geometryInfo;\n      setTargetStyle({\n        width,\n        height,\n        transform: `translate(${left + x}px, ${top + y}px) rotate(${rotate}deg)`,\n      });\n    } else {\n      setTargetStyle({\n        width: 0,\n        height: 0,\n      });\n    }\n  }, [activeClip]);\n\n  /** 文本组件需要监听文字内容改变 */\n  useEffect(() => {\n    if (activeClip?.type === ClipType.TEXT) {\n      const { left, top } = getPlayerContainerBounding();\n      const { size: { width, height }, position: { x, y }, rotate } = activeClip.geometryInfo;\n      setTargetStyle({\n        width,\n        height,\n        transform: `translate(${left + x}px, ${top + y}px) rotate(${rotate}deg)`,\n      });\n    }\n  // @ts-ignore\n  }, [activeClip, activeClip?.value]);\n\n  const { width, height } = useSize(target);\n  useEffect(() => {\n    moveableRef.current?.updateTarget();\n  }, [width, height]);\n\n  const handleStart = useCallback(() => {\n    if (activeClip && activeClip.fitType !== FitType.CUSTOM) {\n      activeClip.fitType = FitType.CUSTOM;\n      setTracks([...tracks]);\n    }\n  }, [activeClip, setTracks, tracks]);\n\n  const handleDrag = useCallback((params) => {\n    const { target, delta, transform } = params;\n    target.style.transform = transform;\n    if (activeClip) {\n      Object.assign(activeClip.geometryInfo, {\n        position: {\n          x: activeClip.geometryInfo.position.x + delta[0],\n          y: activeClip.geometryInfo.position.y + delta[1],\n        },\n      });\n    }\n  }, [activeClip]);\n\n  const handleResize = useCallback((params) => {\n    const { target, width, height, delta, drag } = params;\n    const beforeTranslate = drag.beforeTranslate;\n    if (activeClip) {\n      const { left, top } = getPlayerContainerBounding();\n      Object.assign(activeClip.geometryInfo, {\n        size: {\n          width: width,\n          height: height,\n        },\n      });\n      Object.assign(activeClip.geometryInfo, {\n        position: {\n          x: beforeTranslate[0] - left,\n          y: beforeTranslate[1] - top,\n        },\n      });\n    }\n    delta[0] && (target!.style.width = `${width}px`);\n    delta[1] && (target!.style.height = `${height}px`);\n    target!.style.transform = `translate(${beforeTranslate[0]}px, ${beforeTranslate[1]}px) rotate(${activeClip?.geometryInfo.rotate}deg)`;\n  }, [activeClip]);\n\n  const handleRotate = useCallback((params) => {\n    const { target, transform, absoluteRotate } = params;\n    if (activeClip) {\n      Object.assign(activeClip.geometryInfo, {\n        rotate: absoluteRotate,\n      });\n    }\n    target!.style.transform = transform;\n  }, [activeClip]);\n\n  return (\n    <>\n      <StyledTarget className=\"resize-rotate\" style={targetStyle} ref={targetRef}>\n        {/* {\n          activeClip?.type === ClipType.TEXT ? <TextEditor clip={activeClip as TextClip} /> : null\n        } */}\n      </StyledTarget>\n      <Moveable\n        ref={moveableRef}\n        target={target}\n        container={null}\n        origin={false}\n        keepRatio={true}\n        renderDirections={renderDirections}\n\n        /* Resize event edges */\n        edge={false}\n\n        /* draggable */\n        draggable={true}\n        // throttleDrag={2}\n        onDragStart={handleStart}\n        onDrag={handleDrag}\n\n        /* resizable*/\n        resizable={true}\n        // throttleResize={5}\n        onResizeStart={handleStart}\n        onResize={handleResize}\n\n        /** rotate */\n        rotatable={true}\n        // throttleRotate={2}\n        onRotateStart={handleStart}\n        onRotate={handleRotate}\n      />\n    </>\n  );\n};\n\nexport default ResizeRotate;\n","import React, { useCallback } from 'react';\nimport { SelectorButton } from '../../styleds';\nimport { FlatSelectorDataItem } from './type';\n\ntype ItemProps = {\n  value: any;\n  data: FlatSelectorDataItem;\n  onChange(data: any): void;\n};\n\nconst SelectorItem: React.FC<ItemProps> = ({ data, value, onChange }) => {\n  const handleClick = useCallback(() => {\n    onChange(data.value);\n  }, [data.value, onChange]);\n  return (\n    <SelectorButton\n      onClick={handleClick}\n      className={value === data.value ? 'active' : ''}\n    >{data.label}</SelectorButton>\n  );\n};\n\ntype Props = {\n  value: any;\n  data: FlatSelectorDataItem[];\n  onChange(data: any): void;\n};\n\nconst FlatSelector: React.FC<Props> = ({\n  data,\n  value,\n  onChange,\n}) => {\n  const handleChange = useCallback((value: any) => {\n    onChange(value);\n  }, [onChange]);\n  return (\n    <div>\n      {\n        data.map((item) => {\n          return (\n            <SelectorItem\n              onChange={handleChange}\n              key={item.value}\n              data={item}\n              value={value}\n            >{item.label}</SelectorItem>\n          );\n        }, [])\n      }\n    </div>\n  );\n};\n\nexport default FlatSelector;\n","import { Popover } from 'antd';\nimport React from 'react';\nimport { Ratio } from '../../configs';\nimport { Radius99Button } from '../../styleds';\nimport FlatSelector from '../FlatSelector';\n\ntype Props = {\n  value: Ratio;\n  onChange(data: Ratio): void;\n};\n\nconst ratioData = [\n  { value: Ratio.RATIO_16_9, label: '16:9' },\n  { value: Ratio.RATIO_9_16, label: '9:16' },\n  { value: Ratio.RATIO_4_3, label: '4:3' },\n  { value: Ratio.RATIO_3_4, label: '3:4' },\n  { value: Ratio.RATIO_21_9, label: '21:9' },\n  { value: Ratio.RATIO_1_1, label: '1:1' },\n];\n\nconst RatioSelector: React.FC<Props> = ({\n  value,\n  onChange,\n}) => {\n  return (\n    <div>\n      <Popover\n        trigger=\"click\"\n        color=\"#1F2836\"\n        overlayStyle={{ width: 150 }}\n        zIndex={999999999}\n        content={\n          <FlatSelector data={ratioData} value={value} onChange={onChange} />\n        }\n      >\n        <Radius99Button>\n          {\n            ratioData.find(item => item.value === value)?.label\n          }\n        </Radius99Button>\n      </Popover>\n    </div>\n  );\n};\n\nexport default RatioSelector;\n","import * as React from 'react';\n\nfunction BackForward(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width={12}\n      height={12}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...props}\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M3 0H0v12h3V0zm9 0L5 6l7 6V0z\"\n        fill=\"#7B9FD6\"\n      />\n    </svg>\n  );\n}\n\nexport default BackForward;\n","import * as React from \"react\";\n\nfunction FastForward(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width={12}\n      height={12}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...props}\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M0 12l7-6-7-6v12zm9 0h3V0H9v12z\"\n        fill=\"#7B9FD6\"\n      />\n    </svg>\n  );\n}\n\nexport default FastForward;\n","import * as React from 'react';\n\nfunction PauseButton(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={10}\n      height={12}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M3 0H0v12h3V0zm7 0H7v12h3V0z\"\n        fill=\"#7B9FD6\"\n      />\n    </svg>\n  );\n}\n\nexport default PauseButton;\n","import * as React from 'react';\n\nfunction PlayButton(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width={10}\n      height={12}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...props}\n    >\n      <path d=\"M10 6L0 12V0l10 6z\" fill=\"#7B9FD6\" />\n    </svg>\n  );\n}\n\nexport default PlayButton;\n","import styled from 'styled-components';\n\nexport const StyledPlayerControls = styled.div`\n  height: 65px;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  flex-shrink: 0;\n  position: absolute;\n  bottom: 0;\n`;\n\nexport const PlayButtons = styled.div`\n  display: flex;\n  >div {\n    margin-right: 10px;\n  }\n`;\n\nexport const Ratios = styled.div`\n  display: flex;\n  width: 80px;\n`;\n","import React, { useCallback, useContext } from 'react';\nimport { editorContext, playerContext } from '../..';\nimport RatioSelector from '../../../common/components/RatioSelector';\nimport { Radius10Button } from '../../../common/styleds';\nimport BackForward from '../../../icons/BackForward';\nimport FastForward from '../../../icons/FastForward';\nimport PauseButton from '../../../icons/pauseButton';\nimport PlayButton from '../../../icons/PlayButton';\nimport { PlayButtons, Ratios, StyledPlayerControls } from './styled';\n\nconst playerControlButtonStyle = {\n  background: '#1F2836',\n  borderColor: '#222B3A',\n};\n\nconst PlayerControls: React.FC = () => {\n  const editorContextValue = useContext(editorContext);\n  const {\n    handleIsPlayingChange,\n    handleCurrentTimeChange,\n  } = useContext(playerContext);\n  const { isPlaying, totalDuration, ratio, setRatio } = editorContextValue;\n  const handlePlayingChange = useCallback(() => {\n    handleIsPlayingChange(!isPlaying);\n  }, [handleIsPlayingChange, isPlaying]);\n  const handleSetToStart = useCallback(() => {\n    handleCurrentTimeChange(0);\n  }, [handleCurrentTimeChange]);\n  const handleSetToEnd = useCallback(() => {\n    handleCurrentTimeChange(totalDuration);\n  }, [handleCurrentTimeChange, totalDuration]);\n  return (\n    <StyledPlayerControls>\n\n      <Ratios>\n        <RatioSelector value={ratio} onChange={setRatio} />\n      </Ratios>\n\n      <PlayButtons>\n        <Radius10Button onClick={handleSetToStart} style={playerControlButtonStyle}>\n          <BackForward />\n        </Radius10Button>\n        <Radius10Button style={{ width: 60, ...playerControlButtonStyle }} onClick={handlePlayingChange}>\n          {\n            isPlaying ? <PauseButton /> : <PlayButton />\n          }\n        </Radius10Button>\n        <Radius10Button onClick={handleSetToEnd} style={playerControlButtonStyle}>\n          <FastForward />\n        </Radius10Button>\n      </PlayButtons>\n\n      <Radius10Button style={{ width: 100 }} className=\"disabled\">\n        全屏播放\n      </Radius10Button>\n\n    </StyledPlayerControls>\n  );\n};\n\nexport default PlayerControls;\n","import * as React from 'react';\n\nfunction ExportVideo(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={16}\n      height={16}\n      fill=\"none\"\n      {...props}\n    >\n      <path d=\"M2 5v9.5h3V5H2z\" fill=\"url(#prefix__paint0_linear_441_1815)\" />\n      <path d=\"M12 5H2v3h10V5z\" fill=\"url(#prefix__paint1_linear_441_1815)\" />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M16 4.019a1 1 0 00-1-.998H3c-1.657 0-3 1.34-3 2.995v6.989A2.998 2.998 0 003 16h10c1.657 0 3-1.341 3-2.995v-3.52a1 1 0 00-2 0v3.52a1 1 0 01-1 .998H3a1 1 0 01-1-.998v-6.99a1 1 0 011-.998h12a1 1 0 001-.998z\"\n        fill=\"#fff\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M10.197.403a.997.997 0 00.206 1.397l2.93 2.175-2.936 2.218a.997.997 0 00-.195 1.398c.334.44.96.527 1.401.194l4-3.02a.998.998 0 00-.006-1.597l-4-2.97a1.001 1.001 0 00-1.4.205z\"\n        fill=\"#fff\"\n      />\n      <path\n        d=\"M6.22 7.692a.5.5 0 01.77-.421l2.886 1.843a.5.5 0 010 .843L6.99 11.8a.5.5 0 01-.77-.421V7.692z\"\n        fill=\"#fff\"\n      />\n      <defs>\n        <linearGradient\n          id=\"prefix__paint0_linear_441_1815\"\n          x1={2}\n          y1={9.5}\n          x2={4.5}\n          y2={9.5}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#0C09AB\" />\n          <stop offset={1} stopColor=\"#0C09AB\" stopOpacity={0} />\n        </linearGradient>\n        <linearGradient\n          id=\"prefix__paint1_linear_441_1815\"\n          x1={7}\n          y1={5}\n          x2={7}\n          y2={8}\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#0C09AB\" />\n          <stop offset={1} stopColor=\"#0C09AB\" stopOpacity={0} />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n\nexport default ExportVideo;\n","import * as React from 'react';\n\nfunction IconEffect(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={16}\n      height={16}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        d=\"M13.368 10.417l.711 2.037 1.921.754-1.92.755L13.367 16l-.71-2.037-1.92-.755 1.92-.754.71-2.037zM13.989 1.383l-.47 1.085.47 1.085-1.023-.499-1.023.5.47-1.086-.47-1.085 1.023.5 1.023-.5zM2.382 13.81l-.428.987.428.987-.93-.454-.93.454.427-.987-.428-.987.93.454.931-.454zM.741 0l1.213 1.068L3.508.786 2.501 2.073l.266 1.649-1.213-1.068L0 2.935l1.007-1.287L.74 0zM7.09 1.509a.146.146 0 01.276 0l1.726 4.982c.014.04.045.073.085.088l4.72 1.84a.146.146 0 010 .272l-4.72 1.84a.146.146 0 00-.085.088l-1.726 4.982a.146.146 0 01-.276 0L5.365 10.62a.146.146 0 00-.085-.088L.56 8.691a.146.146 0 010-.272l4.72-1.84a.146.146 0 00.085-.088L7.09 1.509z\"\n        fill=\"#81ACF0\"\n      />\n    </svg>\n  );\n}\n\nexport default IconEffect;\n","import { Popover } from 'antd';\nimport React from 'react';\nimport IconEffect from '../../../icons/IconEffect';\nimport { Radius10Button } from '../../styleds';\nimport { EffectType } from '../../types/player';\nimport FlatSelector from '../FlatSelector';\n\ntype Props = {\n  value: EffectType;\n  onChange(data: EffectType): void;\n};\n\nconst effectData = [\n  { value: EffectType.NO_EFFECT, label: '无特效' },\n  { value: EffectType.GRAY, label: '灰度' },\n  { value: EffectType.TRIANGLE_BLUR, label: '快速模糊' },\n  { value: EffectType.GAUSSIAN_BLUR, label: '高斯模糊' },\n];\n\nconst EffectSelector: React.FC<Props> = ({\n  value,\n  onChange,\n}) => {\n  return (\n    <div>\n      <Popover\n        trigger=\"click\"\n        color=\"#1F2836\"\n        overlayStyle={{ width: 150 }}\n        zIndex={999999999}\n        content={\n          <FlatSelector data={effectData} value={value} onChange={onChange} />\n        }\n      >\n        <Radius10Button>\n          <IconEffect />\n        </Radius10Button>\n      </Popover>\n    </div>\n  );\n};\n\nexport default EffectSelector;\n","import * as React from 'react';\n\nfunction IconFitType(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={16}\n      height={16}\n      fill=\"none\"\n      {...props}\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M7.56 1.156a.988.988 0 01-1.123.835l-3.046.038L6.58 5.217a.991.991 0 01-1.402 1.401L2.016 3.456 1.96 6.475a.988.988 0 01-.843 1.116A.992.992 0 010 6.746l.014-5.62A.989.989 0 011.138.01l5.585.02c.541.08.916.584.837 1.125zm7.284 7.284a.988.988 0 00-.835 1.123l-.038 3.046-2.487-2.487a.99.99 0 10-1.401 1.401l2.46 2.461-3.018.055a.988.988 0 00-1.116.843A.992.992 0 009.254 16l5.62-.014a.99.99 0 001.115-1.124l-.02-5.585a.992.992 0 00-1.125-.837z\"\n        fill=\"#81ACF0\"\n      />\n    </svg>\n  );\n}\n\nexport default IconFitType;\n","import { Popover } from 'antd';\nimport React, { useCallback } from 'react';\nimport { getPlayerContainerBounding } from '../../../editor/util';\nimport IconFitType from '../../../icons/IconFitType';\nimport { getClipRenderInfo } from '../../../player/util';\nimport { Radius10Button } from '../../styleds';\nimport { Clip, GeometryInfo } from '../../types/clip';\nimport { FitType } from '../../types/player';\nimport FlatSelector from '../FlatSelector';\n\ntype Props = {\n  clip: Clip;\n  onChange(data: Partial<GeometryInfo>): void;\n};\n\nconst fitData = [\n  { value: FitType.CUSTOM, label: '自定义' },\n  { value: FitType.CONTAIN, label: '包含' },\n  { value: FitType.COVER, label: '覆盖' },\n  { value: FitType.FILL, label: '填充' },\n];\n\nconst FitSelector: React.FC<Props> = ({\n  clip,\n  onChange,\n}) => {\n  const handleChange = useCallback((fitType: FitType) => {\n    clip.fitType = fitType;\n    const { height: playerHeight, width: playerWidth } = getPlayerContainerBounding();\n    const renderInfo = getClipRenderInfo(clip, playerWidth, playerHeight);\n    onChange({\n      size: {\n        width: renderInfo.width,\n        height: renderInfo.height,\n      },\n      position: {\n        x: renderInfo.left,\n        y: renderInfo.top,\n      }\n    });\n  }, [clip, onChange]);\n  return (\n    <div>\n      <Popover\n        trigger=\"click\"\n        color=\"#1F2836\"\n        overlayStyle={{ width: 150 }}\n        zIndex={999999999}\n        content={\n          <FlatSelector data={fitData} value={clip.fitType} onChange={handleChange} />\n        }\n      >\n        <Radius10Button>\n          <IconFitType />\n        </Radius10Button>\n      </Popover>\n    </div>\n  );\n};\n\nexport default FitSelector;\n","import React, { useCallback } from 'react';\nimport { GeometryInfo, ImageClip } from '../../../../../common/types/clip';\nimport { EffectType } from '../../../../../common/types/player';\nimport EffectSelector from '../../../../../common/components/EffectSelector';\nimport FitSelector from '../../../../../common/components/FitSelector';\nimport { ConfigPanelIconContainer } from '../../../../../common/styleds';\n\ntype Props = {\n  data: ImageClip;\n  onChange(data: Partial<ImageClip>, reactive?: boolean): void;\n};\n\nconst ImagePanel: React.FC<Props> = ({ data, onChange }) => {\n  const handleEffectChange = useCallback((value: EffectType) => {\n    onChange({\n      effect: value,\n    });\n  }, [onChange]);\n  const handleFitChange = useCallback((value: Partial<GeometryInfo>) => {\n    Object.assign(data.geometryInfo, value);\n    onChange(data, true);\n  }, [data, onChange]);\n  return (\n    <ConfigPanelIconContainer>\n      <EffectSelector\n        value={data.effect}\n        onChange={handleEffectChange}\n      />\n      <FitSelector\n        clip={data}\n        onChange={handleFitChange}\n      />\n    </ConfigPanelIconContainer>\n  );\n};\n\nexport default ImagePanel;\n","import React, { useCallback } from 'react';\nimport { GeometryInfo, VideoClip } from '../../../../../common/types/clip';\nimport { EffectType } from '../../../../../common/types/player';\nimport EffectSelector from '../../../../../common/components/EffectSelector';\nimport FitSelector from '../../../../../common/components/FitSelector';\nimport { ConfigPanelIconContainer } from '../../../../../common/styleds';\n\ntype Props = {\n  data: VideoClip;\n  onChange(data: Partial<VideoClip>, reactive?: boolean): void;\n};\n\nconst VideoPanel: React.FC<Props> = ({ data, onChange }) => {\n  const handleEffectChange = useCallback((value: EffectType) => {\n    onChange({\n      effect: value,\n    });\n  }, [onChange]);\n  const handleFitChange = useCallback((value: Partial<GeometryInfo>) => {\n    Object.assign(data.geometryInfo, value);\n    onChange(data, true);\n  }, [data, onChange]);\n  return (\n    <ConfigPanelIconContainer>\n      <EffectSelector\n        value={data.effect}\n        onChange={handleEffectChange}\n      />\n      <FitSelector\n        clip={data}\n        onChange={handleFitChange}\n      />\n    </ConfigPanelIconContainer>\n  );\n};\n\nexport default VideoPanel;\n","import { Popover } from 'antd';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Radius10Button } from '../../styleds';\nimport { FormOutlined } from '@ant-design/icons';\nimport { Input } from 'antd';\n\nconst { TextArea } = Input;\n\ntype Props = {\n  text: string;\n  onChange(data: string): void;\n};\n\nconst TextEditor: React.FC<Props> = ({\n  text,\n  onChange,\n}) => {\n  const isComposition = useRef(false);\n  const [value, setValue] = useState(text);\n  useEffect(() => {\n    setValue(text);\n  }, [text]);\n  const handleChange = useCallback((e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const newValue = e.target.value;\n    if (isComposition.current) {\n      setValue(newValue);\n    } else {\n      onChange(newValue);\n    }\n  }, [onChange]);\n  const handleKeyUp = useCallback((e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.code === 'Backspace') {\n      e.stopPropagation();\n    }\n  }, []);\n  const handleCompositionStart = useCallback(() => {\n    isComposition.current = true;\n  }, []);\n  const handleCompositionEnd = useCallback(() => {\n    isComposition.current = false;\n    onChange(value);\n  }, [onChange, value]);\n  return (\n    <div>\n      <Popover\n        trigger=\"click\"\n        color=\"#1F2836\"\n        zIndex={999999999}\n        content={\n          <TextArea\n            rows={5}\n            cols={30}\n            value={value}\n            onChange={handleChange}\n            onKeyDown={handleKeyUp}\n            onCompositionStart={handleCompositionStart}\n            onCompositionEnd={handleCompositionEnd}\n          />\n        }\n      >\n        <Radius10Button>\n          <FormOutlined />\n        </Radius10Button>\n      </Popover>\n    </div>\n  );\n};\n\nexport default TextEditor;\n","import React, { useCallback } from 'react';\nimport { TextClip } from '../../../../../common/types/clip';\nimport { EffectType } from '../../../../../common/types/player';\nimport EffectSelector from '../../../../../common/components/EffectSelector';\nimport { ConfigPanelIconContainer } from '../../../../../common/styleds';\nimport TextEditor from '../../../../../common/components/TextEditor';\nimport { getPixelRatio, getTextClipSize } from '../../../../../common/utils';\n\ntype Props = {\n  data: TextClip;\n  onChange(data: Partial<TextClip>): void;\n};\n\nconst TextPanel: React.FC<Props> = ({ data, onChange }) => {\n  const handleEffectChange = useCallback((value: EffectType) => {\n    onChange({\n      effect: value,\n    });\n  }, [onChange]);\n  const handleTextChange = useCallback((value: string) => {\n    const newClip = {\n      ...data,\n      value,\n    };\n    const { width, height } = getTextClipSize(newClip);\n    Object.assign(data, {\n      originalWidth: width,\n      originalHeight: height,\n    });\n    Object.assign(data.geometryInfo, {\n      size: {\n        width: width / getPixelRatio(),\n        height: height / getPixelRatio(),\n      },\n    });\n    Object.assign(data, {\n      value,\n    });\n    onChange(data);\n  }, [onChange, data]);\n  return (\n    <ConfigPanelIconContainer>\n      <EffectSelector\n        value={data.effect}\n        onChange={handleEffectChange}\n      />\n      <TextEditor\n        text={data.value}\n        onChange={handleTextChange}\n      />\n    </ConfigPanelIconContainer>\n  );\n};\n\nexport default TextPanel;\n","import React, { useCallback, useContext } from 'react';\nimport { editorContext } from '../..';\nimport { Clip, ClipType, ImageClip, TextClip, VideoClip } from '../../../common/types/clip';\nimport { sleep } from '../../../common/utils';\nimport ImagePanel from './components/ImagePanel';\nimport VideoPanel from './components/VideoPanel';\nimport TextPanel from './components/TextPanel';\n\nfunction getPanel(data: Clip | undefined, onChange: (data: Partial<Clip>) => void) {\n  switch (data?.type) {\n    case ClipType.VIDEO:\n      return <VideoPanel data={data as VideoClip} onChange={onChange} />;\n    case ClipType.IMAGE:\n      return <ImagePanel data={data as ImageClip} onChange={onChange} />;\n    case ClipType.TEXT:\n      return <TextPanel data={data as TextClip} onChange={onChange} />;\n    default:\n      return null;\n  }\n}\n\nconst ConfigPanel: React.FC = () => {\n  const { activeClip, setActiveClip, tracks, setTracks } = useContext(editorContext);\n  const handleChange = useCallback(async (data: Partial<Clip>, reactive: boolean = false) => {\n    if (activeClip) {\n      Object.assign(activeClip, data);\n      setTracks([...tracks]);\n      if (reactive) {\n        const tempClip = activeClip;\n        setActiveClip(undefined);\n        await sleep(50);\n        setActiveClip(tempClip);\n      }\n    }\n  }, [activeClip, setActiveClip, setTracks, tracks]);\n\n  // 防止选中的clip失焦\n  const handleClick = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n  }, []);\n  return (\n    <div onClick={handleClick}>\n      {getPanel(activeClip, handleChange)}\n    </div>\n  );\n};\n\nexport default ConfigPanel;\n","import styled from 'styled-components';\n\nexport const StyledStageHeader = styled.div`\n  position: absolute;\n  left: 0;\n  right: 0;\n  height: 50px;\n  top: -50px;\n  display: flex;\n  align-items: center;\n  z-index: 99999;\n  justify-content: space-between;\n`;\n\nexport const ExportButton = styled.div`\n  height: 30px;\n  padding: 0 20px;\n  background: #3A36E4;\n  border-radius: 99px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #fff;\n  display: flex;\n  align-items: center;\n\n  &:hover {\n    background: #302DD3;\n  }\n\n  svg {\n    margin-right: 8px;\n  }\n`;\n","import React, { useCallback, useContext } from 'react';\nimport { playerContext } from '../..';\nimport ExportVideo from '../../../icons/ExportVideo';\nimport { exportAsVideo } from '../../../player/util';\nimport ConfigPanel from '../ConfigPanel';\nimport { ExportButton, StyledStageHeader } from './styled';\n\nconst StageHeader: React.FC = () => {\n  const { player } = useContext(playerContext);\n  const handleExportVideo = useCallback(() => {\n    if (player) {\n      exportAsVideo(player);\n    }\n  }, [player]);\n  return (\n    <StyledStageHeader>\n      <div>\n        <ConfigPanel />\n      </div>\n      <div>未命名</div>\n      <ExportButton onClick={handleExportVideo}>\n        <ExportVideo />\n        导出视频\n      </ExportButton>\n    </StyledStageHeader>\n  );\n};\n\nexport default StageHeader;\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport AssetMenu from './components/AssetMenu';\nimport Tracks from './components/Tracks';\nimport {\n  StyledEditor,\n  Stage,\n  AssetPanel,\n  TimelineWrapper,\n  TracksScrollContainer,\n  AssetAndStage,\n  PlayerContainer,\n} from './styled';\nimport { EditorContext, PlayerContext } from './type';\nimport { Clip } from '../common/types/clip';\nimport Ruler from './components/Ruler';\nimport { getTotalDuration, millisecondsToWidth } from './util';\nimport { useKeyboard } from './hooks/keyboard';\nimport { INIT_EDITOR_CONTEXT, INIT_PLAYER_CONTEXT } from './config';\nimport { usePlayer } from './hooks/player';\nimport Header from './components/Header';\nimport ToolBar from './components/ToolBar';\nimport ResizeRotate from './components/ResizeRotate';\nimport PlayerControls from './components/PlayerControls';\nimport StageHeader from './components/StageHeader';\nimport { Ratio } from '../common/configs';\n\nexport const editorContext = React.createContext<EditorContext>(INIT_EDITOR_CONTEXT);\nexport const playerContext = React.createContext<PlayerContext>(INIT_PLAYER_CONTEXT);\n\nconst Editor: React.FC = () => {\n  const [hoverTrack, setHoverTrack] = useState<HTMLElement | null>(null);\n  const [tracks, setTracks] = useState<Clip[][]>([[]]);\n  const [newTrackIndex, setNewTrackIndex] = useState(-1);\n  const [totalDuration, setTotalDuration] = useState(0);\n  const [activeClip, setActiveClip] = useState<Clip>();\n  const [currentTime, setCurrentTime] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [draggingClip, setDraggingClip] = useState<Clip>();\n  const [ratio, setRatio] = useState<Ratio>(Ratio.RATIO_16_9);\n  const playerContainerRef = useRef<HTMLDivElement>(null);\n\n  const handleTracksChange = useCallback((tracks: Clip[][]) => {\n    const newTracks = tracks.filter((track) => track.length);\n    const newTotalDuration = getTotalDuration(newTracks);\n    if (newTotalDuration !== totalDuration) {\n      setTotalDuration(newTotalDuration);\n      if (currentTime > newTotalDuration) {\n        setCurrentTime(newTotalDuration);\n      }\n    }\n    // 更新zIndex\n    newTracks.flat(1).forEach((clip, index) => {\n      clip.zIndex = index;\n    });\n    setTracks(newTracks.length ? newTracks : [[]]);\n  }, [currentTime, setCurrentTime, totalDuration]);\n\n  useEffect(() => {\n    // 更新容器的宽度\n    if (totalDuration) {\n      const scrollContainer = document.querySelector('.tracks-wrapper') as HTMLElement;\n      if (scrollContainer) {\n        const currentWidth = scrollContainer.clientWidth;\n        const newWidth = millisecondsToWidth(totalDuration);\n        if (currentWidth < newWidth) {\n          scrollContainer.style.width = `${newWidth + 100}px`;\n        }\n      }\n    }\n  }, [totalDuration]);\n\n  const editorContextValue = {\n    hoverTrack,\n    setHoverTrack,\n    tracks,\n    setTracks: handleTracksChange,\n    newTrackIndex,\n    setNewTrackIndex,\n    activeClip,\n    setActiveClip,\n    currentTime,\n    setCurrentTime,\n    totalDuration,\n    setTotalDuration,\n    isPlaying,\n    setIsPlaying,\n    draggingClip,\n    setDraggingClip,\n    ratio,\n    setRatio,\n  };\n\n  const playerContextValue = usePlayer(editorContextValue, playerContainerRef);\n\n  // 绑定键盘操作\n  useKeyboard(editorContextValue, playerContextValue);\n\n  const handleDocumentClick = useCallback(() => {\n    if (activeClip) {\n      setActiveClip(undefined);\n    }\n  }, [activeClip]);\n\n  useEffect(() => {\n    document.removeEventListener('click', handleDocumentClick, false);\n    document.addEventListener('click', handleDocumentClick, false);\n    return () => {\n      document.removeEventListener('click', handleDocumentClick, false);\n    };\n  }, [handleDocumentClick]);\n\n  return (\n    <editorContext.Provider value={editorContextValue}>\n      <playerContext.Provider value={playerContextValue}>\n        <ResizeRotate />\n        <StyledEditor>\n          <Header />\n          <AssetAndStage>\n            <AssetPanel>\n              <AssetMenu />\n            </AssetPanel>\n            <Stage>\n              <StageHeader />\n              <PlayerContainer ref={playerContainerRef}>\n                <div className=\"player\"></div>\n              </PlayerContainer>\n              <PlayerControls />\n            </Stage>\n          </AssetAndStage>\n          <TimelineWrapper>\n            <ToolBar />\n            <TracksScrollContainer>\n              <Ruler />\n              <Tracks onCurrentTimeChange={playerContextValue.handleCurrentTimeChange} />\n            </TracksScrollContainer>\n          </TimelineWrapper>\n        </StyledEditor>\n      </playerContext.Provider>\n    </editorContext.Provider>\n  );\n};\n\nexport default Editor;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { createGlobalStyle } from 'styled-components';\nimport Editor from './editor';\nimport { isWindows } from 'react-device-detect';\nimport './index.css';\n\n/**\n * 如果是windows，设置滚动条样式\n */\nconst ScrollbarStyle = createGlobalStyle`\n  ::-webkit-scrollbar {\n    width: 7px;\n    height: 7px;\n  }\n\n  ::-webkit-scrollbar-thumb\n  {\n    background: rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n  }\n`;\n\nReactDOM.render(\n  <React.StrictMode>\n    {\n      isWindows ? <ScrollbarStyle /> : null\n    }\n    <Editor />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}